{"version":3,"file":"SigningIn-DaBgrdm7.js","sources":["../../../../../../../src/account-security/SigningIn.tsx"],"sourcesContent":["import {\r\n  Button,\r\n  DataList,\r\n  DataListAction,\r\n  DataListCell,\r\n  DataListItem,\r\n  DataListItemCells,\r\n  DataListItemRow,\r\n  DescriptionList,\r\n  DescriptionListDescription,\r\n  DescriptionListGroup,\r\n  DescriptionListTerm,\r\n  Dropdown,\r\n  DropdownItem,\r\n  MenuToggle,\r\n  PageSection,\r\n  Spinner,\r\n  Split,\r\n  SplitItem,\r\n  Title,\r\n} from \"@patternfly/react-core\";\r\nimport {\r\n  EllipsisVIcon,\r\n  ExclamationTriangleIcon,\r\n  InfoAltIcon,\r\n} from \"@patternfly/react-icons\";\r\nimport { CSSProperties, Fragment, useState } from \"react\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport { useEnvironment } from \"@keycloak/keycloak-ui-shared\";\r\nimport { getCredentials } from \"../api/methods\";\r\nimport {\r\n  CredentialContainer,\r\n  CredentialMetadataRepresentation,\r\n} from \"../api/representations\";\r\nimport { EmptyRow } from \"../components/datalist/EmptyRow\";\r\nimport { Page } from \"../components/page/Page\";\r\nimport { TFuncKey } from \"../i18n\";\r\nimport { formatDate } from \"../utils/formatDate\";\r\nimport { usePromise } from \"../utils/usePromise\";\r\n\r\ntype MobileLinkProps = {\r\n  title: string;\r\n  onClick: () => void;\r\n  testid?: string;\r\n};\r\n\r\nconst MobileLink = ({ title, onClick, testid }: MobileLinkProps) => {\r\n  const [open, setOpen] = useState(false);\r\n  return (\r\n    <>\r\n      <Dropdown\r\n        popperProps={{\r\n          position: \"right\",\r\n        }}\r\n        onOpenChange={(isOpen) => setOpen(isOpen)}\r\n        toggle={(toggleRef) => (\r\n          <MenuToggle\r\n            className=\"pf-v5-u-display-none-on-lg\"\r\n            ref={toggleRef}\r\n            variant=\"plain\"\r\n            onClick={() => setOpen(!open)}\r\n            isExpanded={open}\r\n          >\r\n            <EllipsisVIcon />\r\n          </MenuToggle>\r\n        )}\r\n        isOpen={open}\r\n      >\r\n        <DropdownItem key=\"1\" onClick={onClick}>\r\n          {title}\r\n        </DropdownItem>\r\n      </Dropdown>\r\n      <Button\r\n        variant=\"link\"\r\n        onClick={onClick}\r\n        className=\"pf-v5-u-display-none pf-v5-u-display-inline-flex-on-lg\"\r\n        data-testid={testid}\r\n      >\r\n        {title}\r\n      </Button>\r\n    </>\r\n  );\r\n};\r\n\r\nexport const SigningIn = () => {\r\n  const { t } = useTranslation();\r\n  const context = useEnvironment();\r\n  const { login } = context.keycloak;\r\n\r\n  const [credentials, setCredentials] = useState<CredentialContainer[]>();\r\n\r\n  usePromise(\r\n    (signal) => getCredentials({ signal, context }),\r\n    setCredentials,\r\n    [],\r\n  );\r\n\r\n  const credentialRowCells = (\r\n    credMetadata: CredentialMetadataRepresentation,\r\n  ) => {\r\n    const credential = credMetadata.credential;\r\n    const maxWidth = {\r\n      \"--pf-v5-u-max-width--MaxWidth\": \"300px\",\r\n    } as CSSProperties;\r\n    const items = [\r\n      <DataListCell\r\n        key=\"title\"\r\n        data-testrole=\"label\"\r\n        className=\"pf-v5-u-max-width\"\r\n        style={maxWidth}\r\n      >\r\n        {t(credential.userLabel) || t(credential.type as TFuncKey)}\r\n      </DataListCell>,\r\n    ];\r\n\r\n    if (credential.createdDate) {\r\n      items.push(\r\n        <DataListCell\r\n          key={\"created\" + credential.id}\r\n          data-testrole=\"created-at\"\r\n        >\r\n          <Trans i18nKey=\"credentialCreatedAt\">\r\n            <strong className=\"pf-v5-u-mr-md\"></strong>\r\n            {{ date: formatDate(new Date(credential.createdDate)) }}\r\n          </Trans>\r\n        </DataListCell>,\r\n      );\r\n    }\r\n    if (\r\n      credMetadata.infoMessage ||\r\n      credMetadata.infoProperties ||\r\n      (credMetadata.warningMessageTitle &&\r\n        credMetadata.warningMessageDescription)\r\n    ) {\r\n      items.push(\r\n        <DataListCell\r\n          key={\"warning-message\" + credential.id}\r\n          data-testrole=\"warning-message\"\r\n        >\r\n          <>\r\n            {credMetadata.infoMessage && (\r\n              <p>\r\n                <InfoAltIcon />{\" \"}\r\n                {t(\r\n                  credMetadata.infoMessage.key,\r\n                  credMetadata.infoMessage.parameters?.reduce(\r\n                    (acc, val, idx) => ({ ...acc, [idx]: val }),\r\n                    {},\r\n                  ),\r\n                )}\r\n              </p>\r\n            )}\r\n            {credMetadata.infoProperties && (\r\n              <Split className=\"pf-v5-u-mb-lg\">\r\n                <SplitItem>\r\n                  <InfoAltIcon />\r\n                </SplitItem>\r\n                <SplitItem isFilled className=\"pf-v5-u-ml-xs\">\r\n                  <DescriptionList\r\n                    isHorizontal\r\n                    horizontalTermWidthModifier={{\r\n                      \"2xl\": \"15ch\",\r\n                    }}\r\n                  >\r\n                    {credMetadata.infoProperties.map((prop) => (\r\n                      <DescriptionListGroup key={prop.key}>\r\n                        <DescriptionListTerm>{t(prop.key)}</DescriptionListTerm>\r\n                        <DescriptionListDescription>\r\n                          {prop.parameters ? prop.parameters[0] : \"\"}\r\n                        </DescriptionListDescription>\r\n                      </DescriptionListGroup>\r\n                    ))}\r\n                  </DescriptionList>\r\n                </SplitItem>\r\n              </Split>\r\n            )}\r\n            {credMetadata.warningMessageTitle &&\r\n              credMetadata.warningMessageDescription && (\r\n                <>\r\n                  <p>\r\n                    <ExclamationTriangleIcon />{\" \"}\r\n                    {t(\r\n                      credMetadata.warningMessageTitle.key,\r\n                      credMetadata.warningMessageTitle.parameters?.reduce(\r\n                        (acc, val, idx) => ({ ...acc, [idx]: val }),\r\n                        {},\r\n                      ),\r\n                    )}\r\n                  </p>\r\n                  <p>\r\n                    {t(\r\n                      credMetadata.warningMessageDescription.key,\r\n                      credMetadata.warningMessageDescription.parameters?.reduce(\r\n                        (acc, val, idx) => ({ ...acc, [idx]: val }),\r\n                        {},\r\n                      ),\r\n                    )}\r\n                  </p>\r\n                </>\r\n              )}\r\n          </>\r\n        </DataListCell>,\r\n      );\r\n    }\r\n    return items;\r\n  };\r\n\r\n  if (!credentials) {\r\n    return <Spinner />;\r\n  }\r\n\r\n  const credentialUniqueCategories = [\r\n    ...new Set(credentials.map((c) => c.category)),\r\n  ];\r\n\r\n  return (\r\n    <Page title={t(\"signingIn\")} description={t(\"signingInDescription\")}>\r\n      {credentialUniqueCategories.map((category) => (\r\n        <PageSection key={category} variant=\"light\" className=\"pf-v5-u-px-0\">\r\n          <Title headingLevel=\"h2\" size=\"xl\" id={`${category}-categ-title`}>\r\n            {t(category as TFuncKey)}\r\n          </Title>\r\n          {credentials\r\n            .filter((cred) => cred.category == category)\r\n            .map((container) => (\r\n              <Fragment key={container.type}>\r\n                <Split className=\"pf-v5-u-mt-lg pf-v5-u-mb-lg\">\r\n                  <SplitItem>\r\n                    <Title\r\n                      headingLevel=\"h3\"\r\n                      size=\"md\"\r\n                      className=\"pf-v5-u-mb-md\"\r\n                      data-testid={`${container.type}/help`}\r\n                    >\r\n                      <span\r\n                        className=\"cred-title pf-v5-u-display-block\"\r\n                        data-testid={`${container.type}/title`}\r\n                      >\r\n                        {t(container.displayName as TFuncKey)}\r\n                      </span>\r\n                    </Title>\r\n                    <span data-testid={`${container.type}/help-text`}>\r\n                      {t(container.helptext as TFuncKey)}\r\n                    </span>\r\n                  </SplitItem>\r\n                  {container.createAction && (\r\n                    <SplitItem isFilled>\r\n                      <div className=\"pf-v5-u-float-right\">\r\n                        <MobileLink\r\n                          onClick={() =>\r\n                            login({\r\n                              action: container.createAction,\r\n                            })\r\n                          }\r\n                          title={t(\"setUpNew\", {\r\n                            name: t(\r\n                              `${container.type}-display-name` as TFuncKey,\r\n                            ),\r\n                          })}\r\n                          testid={`${container.type}/create`}\r\n                        />\r\n                      </div>\r\n                    </SplitItem>\r\n                  )}\r\n                </Split>\r\n\r\n                <DataList\r\n                  aria-label=\"credential list\"\r\n                  className=\"pf-v5-u-mb-xl\"\r\n                  data-testid={`${container.type}/credential-list`}\r\n                >\r\n                  {container.userCredentialMetadatas.length === 0 && (\r\n                    <EmptyRow\r\n                      message={t(\"notSetUp\", {\r\n                        name: t(container.displayName as TFuncKey),\r\n                      })}\r\n                      data-testid={`${container.type}/not-set-up`}\r\n                    />\r\n                  )}\r\n\r\n                  {container.userCredentialMetadatas.map((meta) => (\r\n                    <DataListItem key={meta.credential.id}>\r\n                      <DataListItemRow id={`cred-${meta.credential.id}`}>\r\n                        <DataListItemCells\r\n                          className=\"pf-v5-u-py-0\"\r\n                          dataListCells={[\r\n                            ...credentialRowCells(meta),\r\n                            <DataListAction\r\n                              key=\"action\"\r\n                              id={`action-${meta.credential.id}`}\r\n                              aria-label={t(\"updateCredAriaLabel\")}\r\n                              aria-labelledby={`cred-${meta.credential.id}`}\r\n                            >\r\n                              {container.removeable && (\r\n                                <Button\r\n                                  variant=\"danger\"\r\n                                  data-testrole=\"remove\"\r\n                                  onClick={async () => {\r\n                                    await login({\r\n                                      action:\r\n                                        \"delete_credential:\" +\r\n                                        meta.credential.id,\r\n                                    });\r\n                                  }}\r\n                                >\r\n                                  {t(\"delete\")}\r\n                                </Button>\r\n                              )}\r\n                              {container.updateAction && (\r\n                                <Button\r\n                                  variant=\"secondary\"\r\n                                  onClick={async () => {\r\n                                    await login({\r\n                                      action: container.updateAction,\r\n                                    });\r\n                                  }}\r\n                                  data-testrole=\"update\"\r\n                                >\r\n                                  {t(\"update\")}\r\n                                </Button>\r\n                              )}\r\n                            </DataListAction>,\r\n                          ]}\r\n                        />\r\n                      </DataListItemRow>\r\n                    </DataListItem>\r\n                  ))}\r\n                </DataList>\r\n              </Fragment>\r\n            ))}\r\n        </PageSection>\r\n      ))}\r\n    </Page>\r\n  );\r\n};\r\n\r\nexport default SigningIn;\r\n"],"names":["MobileLink","title","onClick","testid","open","setOpen","useState","jsxs","Fragment","jsx","Dropdown","isOpen","toggleRef","MenuToggle","EllipsisVIcon","DropdownItem","Button","SigningIn","t","useTranslation","context","useEnvironment","login","credentials","setCredentials","usePromise","signal","getCredentials","credentialRowCells","credMetadata","credential","items","DataListCell","Trans","formatDate","InfoAltIcon","acc","val","idx","Split","SplitItem","DescriptionList","prop","DescriptionListGroup","DescriptionListTerm","DescriptionListDescription","ExclamationTriangleIcon","Spinner","credentialUniqueCategories","c","Page","category","PageSection","Title","cred","container","DataList","EmptyRow","meta","DataListItem","DataListItemRow","DataListItemCells","DataListAction"],"mappings":"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"}