{"version":3,"file":"Groups-DotyyAXC.js","sources":["../../../../../../../src/groups/Groups.tsx"],"sourcesContent":["import {\r\n  Checkbox,\r\n  DataList,\r\n  DataListCell,\r\n  DataListItem,\r\n  DataListItemCells,\r\n  DataListItemRow,\r\n} from \"@patternfly/react-core\";\r\nimport { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useEnvironment } from \"@keycloak/keycloak-ui-shared\";\r\nimport { getGroups } from \"../api/methods\";\r\nimport { Group } from \"../api/representations\";\r\nimport { Page } from \"../components/page/Page\";\r\nimport { usePromise } from \"../utils/usePromise\";\r\n\r\nexport const Groups = () => {\r\n  const { t } = useTranslation();\r\n  const context = useEnvironment();\r\n\r\n  const [groups, setGroups] = useState<Group[]>([]);\r\n  const [directMembership, setDirectMembership] = useState(false);\r\n\r\n  usePromise(\r\n    (signal) => getGroups({ signal, context }),\r\n    (groups) => {\r\n      if (!directMembership) {\r\n        groups.forEach((el) =>\r\n          getParents(\r\n            el,\r\n            groups,\r\n            groups.map(({ path }) => path),\r\n          ),\r\n        );\r\n      }\r\n      setGroups(groups);\r\n    },\r\n    [directMembership],\r\n  );\r\n\r\n  const getParents = (el: Group, groups: Group[], groupsPaths: string[]) => {\r\n    const parentPath = el.path.slice(0, el.path.lastIndexOf(\"/\"));\r\n    if (parentPath && !groupsPaths.includes(parentPath)) {\r\n      el = {\r\n        name: parentPath.slice(parentPath.lastIndexOf(\"/\") + 1),\r\n        path: parentPath,\r\n      };\r\n      groups.push(el);\r\n      groupsPaths.push(parentPath);\r\n\r\n      getParents(el, groups, groupsPaths);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Page title={t(\"groups\")} description={t(\"groupDescriptionLabel\")}>\r\n      <DataList id=\"groups-list\" aria-label={t(\"groups\")} isCompact>\r\n        <DataListItem\r\n          id=\"groups-list-header\"\r\n          aria-label={t(\"groupsListHeader\")}\r\n        >\r\n          <DataListItemRow>\r\n            <DataListItemCells\r\n              dataListCells={[\r\n                <DataListCell key=\"directMembership-header\">\r\n                  <Checkbox\r\n                    label={t(\"directMembership\")}\r\n                    id=\"directMembership-checkbox\"\r\n                    data-testid=\"directMembership-checkbox\"\r\n                    isChecked={directMembership}\r\n                    onChange={(_event, checked) => setDirectMembership(checked)}\r\n                  />\r\n                </DataListCell>,\r\n              ]}\r\n            />\r\n          </DataListItemRow>\r\n        </DataListItem>\r\n        <DataListItem\r\n          id=\"groups-list-columns-names\"\r\n          aria-label={t(\"groupsListColumnsNames\")}\r\n        >\r\n          <DataListItemRow>\r\n            <DataListItemCells\r\n              dataListCells={[\r\n                <DataListCell key=\"group-name-header\" width={2}>\r\n                  <strong>{t(\"name\")}</strong>\r\n                </DataListCell>,\r\n                <DataListCell key=\"group-path-header\" width={2}>\r\n                  <strong>{t(\"path\")}</strong>\r\n                </DataListCell>,\r\n                <DataListCell key=\"group-direct-membership-header\" width={2}>\r\n                  <strong>{t(\"directMembership\")}</strong>\r\n                </DataListCell>,\r\n              ]}\r\n            />\r\n          </DataListItemRow>\r\n        </DataListItem>\r\n        {groups.map((group, appIndex) => (\r\n          <DataListItem\r\n            id={`${appIndex}-group`}\r\n            key={\"group-\" + appIndex}\r\n            aria-labelledby=\"groups-list\"\r\n          >\r\n            <DataListItemRow>\r\n              <DataListItemCells\r\n                dataListCells={[\r\n                  <DataListCell\r\n                    data-testid={`group[${appIndex}].name`}\r\n                    width={2}\r\n                    key={\"name-\" + appIndex}\r\n                  >\r\n                    {group.name}\r\n                  </DataListCell>,\r\n                  <DataListCell\r\n                    id={`${appIndex}-group-path`}\r\n                    width={2}\r\n                    key={\"path-\" + appIndex}\r\n                  >\r\n                    {group.path}\r\n                  </DataListCell>,\r\n                  <DataListCell\r\n                    id={`${appIndex}-group-directMembership`}\r\n                    width={2}\r\n                    key={\"directMembership-\" + appIndex}\r\n                  >\r\n                    <Checkbox\r\n                      id={`${appIndex}-checkbox-directMembership`}\r\n                      isChecked={group.id != null}\r\n                      isDisabled={true}\r\n                    />\r\n                  </DataListCell>,\r\n                ]}\r\n              />\r\n            </DataListItemRow>\r\n          </DataListItem>\r\n        ))}\r\n      </DataList>\r\n    </Page>\r\n  );\r\n};\r\n\r\nexport default Groups;\r\n"],"names":["Groups","t","useTranslation","context","useEnvironment","groups","setGroups","useState","directMembership","setDirectMembership","usePromise","signal","getGroups","el","getParents","path","groupsPaths","parentPath","Page","jsxs","DataList","jsx","DataListItem","DataListItemRow","DataListItemCells","DataListCell","Checkbox","_event","checked","group","appIndex"],"mappings":"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"}