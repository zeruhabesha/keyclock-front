{"version":3,"file":"SearchFilter-DrmfdyKI.js","sources":["../../../../../../../src/client-scopes/ChangeTypeDropdown.tsx","../../../../../../../src/client-scopes/details/SearchFilter.tsx"],"sourcesContent":["import {\r\n  AlertVariant,\r\n  MenuToggle,\r\n  Select,\r\n  SelectList,\r\n} from \"@patternfly/react-core\";\r\nimport { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport type { Row } from \"../clients/scopes/ClientScopes\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  ClientScope,\r\n  allClientScopeTypes,\r\n  changeClientScope,\r\n  changeScope,\r\n  clientScopeTypesSelectOptions,\r\n} from \"../components/client-scope/ClientScopeTypes\";\r\n\r\ntype ChangeTypeDropdownProps = {\r\n  clientId?: string;\r\n  selectedRows: Row[];\r\n  refresh: () => void;\r\n};\r\n\r\nexport const ChangeTypeDropdown = ({\r\n  clientId,\r\n  selectedRows,\r\n  refresh,\r\n}: ChangeTypeDropdownProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const [open, setOpen] = useState(false);\r\n\r\n  const { addAlert, addError } = useAlerts();\r\n\r\n  return (\r\n    <Select\r\n      aria-label=\"change-type-to\"\r\n      onOpenChange={(isOpen) => setOpen(isOpen)}\r\n      isOpen={open}\r\n      toggle={(ref) => (\r\n        <MenuToggle\r\n          id=\"change-type-dropdown\"\r\n          isDisabled={selectedRows.length === 0}\r\n          ref={ref}\r\n          onClick={() => setOpen(!open)}\r\n          isExpanded={open}\r\n        >\r\n          {t(\"changeTypeTo\")}\r\n        </MenuToggle>\r\n      )}\r\n      onSelect={async (_, value) => {\r\n        try {\r\n          await Promise.all(\r\n            selectedRows.map((row) => {\r\n              return clientId\r\n                ? changeClientScope(\r\n                    adminClient,\r\n                    clientId,\r\n                    row,\r\n                    row.type,\r\n                    value as ClientScope,\r\n                  )\r\n                : changeScope(adminClient, row, value as ClientScope);\r\n            }),\r\n          );\r\n          setOpen(false);\r\n          refresh();\r\n          addAlert(t(\"clientScopeSuccess\"), AlertVariant.success);\r\n        } catch (error) {\r\n          addError(\"clientScopeError\", error);\r\n        }\r\n      }}\r\n    >\r\n      <SelectList>\r\n        {clientScopeTypesSelectOptions(\r\n          t,\r\n          !clientId ? allClientScopeTypes : undefined,\r\n        )}\r\n      </SelectList>\r\n    </Select>\r\n  );\r\n};\r\n","import { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport {\r\n  Dropdown,\r\n  DropdownItem,\r\n  DropdownList,\r\n  MenuToggle,\r\n  Select,\r\n  SelectList,\r\n  SelectOption,\r\n  ToolbarItem,\r\n} from \"@patternfly/react-core\";\r\nimport { FilterIcon } from \"@patternfly/react-icons\";\r\n\r\nimport {\r\n  AllClientScopes,\r\n  AllClientScopeType,\r\n  clientScopeTypesSelectOptions,\r\n} from \"../../components/client-scope/ClientScopeTypes\";\r\nimport type { Row } from \"../../clients/scopes/ClientScopes\";\r\nimport useIsFeatureEnabled, { Feature } from \"../../utils/useIsFeatureEnabled\";\r\nimport { useMemo } from \"react\";\r\n\r\nexport type SearchType = \"name\" | \"type\" | \"protocol\";\r\nexport const PROTOCOLS = [\"all\", \"saml\", \"openid-connect\"] as const;\r\nexport type ProtocolType = (typeof PROTOCOLS)[number] | \"oid4vc\";\r\n\r\nexport const nameFilter =\r\n  (search = \"\") =>\r\n  (scope: Row) =>\r\n    scope.name?.includes(search);\r\nexport const typeFilter = (type: AllClientScopeType) => (scope: Row) =>\r\n  type === AllClientScopes.none || scope.type === type;\r\n\r\nexport const protocolFilter = (protocol: ProtocolType) => (scope: Row) =>\r\n  protocol === \"all\" || scope.protocol === protocol;\r\n\r\ntype SearchToolbarProps = Omit<SearchDropdownProps, \"withProtocol\"> & {\r\n  type: AllClientScopeType;\r\n  onType: (value: AllClientScopes) => void;\r\n  protocol?: ProtocolType;\r\n  onProtocol?: (value: ProtocolType) => void;\r\n};\r\n\r\ntype SearchDropdownProps = {\r\n  searchType: SearchType;\r\n  onSelect: (value: SearchType) => void;\r\n  withProtocol?: boolean;\r\n};\r\n\r\nexport const SearchDropdown = ({\r\n  searchType,\r\n  withProtocol = false,\r\n  onSelect,\r\n}: SearchDropdownProps) => {\r\n  const { t } = useTranslation();\r\n  const [searchToggle, setSearchToggle] = useState(false);\r\n\r\n  const createDropdown = (searchType: SearchType) => (\r\n    <DropdownItem\r\n      key={searchType}\r\n      onClick={() => {\r\n        onSelect(searchType);\r\n        setSearchToggle(false);\r\n      }}\r\n    >\r\n      {t(`clientScopeSearch.${searchType}`)}\r\n    </DropdownItem>\r\n  );\r\n  const options = [createDropdown(\"name\"), createDropdown(\"type\")];\r\n  if (withProtocol) {\r\n    options.push(createDropdown(\"protocol\"));\r\n  }\r\n\r\n  return (\r\n    <Dropdown\r\n      onOpenChange={(isOpen) => setSearchToggle(isOpen)}\r\n      toggle={(ref) => (\r\n        <MenuToggle\r\n          data-testid=\"clientScopeSearch\"\r\n          ref={ref}\r\n          id=\"toggle-id\"\r\n          onClick={() => setSearchToggle(!searchToggle)}\r\n        >\r\n          <FilterIcon /> {t(`clientScopeSearch.${searchType}`)}\r\n        </MenuToggle>\r\n      )}\r\n      isOpen={searchToggle}\r\n    >\r\n      <DropdownList>{options}</DropdownList>\r\n    </Dropdown>\r\n  );\r\n};\r\n\r\nexport const SearchToolbar = ({\r\n  searchType,\r\n  onSelect,\r\n  type,\r\n  onType,\r\n  protocol,\r\n  onProtocol,\r\n}: SearchToolbarProps) => {\r\n  const { t } = useTranslation();\r\n  const [open, setOpen] = useState(false);\r\n  const isFeatureEnabled = useIsFeatureEnabled();\r\n  const protocols = useMemo<readonly ProtocolType[]>(\r\n    () =>\r\n      isFeatureEnabled(Feature.OpenId4VCI)\r\n        ? ([...PROTOCOLS, \"oid4vc\"] as const)\r\n        : PROTOCOLS,\r\n    [isFeatureEnabled],\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {searchType === \"type\" && (\r\n        <>\r\n          <ToolbarItem>\r\n            <SearchDropdown\r\n              searchType={searchType}\r\n              onSelect={onSelect}\r\n              withProtocol={!!protocol}\r\n            />\r\n          </ToolbarItem>\r\n          <ToolbarItem>\r\n            <Select\r\n              toggle={(ref) => (\r\n                <MenuToggle\r\n                  data-testid=\"clientScopeSearchType\"\r\n                  ref={ref}\r\n                  isExpanded={open}\r\n                  onClick={() => setOpen(!open)}\r\n                >\r\n                  {type === AllClientScopes.none\r\n                    ? t(\"allTypes\")\r\n                    : t(`clientScopeTypes.${type}`)}\r\n                </MenuToggle>\r\n              )}\r\n              onOpenChange={(val) => setOpen(val)}\r\n              isOpen={open}\r\n              selected={\r\n                type === AllClientScopes.none\r\n                  ? t(\"allTypes\")\r\n                  : t(`clientScopeTypes.${type}`)\r\n              }\r\n              onSelect={(_, value) => {\r\n                onType(value as AllClientScopes);\r\n                setOpen(false);\r\n              }}\r\n            >\r\n              <SelectList>\r\n                <SelectOption value={AllClientScopes.none}>\r\n                  {t(\"allTypes\")}\r\n                </SelectOption>\r\n                {clientScopeTypesSelectOptions(t)}\r\n              </SelectList>\r\n            </Select>\r\n          </ToolbarItem>\r\n        </>\r\n      )}\r\n      {searchType === \"protocol\" && !!protocol && (\r\n        <>\r\n          <ToolbarItem>\r\n            <SearchDropdown\r\n              searchType={searchType}\r\n              onSelect={onSelect}\r\n              withProtocol\r\n            />\r\n          </ToolbarItem>\r\n          <ToolbarItem>\r\n            <Select\r\n              toggle={(ref) => (\r\n                <MenuToggle\r\n                  data-testid=\"clientScopeSearchProtocol\"\r\n                  ref={ref}\r\n                  isExpanded={open}\r\n                  onClick={() => setOpen(!open)}\r\n                >\r\n                  {t(`protocolTypes.${protocol}`)}\r\n                </MenuToggle>\r\n              )}\r\n              onOpenChange={(val) => setOpen(val)}\r\n              isOpen={open}\r\n              selected={t(`protocolTypes.${protocol}`)}\r\n              onSelect={(_, value) => {\r\n                onProtocol?.(value as ProtocolType);\r\n                setOpen(false);\r\n              }}\r\n            >\r\n              <SelectList>\r\n                {protocols.map((type) => (\r\n                  <SelectOption key={type} value={type}>\r\n                    {t(`protocolTypes.${type}`)}\r\n                  </SelectOption>\r\n                ))}\r\n              </SelectList>\r\n            </Select>\r\n          </ToolbarItem>\r\n        </>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n"],"names":["ChangeTypeDropdown","clientId","selectedRows","refresh","adminClient","useAdminClient","t","useTranslation","open","setOpen","useState","addAlert","addError","useAlerts","jsx","Select","isOpen","ref","MenuToggle","_","value","row","changeClientScope","changeScope","AlertVariant","error","SelectList","clientScopeTypesSelectOptions","allClientScopeTypes","PROTOCOLS","nameFilter","search","scope","typeFilter","type","AllClientScopes","protocolFilter","protocol","SearchDropdown","searchType","withProtocol","onSelect","searchToggle","setSearchToggle","createDropdown","DropdownItem","options","Dropdown","jsxs","FilterIcon","DropdownList","SearchToolbar","onType","onProtocol","isFeatureEnabled","useIsFeatureEnabled","protocols","useMemo","Feature","Fragment","ToolbarItem","val","SelectOption"],"mappings":"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"}