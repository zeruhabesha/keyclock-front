{"version":3,"file":"RoleMapping-BOcI-Nkp.js","sources":["../../../../../../../src/components/role-mapping/queries.ts","../../../../../../../src/components/role-mapping/resource.ts","../../../../../../../src/components/role-mapping/AddRoleMappingModal.tsx","../../../../../../../src/components/role-mapping/RoleMapping.tsx"],"sourcesContent":["import type KeycloakAdminClient from \"@keycloak/keycloak-admin-client\";\r\nimport type MappingsRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/mappingsRepresentation\";\r\nimport type RoleRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/roleRepresentation\";\r\nimport type { ClientScopes } from \"@keycloak/keycloak-admin-client/lib/resources/clientScopes\";\r\nimport type { Clients } from \"@keycloak/keycloak-admin-client/lib/resources/clients\";\r\nimport type { Groups } from \"@keycloak/keycloak-admin-client/lib/resources/groups\";\r\nimport type { Roles } from \"@keycloak/keycloak-admin-client/lib/resources/roles\";\r\nimport type { Users } from \"@keycloak/keycloak-admin-client/lib/resources/users\";\r\nimport { Row } from \"./RoleMapping\";\r\n\r\nexport type ResourcesKey = keyof KeycloakAdminClient;\r\n\r\ntype DeleteFunctions =\r\n  | keyof Pick<Groups, \"delClientRoleMappings\" | \"delRealmRoleMappings\">\r\n  | keyof Pick<ClientScopes, \"delClientScopeMappings\" | \"delRealmScopeMappings\">\r\n  | keyof Pick<Roles, \"delCompositeRoles\">;\r\n\r\ntype ListEffectiveFunction =\r\n  | keyof Pick<Clients, \"listCompositeRealmScopeMappings\">\r\n  | keyof Pick<Groups, \"listRoleMappings\" | \"listAvailableRealmRoleMappings\">\r\n  | keyof Pick<\r\n      ClientScopes,\r\n      | \"listScopeMappings\"\r\n      | \"listAvailableRealmScopeMappings\"\r\n      | \"listCompositeClientScopeMappings\"\r\n    >\r\n  | keyof Pick<Roles, \"getCompositeRoles\" | \"getCompositeRolesForClient\">\r\n  | keyof Pick<\r\n      Users,\r\n      \"listCompositeClientRoleMappings\" | \"listCompositeRealmRoleMappings\"\r\n    >;\r\n\r\ntype ListAvailableFunction =\r\n  | keyof Pick<\r\n      Groups,\r\n      \"listAvailableClientRoleMappings\" | \"listAvailableRealmRoleMappings\"\r\n    >\r\n  | keyof Pick<\r\n      ClientScopes,\r\n      \"listAvailableClientScopeMappings\" | \"listAvailableRealmScopeMappings\"\r\n    >\r\n  | keyof Pick<Roles, \"find\">\r\n  | keyof Pick<Clients, \"listRoles\">;\r\n\r\ntype FunctionMapping = {\r\n  delete: DeleteFunctions[];\r\n  listAvailable: ListAvailableFunction[];\r\n  listEffective: ListEffectiveFunction[];\r\n};\r\n\r\ntype ResourceMapping = Partial<Record<ResourcesKey, FunctionMapping>>;\r\nconst groupFunctions: FunctionMapping = {\r\n  delete: [\"delClientRoleMappings\", \"delRealmRoleMappings\"],\r\n  listEffective: [\r\n    \"listRoleMappings\",\r\n    \"listCompositeRealmRoleMappings\",\r\n    \"listCompositeClientRoleMappings\",\r\n  ],\r\n  listAvailable: [\r\n    \"listAvailableClientRoleMappings\",\r\n    \"listAvailableRealmRoleMappings\",\r\n  ],\r\n};\r\n\r\nconst clientFunctions: FunctionMapping = {\r\n  delete: [\"delClientScopeMappings\", \"delRealmScopeMappings\"],\r\n  listEffective: [\r\n    \"listScopeMappings\",\r\n    \"listCompositeRealmScopeMappings\",\r\n    \"listCompositeClientScopeMappings\",\r\n  ],\r\n  listAvailable: [\r\n    \"listAvailableClientScopeMappings\",\r\n    \"listAvailableRealmScopeMappings\",\r\n  ],\r\n};\r\n\r\nconst mapping: ResourceMapping = {\r\n  groups: groupFunctions,\r\n  users: groupFunctions,\r\n  clientScopes: clientFunctions,\r\n  clients: clientFunctions,\r\n  roles: {\r\n    delete: [\"delCompositeRoles\", \"delCompositeRoles\"],\r\n    listEffective: [\r\n      \"getCompositeRoles\",\r\n      \"getCompositeRoles\",\r\n      \"getCompositeRolesForClient\",\r\n    ],\r\n    listAvailable: [\"listRoles\", \"find\"],\r\n  },\r\n};\r\n\r\ntype queryType =\r\n  | DeleteFunctions\r\n  | ListAvailableFunction\r\n  | ListEffectiveFunction;\r\n\r\nconst castAdminClient = (\r\n  adminClient: KeycloakAdminClient,\r\n  resource: ResourcesKey,\r\n) =>\r\n  adminClient[resource] as unknown as {\r\n    [index in queryType]: (...params: any) => Promise<RoleRepresentation[]>;\r\n  };\r\n\r\nconst applyQuery = (\r\n  adminClient: KeycloakAdminClient,\r\n  type: ResourcesKey,\r\n  query: queryType,\r\n  ...params: object[]\r\n): Promise<RoleRepresentation[]> =>\r\n  castAdminClient(adminClient, type)[query](...params);\r\n\r\nexport const deleteMapping = (\r\n  adminClient: KeycloakAdminClient,\r\n  type: ResourcesKey,\r\n  id: string,\r\n  rows: Row[],\r\n) =>\r\n  rows.map((row) => {\r\n    const role = { id: row.role.id!, name: row.role.name! };\r\n    const query = mapping[type]?.delete[row.client ? 0 : 1]!;\r\n\r\n    return applyQuery(\r\n      adminClient,\r\n      type,\r\n      query,\r\n      {\r\n        id,\r\n        clientUniqueId: row.client?.id,\r\n        client: row.client?.id,\r\n        roles: [role],\r\n      },\r\n      [role],\r\n    );\r\n  });\r\n\r\nexport const getMapping = async (\r\n  adminClient: KeycloakAdminClient,\r\n  type: ResourcesKey,\r\n  id: string,\r\n): Promise<MappingsRepresentation> => {\r\n  const query = mapping[type]!.listEffective[0];\r\n  const result = applyQuery(adminClient, type, query, { id });\r\n  if (type !== \"roles\") {\r\n    return result as MappingsRepresentation;\r\n  }\r\n  const roles = await result;\r\n  const clientRoles = await Promise.all(\r\n    roles\r\n      .filter((r) => r.clientRole)\r\n      .map(async (role) => {\r\n        const client = await adminClient.clients.findOne({\r\n          id: role.containerId!,\r\n        });\r\n\r\n        role.containerId = client?.clientId;\r\n        return { ...client, mappings: [role] };\r\n      }),\r\n  );\r\n\r\n  return {\r\n    clientMappings: clientRoles,\r\n    realmMappings: roles.filter((r) => !r.clientRole),\r\n  };\r\n};\r\n\r\nexport const getEffectiveRoles = async (\r\n  adminClient: KeycloakAdminClient,\r\n  type: ResourcesKey,\r\n  id: string,\r\n): Promise<Row[]> => {\r\n  const query = mapping[type]!.listEffective[1];\r\n  if (type !== \"roles\") {\r\n    return (await applyQuery(adminClient, type, query, { id })).map((role) => ({\r\n      role,\r\n    }));\r\n  }\r\n  const roles = await applyQuery(adminClient, type, query, { id });\r\n  const parentRoles = await Promise.all(\r\n    roles\r\n      .filter((r) => r.composite)\r\n      .map((r) => applyQuery(adminClient, type, query, { id: r.id })),\r\n  );\r\n  return [...roles, ...parentRoles.flat()].map((role) => ({ role }));\r\n};\r\n\r\nexport const getAvailableRoles = async (\r\n  adminClient: KeycloakAdminClient,\r\n  type: ResourcesKey,\r\n  params: Record<string, string | number>,\r\n): Promise<Row[]> => {\r\n  const query = mapping[type]!.listAvailable[1];\r\n  return (await applyQuery(adminClient, type, query, params)).map((role) => ({\r\n    role,\r\n  }));\r\n};\r\n","import type UserRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/userRepresentation\";\r\n\r\nimport { fetchAdminUI } from \"../../context/auth/admin-ui-endpoint\";\r\nimport KeycloakAdminClient from \"@keycloak/keycloak-admin-client\";\r\n\r\ntype IDQuery = {\r\n  id: string;\r\n  type: string;\r\n};\r\n\r\ntype PaginatingQuery = IDQuery & {\r\n  first: number;\r\n  max: number;\r\n  search?: string;\r\n};\r\n\r\ntype EffectiveClientRolesQuery = IDQuery;\r\n\r\ntype Query = Partial<Omit<PaginatingQuery, \"adminClient\">> & {\r\n  endpoint: string;\r\n};\r\n\r\ntype ClientRole = {\r\n  id: string;\r\n  role: string;\r\n  description?: string;\r\n  client: string;\r\n  clientId: string;\r\n};\r\n\r\nconst fetchEndpoint = async (\r\n  adminClient: KeycloakAdminClient,\r\n  { id, type, first, max, search, endpoint }: Query,\r\n): Promise<any> =>\r\n  fetchAdminUI(\r\n    adminClient,\r\n    `/ui-ext/${endpoint}/${type}/${encodeURIComponent(id!)}`,\r\n    {\r\n      first: (first || 0).toString(),\r\n      max: (max || 10).toString(),\r\n      search: search || \"\",\r\n    },\r\n  );\r\n\r\nexport const getAvailableClientRoles = (\r\n  adminClient: KeycloakAdminClient,\r\n  query: PaginatingQuery,\r\n): Promise<ClientRole[]> =>\r\n  fetchEndpoint(adminClient, { ...query, endpoint: \"available-roles\" });\r\n\r\nexport const getEffectiveClientRoles = (\r\n  adminClient: KeycloakAdminClient,\r\n  query: EffectiveClientRolesQuery,\r\n): Promise<ClientRole[]> =>\r\n  fetchEndpoint(adminClient, { ...query, endpoint: \"effective-roles\" });\r\n\r\ntype UserQuery = {\r\n  lastName?: string;\r\n  firstName?: string;\r\n  email?: string;\r\n  username?: string;\r\n  emailVerified?: boolean;\r\n  idpAlias?: string;\r\n  idpUserId?: string;\r\n  enabled?: boolean;\r\n  briefRepresentation?: boolean;\r\n  exact?: boolean;\r\n  q?: string;\r\n};\r\n\r\nexport type BruteUser = UserRepresentation & {\r\n  bruteForceStatus?: Record<string, object>;\r\n};\r\n\r\nexport const findUsers = (\r\n  adminClient: KeycloakAdminClient,\r\n  query: UserQuery,\r\n): Promise<BruteUser[]> =>\r\n  fetchAdminUI(\r\n    adminClient,\r\n    \"ui-ext/brute-force-user\",\r\n    query as Record<string, string>,\r\n  );\r\n\r\nexport const fetchUsedBy = (\r\n  adminClient: KeycloakAdminClient,\r\n  query: PaginatingQuery,\r\n): Promise<string[]> =>\r\n  fetchEndpoint(adminClient, {\r\n    ...query,\r\n    endpoint: \"authentication-management\",\r\n  });\r\n","import RoleRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/roleRepresentation\";\r\nimport {\r\n  KeycloakDataTable,\r\n  ListEmptyState,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  Button,\r\n  Dropdown,\r\n  DropdownItem,\r\n  DropdownList,\r\n  DropdownProps,\r\n  MenuToggle,\r\n  Modal,\r\n  ModalVariant,\r\n} from \"@patternfly/react-core\";\r\nimport { cellWidth, TableText } from \"@patternfly/react-table\";\r\nimport { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { useAccess } from \"../../context/access/Access\";\r\nimport { translationFormatter } from \"../../utils/translationFormatter\";\r\nimport useLocaleSort from \"../../utils/useLocaleSort\";\r\nimport useToggle from \"../../utils/useToggle\";\r\nimport { ResourcesKey, Row } from \"./RoleMapping\";\r\nimport { getAvailableRoles } from \"./queries\";\r\nimport { getAvailableClientRoles } from \"./resource\";\r\n\r\ntype AddRoleMappingModalProps = {\r\n  id: string;\r\n  type: ResourcesKey;\r\n  filterType: FilterType;\r\n  name?: string;\r\n  isRadio?: boolean;\r\n  onAssign: (rows: Row[]) => void;\r\n  onClose: () => void;\r\n  title?: string;\r\n  actionLabel?: string;\r\n};\r\n\r\nexport type FilterType = \"roles\" | \"clients\";\r\n\r\nconst RoleDescription = ({ role }: { role: RoleRepresentation }) => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <TableText wrapModifier=\"truncate\">\r\n      {translationFormatter(t)(role.description) as string}\r\n    </TableText>\r\n  );\r\n};\r\n\r\ntype AddRoleButtonProps = Omit<\r\n  DropdownProps,\r\n  \"children\" | \"toggle\" | \"isOpen\" | \"onOpenChange\"\r\n> & {\r\n  label?: string;\r\n  variant?: \"default\" | \"plain\" | \"primary\" | \"plainText\" | \"secondary\";\r\n  isDisabled?: boolean;\r\n  onFilerTypeChange: (type: FilterType) => void;\r\n};\r\n\r\nexport const AddRoleButton = ({\r\n  label,\r\n  variant,\r\n  isDisabled,\r\n  onFilerTypeChange,\r\n  ...rest\r\n}: AddRoleButtonProps) => {\r\n  const { t } = useTranslation();\r\n  const [open, toggle] = useToggle();\r\n\r\n  const { hasAccess } = useAccess();\r\n  const canViewRealmRoles = hasAccess(\"view-realm\") || hasAccess(\"query-users\");\r\n\r\n  return (\r\n    <Dropdown\r\n      onOpenChange={toggle}\r\n      toggle={(ref) => (\r\n        <MenuToggle\r\n          ref={ref}\r\n          onClick={toggle}\r\n          variant={variant || \"primary\"}\r\n          isDisabled={isDisabled}\r\n          data-testid=\"add-role-mapping-button\"\r\n        >\r\n          {t(label || \"assignRole\")}\r\n        </MenuToggle>\r\n      )}\r\n      isOpen={open}\r\n      {...rest}\r\n    >\r\n      <DropdownList>\r\n        <DropdownItem\r\n          data-testid=\"client-role\"\r\n          component=\"button\"\r\n          onClick={() => {\r\n            onFilerTypeChange(\"clients\");\r\n          }}\r\n        >\r\n          {t(\"clientRoles\")}\r\n        </DropdownItem>\r\n        {canViewRealmRoles && (\r\n          <DropdownItem\r\n            data-testid=\"roles-role\"\r\n            component=\"button\"\r\n            onClick={() => {\r\n              onFilerTypeChange(\"roles\");\r\n            }}\r\n          >\r\n            {t(\"realmRoles\")}\r\n          </DropdownItem>\r\n        )}\r\n      </DropdownList>\r\n    </Dropdown>\r\n  );\r\n};\r\n\r\nexport const AddRoleMappingModal = ({\r\n  id,\r\n  name,\r\n  type,\r\n  isRadio,\r\n  filterType,\r\n  onAssign,\r\n  onClose,\r\n  title,\r\n  actionLabel,\r\n}: AddRoleMappingModalProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const [selectedRows, setSelectedRows] = useState<Row[]>([]);\r\n\r\n  const localeSort = useLocaleSort();\r\n  const compareRow = ({ role: { name } }: Row) => name?.toUpperCase();\r\n\r\n  const loader = async (\r\n    first?: number,\r\n    max?: number,\r\n    search?: string,\r\n  ): Promise<Row[]> => {\r\n    const params: Record<string, string | number> = {\r\n      first: first!,\r\n      max: max!,\r\n    };\r\n\r\n    if (search) {\r\n      params.search = search;\r\n    }\r\n\r\n    const roles = await getAvailableRoles(adminClient, type, { ...params, id });\r\n    const sorted = localeSort(roles, compareRow);\r\n    return sorted.map((row) => {\r\n      return {\r\n        role: row.role,\r\n        id: row.role.id,\r\n      };\r\n    });\r\n  };\r\n\r\n  const clientRolesLoader = async (\r\n    first?: number,\r\n    max?: number,\r\n    search?: string,\r\n  ): Promise<Row[]> => {\r\n    const roles = await getAvailableClientRoles(adminClient, {\r\n      id,\r\n      type,\r\n      first: first || 0,\r\n      max: max || 10,\r\n      search,\r\n    });\r\n\r\n    return localeSort(\r\n      roles.map((e) => ({\r\n        client: { clientId: e.client, id: e.clientId },\r\n        role: { id: e.id, name: e.role, description: e.description },\r\n        id: e.id,\r\n      })),\r\n      ({ client: { clientId }, role: { name } }) => `${clientId}${name}`,\r\n    );\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      name: \"role.name\",\r\n      displayKey: \"name\",\r\n      transforms: [cellWidth(30)],\r\n    },\r\n    {\r\n      name: \"client.clientId\",\r\n      displayKey: \"clientId\",\r\n    },\r\n    {\r\n      name: \"role.description\",\r\n      displayKey: \"description\",\r\n      cellRenderer: RoleDescription,\r\n    },\r\n  ];\r\n\r\n  if (filterType === \"roles\") {\r\n    columns.splice(1, 1);\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      variant={ModalVariant.large}\r\n      title={\r\n        title ||\r\n        t(\"assignRolesTo\", {\r\n          type: filterType === \"roles\" ? t(\"realm\") : t(\"client\"),\r\n          client: name,\r\n        })\r\n      }\r\n      isOpen\r\n      onClose={onClose}\r\n      actions={[\r\n        <Button\r\n          data-testid=\"assign\"\r\n          key=\"confirm\"\r\n          isDisabled={selectedRows.length === 0}\r\n          variant=\"primary\"\r\n          onClick={() => {\r\n            onAssign(selectedRows);\r\n            onClose();\r\n          }}\r\n        >\r\n          {actionLabel || t(\"assign\")}\r\n        </Button>,\r\n        <Button\r\n          data-testid=\"cancel\"\r\n          key=\"cancel\"\r\n          variant=\"link\"\r\n          onClick={onClose}\r\n        >\r\n          {t(\"cancel\")}\r\n        </Button>,\r\n      ]}\r\n    >\r\n      <KeycloakDataTable\r\n        onSelect={(rows) => setSelectedRows([...rows])}\r\n        searchPlaceholderKey={\r\n          filterType === \"roles\" ? \"searchByRoleName\" : \"search\"\r\n        }\r\n        isPaginated={!(filterType === \"roles\" && type !== \"roles\")}\r\n        canSelectAll\r\n        isRadio={isRadio}\r\n        loader={filterType === \"roles\" ? loader : clientRolesLoader}\r\n        ariaLabelKey=\"associatedRolesText\"\r\n        columns={columns}\r\n        emptyState={\r\n          <ListEmptyState\r\n            message={t(\"noRoles\")}\r\n            instructions={t(\"noRealmRolesToAssign\")}\r\n          />\r\n        }\r\n      />\r\n    </Modal>\r\n  );\r\n};\r\n","import type KeycloakAdminClient from \"@keycloak/keycloak-admin-client\";\r\nimport type ClientRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/clientRepresentation\";\r\nimport type RoleRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/roleRepresentation\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  AlertVariant,\r\n  Badge,\r\n  Button,\r\n  ButtonVariant,\r\n  Checkbox,\r\n  ToolbarItem,\r\n} from \"@patternfly/react-core\";\r\nimport { cellWidth } from \"@patternfly/react-table\";\r\nimport { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { emptyFormatter, upperCaseFormatter } from \"../../util\";\r\nimport { translationFormatter } from \"../../utils/translationFormatter\";\r\nimport { useConfirmDialog } from \"../confirm-dialog/ConfirmDialog\";\r\nimport { ListEmptyState } from \"@keycloak/keycloak-ui-shared\";\r\nimport { Action, KeycloakDataTable } from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  AddRoleButton,\r\n  AddRoleMappingModal,\r\n  FilterType,\r\n} from \"./AddRoleMappingModal\";\r\nimport { deleteMapping, getEffectiveRoles, getMapping } from \"./queries\";\r\nimport { getEffectiveClientRoles } from \"./resource\";\r\n\r\nimport \"./role-mapping.css\";\r\n\r\nexport type CompositeRole = RoleRepresentation & {\r\n  parent: RoleRepresentation;\r\n  isInherited?: boolean;\r\n};\r\n\r\nexport type Row = {\r\n  client?: ClientRepresentation;\r\n  role: RoleRepresentation | CompositeRole;\r\n  id?: string; // KeycloakDataTable expects an id for the row\r\n};\r\n\r\nexport const mapRoles = (\r\n  assignedRoles: Row[],\r\n  effectiveRoles: Row[],\r\n  hide: boolean,\r\n) => [\r\n  ...(hide\r\n    ? assignedRoles.map((row) => ({\r\n        id: row.role.id,\r\n        ...row,\r\n        role: {\r\n          ...row.role,\r\n          isInherited: false,\r\n        },\r\n      }))\r\n    : effectiveRoles.map((row) => ({\r\n        id: row.role.id,\r\n        ...row,\r\n        role: {\r\n          ...row.role,\r\n          isInherited:\r\n            assignedRoles.find((r) => r.role.id === row.role.id) === undefined,\r\n        },\r\n      }))),\r\n];\r\n\r\nexport const ServiceRole = ({ role, client }: Row) => (\r\n  <>\r\n    {client?.clientId && (\r\n      <Badge isRead className=\"keycloak-admin--role-mapping__client-name\">\r\n        {client.clientId}\r\n      </Badge>\r\n    )}\r\n    {role.name}\r\n  </>\r\n);\r\n\r\nexport type ResourcesKey = keyof KeycloakAdminClient;\r\n\r\ntype RoleMappingProps = {\r\n  name: string;\r\n  id: string;\r\n  type: ResourcesKey;\r\n  isManager?: boolean;\r\n  save: (rows: Row[]) => Promise<void>;\r\n};\r\n\r\nexport const RoleMapping = ({\r\n  name,\r\n  id,\r\n  type,\r\n  isManager = true,\r\n  save,\r\n}: RoleMappingProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const { addAlert, addError } = useAlerts();\r\n\r\n  const [key, setKey] = useState(0);\r\n  const refresh = () => setKey(key + 1);\r\n\r\n  const [hide, setHide] = useState(true);\r\n  const [showAssign, setShowAssign] = useState(false);\r\n  const [filterType, setFilterType] = useState<FilterType>(\"clients\");\r\n  const [selected, setSelected] = useState<Row[]>([]);\r\n\r\n  const assignRoles = async (rows: Row[]) => {\r\n    await save(rows);\r\n    refresh();\r\n  };\r\n\r\n  const loader = async () => {\r\n    let effectiveRoles: Row[] = [];\r\n    let effectiveClientRoles: Row[] = [];\r\n\r\n    if (!hide) {\r\n      effectiveRoles = await getEffectiveRoles(adminClient, type, id);\r\n\r\n      effectiveClientRoles = (\r\n        await getEffectiveClientRoles(adminClient, {\r\n          type,\r\n          id,\r\n        })\r\n      ).map((e) => ({\r\n        client: { clientId: e.client, id: e.clientId },\r\n        role: { id: e.id, name: e.role, description: e.description },\r\n      }));\r\n\r\n      effectiveRoles = effectiveRoles.filter(\r\n        (role) =>\r\n          !effectiveClientRoles.some(\r\n            (clientRole) => clientRole.role.id === role.role.id,\r\n          ),\r\n      );\r\n    }\r\n\r\n    const roles = await getMapping(adminClient, type, id);\r\n    const realmRolesMapping =\r\n      roles.realmMappings?.map((role) => ({ role })) || [];\r\n    const clientMapping = Object.values(roles.clientMappings || {})\r\n      .map((client) =>\r\n        client.mappings.map((role: RoleRepresentation) => ({\r\n          client: { clientId: client.client, ...client },\r\n          role,\r\n        })),\r\n      )\r\n      .flat();\r\n\r\n    return [\r\n      ...mapRoles(\r\n        [...clientMapping, ...realmRolesMapping],\r\n        [...effectiveClientRoles, ...effectiveRoles],\r\n        hide,\r\n      ),\r\n    ];\r\n  };\r\n\r\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\r\n    titleKey: \"removeMappingTitle\",\r\n    messageKey: t(\"removeMappingConfirm\", { count: selected.length }),\r\n    continueButtonLabel: \"remove\",\r\n    continueButtonVariant: ButtonVariant.danger,\r\n    onCancel: () => {\r\n      setSelected([]);\r\n      refresh();\r\n    },\r\n    onConfirm: async () => {\r\n      try {\r\n        await Promise.all(deleteMapping(adminClient, type, id, selected));\r\n        addAlert(t(\"roleMappingUpdatedSuccess\"), AlertVariant.success);\r\n        setSelected([]);\r\n        refresh();\r\n      } catch (error) {\r\n        addError(\"roleMappingUpdatedError\", error);\r\n      }\r\n    },\r\n  });\r\n\r\n  return (\r\n    <>\r\n      {showAssign && (\r\n        <AddRoleMappingModal\r\n          id={id}\r\n          type={type}\r\n          filterType={filterType}\r\n          name={name}\r\n          onAssign={assignRoles}\r\n          onClose={() => setShowAssign(false)}\r\n        />\r\n      )}\r\n      <DeleteConfirm />\r\n      <KeycloakDataTable\r\n        data-testid=\"assigned-roles\"\r\n        key={`${id}${key}`}\r\n        loader={loader}\r\n        canSelectAll\r\n        onSelect={(rows) => setSelected(rows)}\r\n        searchPlaceholderKey=\"searchByName\"\r\n        ariaLabelKey=\"roleList\"\r\n        isRowDisabled={(value) =>\r\n          (value.role as CompositeRole).isInherited || false\r\n        }\r\n        toolbarItem={\r\n          <>\r\n            <ToolbarItem>\r\n              <Checkbox\r\n                label={t(\"hideInheritedRoles\")}\r\n                id=\"hideInheritedRoles\"\r\n                data-testid=\"hideInheritedRoles\"\r\n                isChecked={hide}\r\n                onChange={(_event, check) => {\r\n                  setHide(check);\r\n                  refresh();\r\n                }}\r\n              />\r\n            </ToolbarItem>\r\n            {isManager && (\r\n              <>\r\n                <ToolbarItem>\r\n                  <AddRoleButton\r\n                    onFilerTypeChange={(type) => {\r\n                      setFilterType(type);\r\n                      setShowAssign(true);\r\n                    }}\r\n                  />\r\n                </ToolbarItem>\r\n                <ToolbarItem>\r\n                  <Button\r\n                    variant=\"link\"\r\n                    data-testid=\"unAssignRole\"\r\n                    onClick={toggleDeleteDialog}\r\n                    isDisabled={selected.length === 0}\r\n                  >\r\n                    {t(\"unAssignRole\")}\r\n                  </Button>\r\n                </ToolbarItem>\r\n              </>\r\n            )}\r\n          </>\r\n        }\r\n        actions={\r\n          isManager\r\n            ? [\r\n                {\r\n                  title: t(\"unAssignRole\"),\r\n                  onRowClick: async (role) => {\r\n                    setSelected([role]);\r\n                    toggleDeleteDialog();\r\n                    return false;\r\n                  },\r\n                } as Action<Awaited<ReturnType<typeof loader>>[0]>,\r\n              ]\r\n            : []\r\n        }\r\n        columns={[\r\n          {\r\n            name: \"role.name\",\r\n            displayKey: \"name\",\r\n            transforms: [cellWidth(30)],\r\n            cellRenderer: ServiceRole,\r\n          },\r\n          {\r\n            name: \"role.isInherited\",\r\n            displayKey: \"inherent\",\r\n            cellFormatters: [upperCaseFormatter(), emptyFormatter()],\r\n          },\r\n          {\r\n            name: \"role.description\",\r\n            displayKey: \"description\",\r\n            cellFormatters: [translationFormatter(t)],\r\n          },\r\n        ]}\r\n        emptyState={\r\n          <ListEmptyState\r\n            message={t(`noRoles-${type}`)}\r\n            instructions={t(`noRolesInstructions-${type}`)}\r\n            secondaryActions={[\r\n              {\r\n                text: t(\"showInheritedRoles\"),\r\n                onClick: () => {\r\n                  setHide(false);\r\n                  refresh();\r\n                },\r\n              },\r\n            ]}\r\n          >\r\n            <AddRoleButton\r\n              onFilerTypeChange={(type) => {\r\n                setFilterType(type);\r\n                setShowAssign(true);\r\n              }}\r\n            />\r\n          </ListEmptyState>\r\n        }\r\n      />\r\n    </>\r\n  );\r\n};\r\n"],"names":["groupFunctions","clientFunctions","mapping","castAdminClient","adminClient","resource","applyQuery","type","query","params","deleteMapping","id","rows","row","role","getMapping","result","roles","r","client","getEffectiveRoles","parentRoles","getAvailableRoles","fetchEndpoint","first","max","search","endpoint","fetchAdminUI","getAvailableClientRoles","getEffectiveClientRoles","findUsers","fetchUsedBy","RoleDescription","t","useTranslation","jsx","TableText","AddRoleButton","label","variant","isDisabled","onFilerTypeChange","rest","open","toggle","useToggle","hasAccess","useAccess","canViewRealmRoles","Dropdown","ref","MenuToggle","DropdownList","DropdownItem","AddRoleMappingModal","name","isRadio","filterType","onAssign","onClose","title","actionLabel","useAdminClient","selectedRows","setSelectedRows","useState","localeSort","useLocaleSort","compareRow","loader","clientRolesLoader","e","clientId","columns","cellWidth","Modal","ModalVariant","Button","KeycloakDataTable","ListEmptyState","mapRoles","assignedRoles","effectiveRoles","hide","ServiceRole","jsxs","Fragment","Badge","RoleMapping","isManager","save","addAlert","addError","useAlerts","key","setKey","refresh","setHide","showAssign","setShowAssign","setFilterType","selected","setSelected","assignRoles","effectiveClientRoles","clientRole","realmRolesMapping","clientMapping","toggleDeleteDialog","DeleteConfirm","useConfirmDialog","ButtonVariant","AlertVariant","error","value","ToolbarItem","Checkbox","_event","check","upperCaseFormatter","emptyFormatter","translationFormatter"],"mappings":"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"}