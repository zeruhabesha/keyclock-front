{"version":3,"file":"IdentityProviderSelect-rmWlUbIg.js","sources":["../../../../../../../../../libs/keycloak-admin-client/lib/defs/identityProviderRepresentation.js","../../../../../../../src/components/dynamic/MultivaluedListComponent.tsx","../../../../../../../src/components/identity-provider/IdentityProviderSelect.tsx"],"sourcesContent":["/**\n * https://www.keycloak.org/docs-api/11.0/rest-api/index.html#_identityproviderrepresentation\n */\nexport var IdentityProviderType;\n(function (IdentityProviderType) {\n    IdentityProviderType[\"ANY\"] = \"ANY\";\n    IdentityProviderType[\"USER_AUTHENTICATION\"] = \"USER_AUTHENTICATION\";\n    IdentityProviderType[\"CLIENT_ASSERTION\"] = \"CLIENT_ASSERTION\";\n    IdentityProviderType[\"EXCHANGE_EXTERNAL_TOKEN\"] = \"EXCHANGE_EXTERNAL_TOKEN\";\n    IdentityProviderType[\"JWT_AUTHORIZATION_GRANT\"] = \"JWT_AUTHORIZATION_GRANT\";\n})(IdentityProviderType || (IdentityProviderType = {}));\n","import {\r\n  FormErrorText,\r\n  HelpItem,\r\n  KeycloakSelect,\r\n  SelectVariant,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport { FormGroup, SelectOption } from \"@patternfly/react-core\";\r\nimport { useState } from \"react\";\r\nimport { Controller, useFormContext } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport type { ComponentProps } from \"./components\";\r\n\r\nfunction stringToMultiline(value?: string): string[] {\r\n  return typeof value === \"string\" && value.length > 0 ? value.split(\"##\") : [];\r\n}\r\n\r\nfunction toStringValue(formValue: string[]): string {\r\n  return formValue.join(\"##\");\r\n}\r\n\r\ntype MultiValuedListComponentProps = ComponentProps & {\r\n  variant?: `${SelectVariant}`;\r\n};\r\n\r\nexport const MultiValuedListComponent = ({\r\n  name,\r\n  label,\r\n  helpText,\r\n  defaultValue,\r\n  options,\r\n  isDisabled = false,\r\n  stringify,\r\n  required,\r\n  convertToName,\r\n  onSearch,\r\n  variant = SelectVariant.typeaheadMulti,\r\n}: MultiValuedListComponentProps) => {\r\n  const { t } = useTranslation();\r\n  const {\r\n    control,\r\n    formState: { errors },\r\n  } = useFormContext();\r\n  const [open, setOpen] = useState(false);\r\n\r\n  function setSearch(value: string) {\r\n    if (onSearch) {\r\n      onSearch(value);\r\n    }\r\n  }\r\n\r\n  const convertedName = convertToName(name!);\r\n\r\n  const getError = () => {\r\n    return convertedName\r\n      .split(\".\")\r\n      .reduce((record: any, key) => record?.[key], errors);\r\n  };\r\n\r\n  return (\r\n    <FormGroup\r\n      label={t(label!)}\r\n      labelIcon={<HelpItem helpText={t(helpText!)} fieldLabelId={`${label}`} />}\r\n      fieldId={name!}\r\n      isRequired={required}\r\n    >\r\n      <Controller\r\n        name={convertedName}\r\n        control={control}\r\n        defaultValue={\r\n          stringify || variant !== SelectVariant.typeaheadMulti\r\n            ? defaultValue || \"\"\r\n            : defaultValue\r\n              ? [defaultValue]\r\n              : []\r\n        }\r\n        rules={{\r\n          required: { value: required || false, message: t(\"required\") },\r\n        }}\r\n        render={({ field }) => (\r\n          <>\r\n            <KeycloakSelect\r\n              toggleId={name}\r\n              data-testid={name}\r\n              isDisabled={isDisabled}\r\n              chipGroupProps={{\r\n                numChips: 3,\r\n                expandedText: t(\"hide\"),\r\n                collapsedText: t(\"showRemaining\"),\r\n              }}\r\n              variant={variant}\r\n              typeAheadAriaLabel={t(\"choose\")}\r\n              onToggle={setOpen}\r\n              selections={\r\n                stringify && variant === SelectVariant.typeaheadMulti\r\n                  ? stringToMultiline(field.value)\r\n                  : field.value\r\n              }\r\n              onSelect={(v) => {\r\n                const option = v.toString();\r\n                if (variant === SelectVariant.typeaheadMulti) {\r\n                  const values = stringify\r\n                    ? stringToMultiline(field.value)\r\n                    : field.value;\r\n                  let newValue;\r\n                  if (values.includes(option)) {\r\n                    newValue = values.filter((item: string) => item !== option);\r\n                  } else if (option !== \"\") {\r\n                    newValue = [...values, option];\r\n                  } else {\r\n                    newValue = values;\r\n                  }\r\n                  field.onChange(\r\n                    stringify && variant === SelectVariant.typeaheadMulti\r\n                      ? toStringValue(newValue)\r\n                      : newValue,\r\n                  );\r\n                } else {\r\n                  field.onChange(option);\r\n                }\r\n              }}\r\n              onClear={() => {\r\n                field.onChange(\r\n                  stringify || variant !== SelectVariant.typeaheadMulti\r\n                    ? \"\"\r\n                    : [],\r\n                );\r\n              }}\r\n              onFilter={setSearch}\r\n              isOpen={open}\r\n            >\r\n              {options?.map((option) => (\r\n                <SelectOption key={option} value={option}>\r\n                  {option}\r\n                </SelectOption>\r\n              ))}\r\n            </KeycloakSelect>\r\n            {getError() && <FormErrorText message={getError().message} />}\r\n          </>\r\n        )}\r\n      />\r\n    </FormGroup>\r\n  );\r\n};\r\n","import type IdentityProviderRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/identityProviderRepresentation\";\r\nimport { IdentityProviderType } from \"@keycloak/keycloak-admin-client/lib/defs/identityProviderRepresentation\";\r\nimport type { IdentityProvidersQuery } from \"@keycloak/keycloak-admin-client/lib/resources/identityProviders\";\r\nimport { SelectVariant, useFetch } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useState } from \"react\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport type { ComponentProps } from \"../dynamic/components\";\r\nimport { MultiValuedListComponent } from \"../dynamic/MultivaluedListComponent\";\r\n\r\ntype IdentityProviderSelectProps = ComponentProps & {\r\n  variant?: `${SelectVariant}`;\r\n  identityProviderType?: IdentityProviderType;\r\n  realmOnly?: boolean;\r\n};\r\n\r\nexport const IdentityProviderSelect = ({\r\n  identityProviderType = IdentityProviderType.ANY,\r\n  realmOnly = false,\r\n  ...props\r\n}: IdentityProviderSelectProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const [identityProviders, setIdentityProviders] = useState<\r\n    IdentityProviderRepresentation[]\r\n  >([]);\r\n  const [search, setSearch] = useState(\"\");\r\n\r\n  useFetch(\r\n    () => {\r\n      const params: IdentityProvidersQuery = {\r\n        max: 20,\r\n        type: identityProviderType,\r\n        realmOnly: realmOnly,\r\n      };\r\n      if (search) {\r\n        params.search = search;\r\n      }\r\n      return adminClient.identityProviders.find(params);\r\n    },\r\n    (identityProviders) => setIdentityProviders(identityProviders),\r\n    [search],\r\n  );\r\n\r\n  return (\r\n    <MultiValuedListComponent\r\n      {...props}\r\n      onSearch={setSearch}\r\n      options={identityProviders.map(({ alias }) => alias!)}\r\n    />\r\n  );\r\n};\r\n"],"names":["IdentityProviderType","stringToMultiline","value","toStringValue","formValue","MultiValuedListComponent","name","label","helpText","defaultValue","options","isDisabled","stringify","required","convertToName","onSearch","variant","SelectVariant","t","useTranslation","control","errors","useFormContext","open","setOpen","useState","setSearch","convertedName","getError","record","key","jsx","FormGroup","HelpItem","Controller","field","jsxs","Fragment","KeycloakSelect","v","option","values","newValue","item","SelectOption","FormErrorText","IdentityProviderSelect","identityProviderType","realmOnly","props","adminClient","useAdminClient","identityProviders","setIdentityProviders","search","useFetch","params","alias"],"mappings":"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"}