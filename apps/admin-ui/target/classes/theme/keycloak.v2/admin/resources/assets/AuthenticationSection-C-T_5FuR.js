import{jsx as e,jsxs as h,Fragment as E}from"react/jsx-runtime";import{u as D,a as S,_ as H,j as U,y as we,M as ve,k as Ie,F as Me,l as K,A as B,g as I,B as O,m as le,n as oe,o as N,z as Ve,G as $e,d as _,p as se,S as Z,q as de,r as Ce,s as Se,w as Te,C as ee,E as Ee,x as Re,H as _e,I as te,J as Le,K as Ue,P as V,U as W,Q as z,N as Ke,O as q,R as ae,V as ue,W as M,X as me,Y as Be,Z as Ge,$ as ie,a0 as je,a1 as We,a2 as pe,a3 as ze,a4 as he,a5 as Ye,a6 as Xe,a7 as Qe,e as ke,a8 as Je,a9 as Ze,T as xe,aa as et,ab as tt,ac as at,ad as it,ae as nt,af as lt,ag as ot,ah as st,ai as rt,aj as ct,ak as dt,al as ut,am as mt,an as pt,ao as ht,ap as bt,aq as be,v as yt,L as Ne,ar as ft,as as At,at as gt}from"./main-o1hptXRo.js";import{useState as R,useEffect as re,useMemo as De}from"react";import{u as Pt}from"./ConfirmDialog-BkU7melV.js";import{u as wt,R as vt}from"./RoutableTabs-DyhWhd6v.js";import{V as It}from"./ViewHeader-BDBsroi3.js";import{u as Oe,m as Ct}from"./useLocaleSort-C-diWts5.js";import{C as St,R as Tt,D as Et,B as Rt}from"./DuplicateFlowModal-CAh-jnv6.js";import{D as _t}from"./DraggableTable-CH2dxmAN.js";import{D as kt}from"./DynamicComponents-CnLlz98z.js";import{T as xt}from"./trash-icon-BwwarfOm.js";import{f as Nt}from"./RoleMapping-BOcI-Nkp.js";import{F as Y}from"./FormAccess-BnhQnYb9.js";import{T as He}from"./TimeSelectorControl-B1N9IKgG.js";import{M as ye}from"./MultiLineInput-OP0faqms.js";import{Q as Dt}from"./question-circle-icon-C0dl_LB7.js";import{T as Ot,a as k,b as x}from"./Tabs-DSwQhKoJ.js";import{T as Ht}from"./Trans-CicUNvCL.js";import{s as Ft}from"./sortBy-DjlFeX8O.js";import"react-dom";import"./PageHandler-B1ed5nYb.js";import"./useParams-CGVhlaFZ.js";import"./constants-BclHbWtx.js";import"./NameDescription-DCr5DQCk.js";import"./DataListItemRow-B_0B-ko6.js";import"./ClientSelect-BY77LEpN.js";import"./IdentityProviderSelect-rmWlUbIg.js";import"./GroupPickerDialog-U3luvxlw.js";import"./ActionListItem-Cy-NQlq4.js";import"./CodeEditor-C4IS5oxi.js";import"./translationFormatter-DQJeO7lr.js";import"./TimeSelector-1gdltitc.js";import"./_baseFlatten-BLlCkxtA.js";const qt=({requiredAction:i,onClose:n})=>{const{adminClient:l}=D(),{t}=S(),{addAlert:a,addError:r}=H(),[p,u]=R(),b=U(),{setValue:A,handleSubmit:m}=b,g=d=>{le(d||{},A)};we(async()=>{const d=await l.authenticationManagement.getRequiredActionConfigDescription({alias:i.alias}),y=await l.authenticationManagement.getRequiredActionConfig({alias:i.alias});return d.properties=[...d.properties],{configDescription:d,config:y}},({configDescription:d,config:y})=>{u(d),g(y)},[]);const C=async d=>{const y=oe(d);try{await l.authenticationManagement.updateRequiredActionConfig({alias:i.alias},y),g(y),a(t("configSaveSuccess"),N.success),n()}catch(v){Ve(v)?$e(v,(o,f)=>{r("configSaveError",f.message)},t):r("configSaveError",v)}};return e(ve,{variant:Ie.small,isOpen:!0,title:t("requiredActionConfig",{name:i.name}),onClose:n,children:h(Me,{id:"required-action-config-form",onSubmit:m(C),children:[e(K,{...b,children:e(kt,{stringify:!0,properties:p?.properties||[]})}),h(B,{children:[e(I,{"data-testid":"save",variant:"primary",type:"submit",children:t("save")}),e(I,{"data-testid":"cancel",variant:O.link,onClick:n,children:t("cancel")}),h(I,{className:"pf-v5-u-ml-3xl","data-testid":"clear",variant:O.link,onClick:async()=>{await l.authenticationManagement.removeRequiredActionConfig({alias:i.alias}),b.reset({}),n()},children:[t("clear")," ",e(xt,{})]})]})]})})},Mt=()=>{const{adminClient:i}=D(),{t:n}=S(),{addAlert:l,addError:t}=H(),[a,r]=R(),[p,u]=R(),[b,A]=R(0),m=()=>A(b+1),{realm:g}=_(),C=async()=>await(await Ce(`${Te(i.baseUrl)}admin/realms/${g}/ui-ext/authentication-management/required-actions`,{method:"GET",headers:Se(await i.getAccessToken())})).json();we(async()=>{const[o,f]=await Promise.all([C(),i.authenticationManagement.getUnregisteredRequiredActions()]);return[...o.map(s=>({name:s.name,enabled:s.enabled,defaultAction:s.defaultAction,data:s})),...f.map(s=>({name:s.name,enabled:!1,defaultAction:!1,data:s}))]},o=>r(o),[b]);const d=o=>!("alias"in o),y=async(o,f)=>{try{f in o?(o[f]=!o[f],delete o.configurable,await i.authenticationManagement.updateRequiredAction({alias:o.alias},o)):d(o)&&await i.authenticationManagement.registerRequiredAction({name:o.name,providerId:o.providerId}),m(),l(n("updatedRequiredActionSuccess"),N.success)}catch(s){t("updatedRequiredActionError",s)}},v=async(o,f)=>{try{const s=o.alias;for(let c=0;c<Math.abs(f);c++)f>0?await i.authenticationManagement.lowerRequiredActionPriority({alias:s}):await i.authenticationManagement.raiseRequiredActionPriority({alias:s});m(),l(n("updatedRequiredActionSuccess"),N.success)}catch(s){t("updatedRequiredActionError",s)}};return a?h(E,{children:[p&&e(qt,{requiredAction:p,onClose:()=>u(void 0)}),e(_t,{keyField:"name",onDragFinish:async(o,f)=>{const s=a.map(w=>w.name),c=f.indexOf(o),P=s.indexOf(o),T=a[P].data;if(!T.alias)return;const $=c-P;await v(T,$)},columns:[{name:"name",displayKey:"action",width:50},{name:"enabled",displayKey:"enabled",cellRenderer:o=>e(Z,{id:`enable-${de(o.name||"")}`,label:n("on"),labelOff:n("off"),isChecked:o.enabled,onChange:async()=>{await y(o.data,"enabled")},"aria-label":o.name}),width:20},{name:"default",displayKey:"setAsDefaultAction",thTooltipText:"authDefaultActionTooltip",cellRenderer:o=>e(Z,{id:`default-${de(o.name||"")}`,label:n("on"),isDisabled:!o.enabled,labelOff:o.enabled?n("off"):n("disabledOff"),isChecked:o.defaultAction,onChange:async()=>{await y(o.data,"defaultAction")},"aria-label":o.name}),width:20},{name:"config",displayKey:"configure",cellRenderer:o=>o.data.configurable?e(I,{variant:"plain","aria-label":n("settings"),onClick:()=>u(o.data),children:e(St,{})}):void 0,width:10}],data:a})]}):e(se,{})},Vt="_label_1ndkh_1",ne={label:Vt},X=({label:i})=>h(E,{children:[e(Ue,{className:ne.label})," ",i]}),$t=({id:i,isSpecificClient:n,onClose:l})=>{const{adminClient:t}=D(),{t:a}=S(),r=async(p,u,b)=>(await Nt(t,{id:i,type:n?"clients":"idp",first:p||0,max:u||10,search:b})).map(m=>({name:m}));return e(ve,{header:h(_e,{children:[e(te,{component:Le.h1,children:a("flowUsedBy")}),e(te,{children:a("flowUsedByDescription",{value:a(n?"clients":"identiyProviders")})})]}),variant:Ie.medium,isOpen:!0,onClose:l,actions:[e(I,{"data-testid":"cancel",id:"modal-cancel",onClick:l,children:a("close")},"cancel")],children:e(Re,{loader:r,isPaginated:!0,ariaLabelKey:"usedBy",searchPlaceholderKey:"search",columns:[{name:"name"}]})})},Lt=({authType:{id:i,usedBy:n}})=>{const{t:l}=S(),{realmRepresentation:t}=_(),[a,r]=ee(),p=Object.entries(t).find(u=>u[1]===n?.values[0])?.[0];return h(E,{children:[a&&e($t,{id:i,onClose:r,isSpecificClient:n?.type==="SPECIFIC_CLIENTS"}),(n?.type==="SPECIFIC_PROVIDERS"||n?.type==="SPECIFIC_CLIENTS")&&(n.values.length<=8?e(Ee,{"aria-label":l("usedBy"),bodyContent:h("div",{children:[l("appliedBy"+(n.type==="SPECIFIC_CLIENTS"?"Clients":"Providers"))," ",n.values.map((u,b)=>h(E,{children:[e("strong",{children:u}),b<n.values.length-1?", ":""]}))]},`usedBy-${i}-${n.values}`),children:e(I,{variant:"link",className:ne.label,children:e(X,{label:l(`used.${n.type}`)})})},i):e(I,{variant:"link",className:ne.label,onClick:r,children:e(X,{label:l(`used.${n.type}`)})})),n?.type==="DEFAULT"&&e(X,{label:l(`flow.${Tt.get(p)}`)}),!n?.type&&l("used.notInUse")]})},Ut=["poll","ping"],G=10,j=600,fe=0,Ae=600,Kt=({realm:i,realmUpdated:n})=>{const{adminClient:l}=D(),{t}=S(),a=U({mode:"onChange"}),{realm:r}=_(),{addAlert:p,addError:u}=H(),b=m=>le(m,a.setValue);re(()=>b(i),[]);const A=async m=>{try{await l.realms.update({realm:r},oe(m));const g=await l.realms.findOne({realm:r});n(g),b(g),p(t("updateCibaSuccess"),N.success)}catch(g){u("updateCibaError",g)}};return e(V,{variant:"light",children:h(Y,{role:"manage-realm",isHorizontal:!0,onSubmit:a.handleSubmit(A),children:[h(K,{...a,children:[e(W,{name:"attributes.cibaBackchannelTokenDeliveryMode",label:t("cibaBackchannelTokenDeliveryMode"),labelIcon:t("cibaBackchannelTokenDeliveryModeHelp"),options:Ut.map(m=>({key:m,value:t(`cibaBackhannelTokenDeliveryModes.${m}`)})),controller:{defaultValue:""}}),e(z,{name:"attributes.cibaExpiresIn",type:"number",min:G,max:j,label:t("cibaExpiresIn"),labelIcon:t("cibaExpiresInHelp"),rules:{min:{value:G,message:t("greaterThan",{value:G})},max:{value:j,message:t("lessThan",{value:j})},required:t("required")}}),e(z,{name:"attributes.cibaInterval",type:"number",min:G,max:j,label:t("cibaInterval"),labelIcon:t("cibaIntervalHelp"),rules:{min:{value:fe,message:t("greaterThan",{value:fe})},max:{value:Ae,message:t("lessThan",{value:Ae})},required:t("required")}}),e(W,{name:"attributes.cibaAuthRequestedUserHint",label:t("cibaAuthRequestedUserHint"),labelIcon:t("cibaAuthRequestedUserHintHelp"),options:["login_hint","id_token_hint","login_hint_token"],controller:{defaultValue:""},isDisabled:!0})]}),h(B,{children:[e(I,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!a.formState.isValid||!a.formState.isDirty,children:t("save")}),e(I,{"data-testid":"reload",variant:O.link,onClick:()=>b({...i}),children:t("reload")})]})]})})},F=["totp","hotp"],Q=["SHA1","SHA256","SHA512"],J=[6,8],Bt=({realm:i,realmUpdated:n})=>{const{adminClient:l}=D(),{t}=S(),a=U({mode:"onChange",defaultValues:{otpPolicyType:i.otpPolicyType??F[0],otpPolicyAlgorithm:i.otpPolicyAlgorithm??`Hmac${Q[0]}`,otpPolicyDigits:i.otpPolicyDigits??J[0],otpPolicyLookAheadWindow:i.otpPolicyLookAheadWindow??1,otpPolicyPeriod:i.otpPolicyPeriod??30,otpPolicyInitialCounter:i.otpPolicyInitialCounter??30,otpPolicyCodeReusable:i.otpPolicyCodeReusable??!1}}),{control:r,reset:p,handleSubmit:u,formState:{isValid:b,isDirty:A}}=a,{realm:m}=_(),{addAlert:g,addError:C}=H(),d=Oe(),y=Ke({name:"otpPolicyType",control:r}),v=s=>p(s),o=De(()=>{const s=(i.otpSupportedApplications??[]).map(c=>t(`otpSupportedApplications.${c}`));return d(s,c=>c)},[i.otpSupportedApplications]);return e(V,{variant:"light",children:e(Y,{role:"manage-realm",isHorizontal:!0,onSubmit:u(async s=>{try{await l.realms.update({realm:m},s);const c=await l.realms.findOne({realm:m});n(c),v(c),g(t("updateOtpSuccess"),N.success)}catch(c){C("updateOtpError",c)}}),className:"keycloak__otp_policies_authentication__form",children:h(K,{...a,children:[e(q,{label:t("otpType"),labelIcon:e(M,{helpText:t("otpTypeHelp"),fieldLabelId:"otpType"}),hasNoPaddingTop:!0,children:e(ae,{name:"otpPolicyType","data-testid":"otpPolicyType",defaultValue:F[0],control:r,render:({field:{value:s,onChange:c}})=>e(E,{children:F.map(P=>e(ue,{id:P,"data-testid":P,isChecked:s===P,name:"otpPolicyType",onChange:()=>c(P),label:t(`policyType.${P}`),className:"keycloak__otp_policies_authentication__policy-type"},P))})})}),e(W,{name:"otpPolicyAlgorithm",label:t("otpHashAlgorithm"),labelIcon:t("otpHashAlgorithmHelp"),options:Q.map(s=>({key:`Hmac${s}`,value:s})),controller:{defaultValue:`Hmac${Q[0]}`}}),e(q,{label:t("otpPolicyDigits"),labelIcon:e(M,{helpText:t("otpPolicyDigitsHelp"),fieldLabelId:"otpPolicyDigits"}),hasNoPaddingTop:!0,children:e(ae,{name:"otpPolicyDigits","data-testid":"otpPolicyDigits",defaultValue:J[0],control:r,render:({field:s})=>e(E,{children:J.map(c=>e(ue,{id:`digit-${c}`,"data-testid":`digit-${c}`,isChecked:s.value===c,name:"otpPolicyDigits",onChange:()=>s.onChange(c),label:c,className:"keycloak__otp_policies_authentication__number-of-digits"},c))})})}),e(me,{name:"otpPolicyLookAheadWindow",label:t("lookAround"),labelIcon:t("lookAroundHelp"),controller:{defaultValue:1,rules:{min:0}}}),y===F[0]&&e(He,{name:"otpPolicyPeriod",label:t("otpPolicyPeriod"),labelIcon:t("otpPolicyPeriodHelp"),units:["second","minute"],controller:{defaultValue:30,rules:{min:1,max:{value:120,message:t("maxLength",{length:"2 "+t("minutes")})}}}}),y===F[1]&&e(me,{name:"otpPolicyInitialCounter",label:t("initialCounter"),labelIcon:t("initialCounterHelp"),controller:{defaultValue:30,rules:{min:1,max:120}}}),e(q,{label:t("supportedApplications"),labelIcon:e(M,{helpText:t("supportedApplicationsHelp"),fieldLabelId:"supportedApplications"}),children:e("span",{"data-testid":"supportedApplications",children:e(Be,{children:o.map(s=>e(Ge,{isReadOnly:!0,children:s},s))})})}),y===F[0]&&e(ie,{name:"otpPolicyCodeReusable",label:t("otpPolicyCodeReusable"),labelIcon:t("otpPolicyCodeReusableHelp"),labelOn:t("on"),labelOff:t("off")}),h(B,{children:[e(I,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!b||!A,children:t("save")}),e(I,{"data-testid":"reload",variant:O.link,onClick:()=>p({...i}),children:t("reload")})]})]})})})},Gt=({policy:{id:i,configType:n,defaultValue:l,displayName:t},onRemove:a})=>{const{t:r}=S(),{control:p,register:u,formState:{errors:b}}=je(),A=b[i];return h(q,{label:t,fieldId:i,isRequired:!0,labelIcon:e(M,{helpText:r(`passwordPoliciesHelp.${i}`),fieldLabelId:i}),children:[h(We,{children:[h(pe,{isFilled:!0,children:[n&&n!=="int"&&e(ze,{id:i,"data-testid":i,...u(i,{required:!0}),defaultValue:l,validated:A?he.error:he.default}),n==="int"&&e(ae,{name:i,defaultValue:Number.parseInt(l||"0"),control:p,render:({field:m})=>{const C=y=>m.onChange(Math.max(y,0)),d=Number(m.value);return e(Ye,{id:i,value:d,min:0,onPlus:()=>C(d+1),onMinus:()=>C(d-1),onChange:y=>{const v=Number(y.currentTarget.value);C(isNaN(v)?0:v)},className:"keycloak__policies_authentication__number-field"})}}),!n&&e(Z,{id:i,label:r("on"),labelOff:r("off"),isChecked:!0,isDisabled:!0,"aria-label":t})]}),e(pe,{children:e(I,{"data-testid":`remove-${i}`,variant:"link",className:"keycloak__policies_authentication__minus-icon",onClick:()=>a(i),"aria-label":r("remove"),children:e(Xe,{})})})]}),A&&e(Qe,{message:r("required")})]})},Fe=" and ",jt=(i,n)=>i.map(l=>`${l.id}(${n[l.id]})`).join(Fe),Wt=(i,n)=>i.split(Fe).map(zt).reduce((l,{id:t,value:a})=>{const r=n.find(p=>p.id===t);return r?l.concat({...r,value:a}):l},[]);function zt(i){const n=i.indexOf("(");if(n===-1)return{id:i.trim()};const l=i.substring(0,n).trim(),t=i.lastIndexOf(")");if(t===-1)return{id:l};const a=i.substring(n+1,t).trim();return{id:l,value:a}}const ge=({onSelect:i,selectedPolicies:n})=>{const{t:l}=S(),{passwordPolicies:t}=ke(),[a,r]=R(!1),p=De(()=>t?.filter(u=>n.find(b=>b.id===u.id)===void 0),[n]);return e(rt,{onSelect:(u,b)=>{i(b),r(!1)},toggle:u=>e(ut,{ref:u,onClick:()=>r(!a),isExpanded:a,isDisabled:p?.length===0,style:{width:"300px"},"data-testid":"add-policy",children:l("addPolicy")}),isOpen:a,children:e(ct,{children:p?.map(u=>e(dt,{value:u,children:u.displayName},u.id))})})},Yt=({realm:i,realmUpdated:n})=>{const{adminClient:l}=D(),{t}=S(),{passwordPolicies:a}=ke(),{addAlert:r,addError:p}=H(),{realm:u,refresh:b}=_(),[A,m]=R([]),g=c=>{m([...A,c]),y(c.id,c.defaultValue,{shouldDirty:!0})},C=U({defaultValues:{}}),{handleSubmit:d,setValue:y,reset:v,formState:{isDirty:o}}=C,f=c=>{v();const P=Wt(c.passwordPolicy||"",a);P.forEach(T=>{y(T.id,T.value)}),m(P)};re(()=>f(i),[]);const s=async c=>{const P={...i,passwordPolicy:jt(A,c)};try{await l.realms.update({realm:u},P),n(P),f(P),b(),r(t("updatePasswordPolicySuccess"),N.success)}catch(T){p("updatePasswordPolicyError",T)}};return h(V,{variant:"light",className:"pf-v5-u-p-0",children:[(A.length!==0||i.passwordPolicy)&&h(E,{children:[e(Je,{children:e(Ze,{children:e(xe,{children:e(ge,{onSelect:g,selectedPolicies:A})})})}),e(et,{}),e(V,{variant:"light",children:e(K,{...C,children:h(Y,{className:"keycloak__policies_authentication__form",role:"manage-realm",isHorizontal:!0,onSubmit:d(s),children:[A.map((c,P)=>e(Gt,{policy:c,onRemove:T=>{m(A.filter($=>$.id!==T)),y(c.id,"",{shouldDirty:!0})}},`${c.id}-${P}`)),h(B,{children:[e(I,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!o,children:t("save")}),e(I,{"data-testid":"reload",variant:O.link,onClick:()=>f(i),children:t("reload")})]})]})})})]}),!A.length&&!i.passwordPolicy&&h(tt,{"data-testid":"empty-state",variant:"lg",children:[e(at,{titleText:e(E,{children:t("noPasswordPolicies")}),icon:e(it,{icon:nt}),headingLevel:"h1"}),e(lt,{children:t("noPasswordPoliciesInstructions")}),e(ot,{children:e(st,{children:e(ge,{onSelect:g,selectedPolicies:[]})})})]})]})},Xt=["ES256","ES384","ES512","RS256","RS384","RS512","Ed25519","RS1"],Qt=["not specified","none","indirect","direct"],Jt=["not specified","platform","cross-platform"],Zt=["not specified","Yes","No"],ea=["not specified","required","preferred","discouraged"],L=({name:i,label:n,labelIcon:l,options:t,labelPrefix:a,isMultiSelect:r=!1})=>{const{t:p}=S();return e(W,{name:i,label:n,labelIcon:l,variant:r?"typeaheadMulti":"single",controller:{defaultValue:t[0]},options:t.map(u=>({key:u,value:a?p(`${a}.${u}`):u}))})},Pe=({realm:i,realmUpdated:n,isPasswordLess:l=!1})=>{const{adminClient:t}=D(),{t:a}=S(),{addAlert:r,addError:p}=H(),{realm:u}=_(),{enabled:b}=mt(),A=U({mode:"onChange"}),{setValue:m,handleSubmit:g,formState:{isDirty:C}}=A,d=l?"webAuthnPolicyPasswordless":"webAuthnPolicy",y=f=>le(f,m);re(()=>y(i),[]);const v=async f=>{const s=oe(f);try{await t.realms.update({realm:u},s),n(s),y(s),r(a("webAuthnUpdateSuccess"),N.success)}catch(c){p("webAuthnUpdateError",c)}},o=pt();return h(V,{variant:"light",children:[b&&e(Ee,{bodyContent:a(`${d}FormHelp`),children:e(_e,{className:"keycloak__section_intro__help",children:h(te,{children:[e(Dt,{})," ",a("webauthnIntro")]})})}),h(Y,{role:"manage-realm",isHorizontal:!0,onSubmit:g(v),className:"keycloak__webauthn_policies_authentication__form",children:[h(K,{...A,children:[e(z,{name:`${d}RpEntityName`,label:a("webAuthnPolicyRpEntityName"),labelIcon:a("webAuthnPolicyRpEntityNameHelp"),rules:{required:a("required")}}),e(L,{name:`${d}SignatureAlgorithms`,label:a("webAuthnPolicySignatureAlgorithms"),labelIcon:a("webAuthnPolicySignatureAlgorithmsHelp"),options:Xt,isMultiSelect:!0}),e(z,{name:`${d}RpId`,label:a("webAuthnPolicyRpId"),labelIcon:a("webAuthnPolicyRpIdHelp")}),e(L,{name:`${d}AttestationConveyancePreference`,label:a("webAuthnPolicyAttestationConveyancePreference"),labelIcon:a("webAuthnPolicyAttestationConveyancePreferenceHelp"),options:Qt,labelPrefix:"attestationPreference"}),e(L,{name:`${d}AuthenticatorAttachment`,label:a("webAuthnPolicyAuthenticatorAttachment"),labelIcon:a("webAuthnPolicyAuthenticatorAttachmentHelp"),options:Jt,labelPrefix:"authenticatorAttachment"}),e(L,{name:`${d}RequireResidentKey`,label:a("webAuthnPolicyRequireResidentKey"),labelIcon:a("webAuthnPolicyRequireResidentKeyHelp"),options:Zt,labelPrefix:"residentKey"}),e(L,{name:`${d}UserVerificationRequirement`,label:a("webAuthnPolicyUserVerificationRequirement"),labelIcon:a("webAuthnPolicyUserVerificationRequirementHelp"),options:ea,labelPrefix:"userVerify"}),e(He,{name:`${d}CreateTimeout`,label:a("webAuthnPolicyCreateTimeout"),labelIcon:a("webAuthnPolicyCreateTimeoutHelp"),units:["second","minute","hour"],controller:{defaultValue:0,rules:{min:0,max:{value:31536,message:a("webAuthnPolicyCreateTimeoutHint")}}}}),e(ie,{name:`${d}AvoidSameAuthenticatorRegister`,label:a("webAuthnPolicyAvoidSameAuthenticatorRegister"),labelIcon:a("webAuthnPolicyAvoidSameAuthenticatorRegisterHelp"),labelOn:a("on"),labelOff:a("off")}),e(q,{label:a("webAuthnPolicyAcceptableAaguids"),fieldId:"webAuthnPolicyAcceptableAaguids",labelIcon:e(M,{helpText:a("webAuthnPolicyAcceptableAaguidsHelp"),fieldLabelId:"webAuthnPolicyAcceptableAaguids"}),children:e(ye,{name:`${d}AcceptableAaguids`,"aria-label":a("webAuthnPolicyAcceptableAaguids"),addButtonLabel:"addAaguids"})}),e(q,{label:a("webAuthnPolicyExtraOrigins"),fieldId:"webAuthnPolicyExtraOrigins",labelIcon:e(M,{helpText:a("webAuthnPolicyExtraOriginsHelp"),fieldLabelId:"webAuthnPolicyExtraOrigins"}),children:e(ye,{name:`${d}ExtraOrigins`,"aria-label":a("webAuthnPolicyExtraOrigins"),addButtonLabel:"addOrigins"})}),l&&o(ht.Passkeys)&&e(ie,{name:`${d}PasskeysEnabled`,label:a("webAuthnPolicyPasskeysEnabled"),labelIcon:a("webAuthnPolicyPasskeysEnabledHelp"),labelOn:a("on"),labelOff:a("off")})]}),h(B,{children:[e(I,{"data-testid":"save",variant:"primary",type:"submit",isDisabled:!C,children:a("save")}),e(I,{"data-testid":"reload",variant:O.link,onClick:()=>y(i),children:a("reload")})]})]})]})},ta=()=>{const{t:i}=S(),[n,l]=R(1),{realmRepresentation:t,refresh:a}=_();return t?h(Ot,{activeKey:n,onSelect:(r,p)=>l(p),mountOnEnter:!0,unmountOnExit:!0,children:[e(k,{id:"passwordPolicy","data-testid":"passwordPolicy",eventKey:1,title:e(x,{children:i("passwordPolicy")}),children:e(Yt,{realm:t,realmUpdated:a})}),e(k,{id:"otpPolicy","data-testid":"otpPolicy",eventKey:2,title:e(x,{children:i("otpPolicy")}),children:e(Bt,{realm:t,realmUpdated:a})}),e(k,{id:"webauthnPolicy","data-testid":"webauthnPolicy",eventKey:3,title:e(x,{children:i("webauthnPolicy")}),children:e(Pe,{realm:t,realmUpdated:a})}),e(k,{id:"webauthnPasswordlessPolicy","data-testid":"webauthnPasswordlessPolicy",eventKey:4,title:e(x,{children:i("webauthnPasswordlessPolicy")}),children:e(Pe,{realm:t,realmUpdated:a,isPasswordLess:!0})}),e(k,{"data-testid":"tab-ciba-policy",eventKey:5,title:e(x,{children:i("cibaPolicy")}),children:e(Kt,{realm:t,realmUpdated:a})})]}):e(se,{})},aa=({id:i,alias:n,usedBy:l,builtIn:t})=>{const{t:a}=S(),{realm:r}=_();return h(E,{children:[e(Ne,{to:At({realm:r,id:i,usedBy:l?.type||"notInUse",builtIn:t?"builtIn":void 0}),children:n},`link-${i}`)," ",t&&e(gt,{children:a("buildIn")},`label-${i}`)]})};function Fa(){const{adminClient:i}=D(),{t:n}=S(),{realm:l,realmRepresentation:t}=_(),[a,r]=R(0),p=()=>r(a+1),{addAlert:u,addError:b}=H(),A=Oe(),[m,g]=R(),[C,d]=ee(),[y,v]=ee(),o=async()=>{const ce=await(await Ce(`${Te(i.baseUrl)}admin/realms/${l}/ui-ext/authentication-management/flows`,{method:"GET",headers:Se(await i.getAccessToken())})).json();return ce?Ft(A(ce,Ct("alias")),qe=>qe.usedBy?.type):[]},f=w=>wt(be({realm:l,tab:w})),s=f("flows"),c=f("required-actions"),P=f("policies"),[T,$]=Pt({titleKey:"deleteConfirmFlow",children:h(Ht,{i18nKey:"deleteConfirmFlowMessage",children:[" ",e("strong",{children:{flow:m?m.alias:""}}),"."]}),continueButtonLabel:"delete",continueButtonVariant:O.danger,onConfirm:async()=>{try{await i.authenticationManagement.deleteFlow({flowId:m.id}),p(),u(n("deleteFlowSuccess"),N.success)}catch(w){b("deleteFlowError",w)}}});return t?h(E,{children:[e($,{}),C&&m&&e(Et,{name:m.alias,description:m.description,toggleDialog:d,onComplete:()=>{p(),d()}}),y&&e(Rt,{onClose:()=>{v(),p()},flowAlias:m?.alias}),e(It,{titleKey:"titleAuthentication",subKey:"authenticationExplain",helpUrl:bt.authenticationUrl,divider:!1}),e(V,{variant:"light",className:"pf-v5-u-p-0",children:h(vt,{isBox:!0,defaultLocation:be({realm:l,tab:"flows"}),children:[e(k,{"data-testid":"flows",title:e(x,{children:n("flows")}),...s,children:e(Re,{loader:o,ariaLabelKey:"titleAuthentication",searchPlaceholderKey:"searchForFlow",toolbarItem:e(xe,{children:e(I,{component:w=>e(Ne,{...w,to:ft({realm:l})}),children:n("createFlow")})}),actionResolver:({data:w})=>[{title:n("duplicate"),onClick:()=>{d(),g(w)}},...w.usedBy?.type!=="DEFAULT"?[{title:n("bindFlow"),onClick:()=>{v(),g(w)}}]:[],...!w.builtIn&&!w.usedBy?[{title:n("delete"),onClick:()=>{g(w),T()}}]:[]],columns:[{name:"alias",displayKey:"flowName",cellRenderer:w=>e(aa,{...w})},{name:"usedBy",displayKey:"usedBy",cellRenderer:w=>e(Lt,{authType:w})},{name:"description",displayKey:"description"}],emptyState:e(yt,{message:n("emptyEvents"),instructions:n("emptyEventsInstructions")})},a)}),e(k,{"data-testid":"requiredActions",title:e(x,{children:n("requiredActions")}),...c,children:e(Mt,{})}),e(k,{"data-testid":"policies",title:e(x,{children:n("policies")}),...P,children:e(ta,{})})]})})]}):e(se,{})}export{Fa as default};
//# sourceMappingURL=AuthenticationSection-C-T_5FuR.js.map
