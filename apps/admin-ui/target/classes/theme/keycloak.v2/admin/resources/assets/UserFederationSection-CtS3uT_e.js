import{jsxs as f,jsx as e,Fragment as F}from"react/jsx-runtime";import{aw as M,av as q,eX as Q,ax as ee,bK as ae,bN as re,bO as B,L as te,aM as oe,aN as ne,al as se,a_ as ie,bL as le,aC as de,aD as N,at as ce,u as V,a as E,_ as K,M as me,k as pe,H as I,I as S,g as L,B as _,d as ue,b as ge,e as he,y as De,D as P,bl as w,eY as U,o as fe,ap as Ce,P as ve,J as O,a1 as ye,a2 as T,dC as be,eZ as ke,e_ as we,e$ as Ie}from"./main-o1hptXRo.js";import*as A from"react";import{useState as D,useMemo as Se}from"react";import{u as Fe}from"./ConfirmDialog-BkU7melV.js";import{G as x,C as Ne}from"./ClickableCard-DgPHEb-r.js";import{V as Le}from"./ViewHeader-BDBsroi3.js";import{s as Pe}from"./sortBy-DjlFeX8O.js";import{b as Ue,c as Oe,a as Te,D as xe}from"./Droppable-daSE-az7.js";import{D as Me,a as Be,b as Ve,c as Ee,d as Ke}from"./DataListItemRow-B_0B-ko6.js";import{D as _e}from"./DataListControl-DO3by3XW.js";import"react-dom";import"./_baseFlatten-BLlCkxtA.js";const G=s=>{var{children:r,className:i,component:t="div"}=s,l=M(s,["children","className","component"]);const n=t;return A.createElement(n,Object.assign({className:q(Q.cardFooter,i)},l),r)};G.displayName="CardFooter";const $=s=>{var{children:r=null,component:i="div"}=s,t=M(s,["children","component"]);const l=i;return A.createElement(l,Object.assign({},t),r)};$.displayName="GalleryItem";const Ae={name:"DatabaseIcon",height:512,width:448,svgPath:"M448 73.143v45.714C448 159.143 347.667 192 224 192S0 159.143 0 118.857V73.143C0 32.857 100.333 0 224 0s224 32.857 224 73.143zM448 176v102.857C448 319.143 347.667 352 224 352S0 319.143 0 278.857V176c48.125 33.143 136.208 48.572 224 48.572S399.874 209.143 448 176zm0 160v102.857C448 479.143 347.667 512 224 512S0 479.143 0 438.857V336c48.125 33.143 136.208 48.572 224 48.572S399.874 369.143 448 336z",yOffset:0,xOffset:0},Ge=ee(Ae),$e=({title:s,dropdownItems:r,labelText:i,labelColor:t,footerText:l,to:n})=>{const[d,p]=D(!1),c=()=>{p(!d)};return f(ae,{isSelectable:!0,isClickable:!0,children:[e(re,{actions:{actions:r?e(oe,{popperProps:{position:"right"},onOpenChange:c,toggle:C=>e(se,{ref:C,onClick:c,variant:"plain","data-testid":`${s}-dropdown`,children:e(ie,{})}),isOpen:d,children:e(ne,{children:r})}):void 0,hasNoOffset:!1,className:void 0},children:e(B,{"data-testid":"keycloak-card-title",children:e(te,{to:n,children:s})})}),e(le,{}),e(G,{children:f(de,{children:[e(N,{className:"keycloak--keycloak-card__footer",children:l&&l}),e(N,{children:i&&e(ce,{color:t||"gray",children:i})})]})})]})},je=({components:s,onClose:r})=>{const{adminClient:i}=V(),{t}=E(),{addAlert:l,addError:n}=K(),[d,p]=D(""),[c,C]=D(Pe(s,"config.priority","name").map(o=>o.name)),b=({index:o})=>(p(t("onDragStart",{item:c[o]})),!0),v=({index:o})=>{p(t("onDragMove",{item:c[o]}))},k=(o,m)=>{if(m){const u=[...c],[h]=u.splice(o.index,1);return u.splice(m.index,0,h),p(t("onDragFinish",{list:u})),C(u),!0}else return p(t("onDragCancel")),!1};return f(me,{variant:pe.small,title:t("managePriorityOrder"),isOpen:!0,onClose:r,actions:[e(L,{id:"modal-confirm",onClick:async()=>{const o=c.map((m,u)=>{const h=s.find(y=>y.name===m);return h.config.priority=[u.toString()],i.components.update({id:h.id},h)});try{await Promise.all(o),l(t("orderChangeSuccessUserFed"))}catch(m){n("orderChangeErrorUserFed",m)}r()},children:t("save")},"confirm"),e(L,{id:"modal-cancel",variant:_.link,onClick:r,children:t("cancel")},"cancel")],children:[e(I,{className:"pf-v5-u-pb-lg",children:e(S,{children:t("managePriorityInfo")})}),e(Ue,{onDrag:b,onDragMove:v,onDrop:k,children:e(Oe,{hasNoWrapper:!0,children:e(Me,{"aria-label":t("manageOrderTableAria"),"data-testid":"manageOrderDataList",isCompact:!0,children:c.map(o=>e(Te,{hasNoWrapper:!0,children:e(Be,{"aria-label":o,id:o,children:f(Ve,{children:[e(_e,{children:e(xe,{"aria-label":t("dragHelp")})}),e(Ee,{dataListCells:[e(Ke,{"data-testid":o,children:o},o)]})]})})},o))})})}),e("div",{className:"pf-v5-screen-reader","aria-live":"assertive",children:d})]})};function ra(){const{adminClient:s}=V(),[r,i]=D(),{addAlert:t,addError:l}=K(),{t:n}=E(),{realm:d,realmRepresentation:p}=ue(),[c,C]=D(0),b=()=>C(new Date().getTime()),v=ge(),[k,o]=D(!1),m=he().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[];De(async()=>{const a={parentId:p.id,type:"org.keycloak.storage.UserStorageProvider"};return s.components.find(a)},a=>{i(a)},[c]);const u=Se(()=>m.map(a=>e(P,{onClick:()=>v(U({realm:d,providerId:a.id})),children:a.id.toUpperCase()=="LDAP"?a.id.toUpperCase():w(a.id)},a.id)),[]),h={variant:"link",onClick:()=>o(!0),lowerButtonTitle:n("managePriorities")};let y;const[j,z]=D(""),[H,R]=Fe({titleKey:n("userFedDeleteConfirmTitle"),messageKey:n("userFedDeleteConfirm"),continueButtonLabel:"delete",continueButtonVariant:_.danger,onConfirm:async()=>{try{await s.components.del({id:j}),b(),t(n("userFedDeletedSuccess"),fe.success)}catch(a){l("userFedDeleteError",a)}}}),W=a=>{z(a),H()},J=(a,g)=>{const Y=`${a.name}`,Z=`${g.name}`;return Y<Z?-1:1},X=(a,g)=>{switch(a){case"ldap":return Ie({realm:d,id:g});case"kerberos":return we({realm:d,id:g});default:return ke({realm:d,providerId:a,id:g})}};return r&&(y=r.sort(J).map((a,g)=>e($,{className:"keycloak-admin--user-federation__gallery-item",children:e($e,{to:X(a.providerId,a.id),dropdownItems:[e(P,{onClick:()=>{W(a.id)},"data-testid":"card-delete",children:n("delete")},`${g}-cardDelete`)],title:a.name,footerText:w(a.providerId),labelText:a.config?.enabled?.[0]!=="false"?n("enabled"):n("disabled"),labelColor:a.config?.enabled?.[0]!=="false"?"blue":"gray"})},g))),f(F,{children:[e(R,{}),k&&r&&e(je,{onClose:()=>o(!1),components:r.filter(a=>a.config?.enabled)}),e(Le,{titleKey:"userFederation",subKey:"userFederationExplain",helpUrl:Ce.userFederationUrl,...r&&r.length>0?{lowerDropdownItems:u,lowerDropdownMenuTitle:"addNewProvider",lowerButton:h}:{}}),e(ve,{children:r&&r.length>0?e(x,{hasGutter:!0,children:y}):f(F,{children:[e(I,{children:e(S,{component:O.p,children:n("getStarted")})}),e(I,{children:e(S,{className:"pf-v5-u-mt-lg",component:O.h2,children:n("add-providers")})}),e("hr",{className:"pf-v5-u-mb-lg"}),e(x,{hasGutter:!0,children:m.map(a=>e(Ne,{onClick:()=>v(U({realm:d,providerId:a.id})),"data-testid":`${a.id}-card`,children:e(B,{children:f(ye,{hasGutter:!0,children:[e(T,{children:e(be,{size:"lg",children:e(Ge,{})})}),e(T,{isFilled:!0,children:n("addProvider",{provider:w(a.id),count:4})})]})})},a.id))})]})})]})}export{ra as default};
//# sourceMappingURL=UserFederationSection-CtS3uT_e.js.map
