import{jsxs as c,Fragment as I,jsx as t}from"react/jsx-runtime";import{u as w,a as N,b as z,_ as C,C as F,j as k,y as H,bV as l,D as U,P as V,l as P,Q as d,A as j,g as m,B as x,L as B,o as E}from"./main-o1hptXRo.js";import{useState as T}from"react";import{F as q}from"./FormAccess-BnhQnYb9.js";import{V as L}from"./ViewHeader-BDBsroi3.js";import{u as Q}from"./useParams-CGVhlaFZ.js";import{D as _}from"./DeleteScopeDialog-BkmTGBOK.js";import"react-dom";import"./ConfirmDialog-BkU7melV.js";function Z(){const{adminClient:n}=w(),{t:e}=N(),{id:o,scopeId:i,realm:s}=Q(),p=z(),{addAlert:S,addError:f}=C(),[v,u]=F(),[r,h]=T(),g=k({mode:"onChange"}),{reset:b,handleSubmit:y}=g;H(async()=>{if(i){const a=await n.clients.getAuthorizationScope({id:o,scopeId:i});if(!a)throw new Error(e("notFound"));return a}},a=>{h(a),b({...a})},[]);const A=async a=>{try{i?(await n.clients.updateAuthorizationScope({id:o,scopeId:i},a),h(a)):(await n.clients.createAuthorizationScope({id:o},{name:a.name,displayName:a.displayName,iconUri:a.iconUri}),p(l({realm:s,clientId:o,tab:"scopes"}))),S(e((i?"update":"create")+"ScopeSuccess"),E.success)}catch(D){f("scopeSaveError",D)}};return c(I,{children:[t(_,{clientId:o,open:v,toggleDialog:u,selectedScope:r,refresh:()=>p(l({realm:s,clientId:o,tab:"scopes"}))}),t(L,{titleKey:i?r?.name:e("createAuthorizationScope"),dropdownItems:i?[t(U,{"data-testid":"delete-resource",onClick:()=>u(),children:e("delete")},"delete")]:void 0}),t(V,{variant:"light",children:t(P,{...g,children:c(q,{isHorizontal:!0,role:"manage-authorization",onSubmit:y(A),children:[t(d,{name:"name",label:e("name"),labelIcon:e("scopeNameHelp"),rules:{required:e("required")}}),t(d,{name:"displayName",label:e("displayName"),labelIcon:e("scopeDisplayNameHelp")}),t(d,{name:"iconUri",label:e("iconUri"),labelIcon:e("iconUriHelp")}),t(j,{children:c("div",{className:"pf-v5-u-mt-md",children:[t(m,{variant:x.primary,type:"submit","data-testid":"save",children:e("save")}),r?t(m,{variant:"link","data-testid":"revert",onClick:()=>b({...r}),children:e("revert")}):t(m,{variant:"link","data-testid":"cancel",component:a=>t(B,{...a,to:l({realm:s,clientId:o,tab:"scopes"})}),children:e("cancel")})]})})]})})})]})}export{Z as default};
//# sourceMappingURL=ScopeDetails-Bb1fx966.js.map
