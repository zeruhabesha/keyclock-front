import{jsxs as c,Fragment as y,jsx as r}from"react/jsx-runtime";import{u as x,a as B,_ as q,j as M,b as j,aS as z,y as E,o as A,bV as w,aW as K,p as O,D as G,P as U,l as W,Q as l,O as D,W as R,A as Q,g as P,B as J,L as X,m as Y,n as Z,bG as $}from"./main-o1hptXRo.js";import{useState as d}from"react";import{D as ee}from"./SwitchControl-CU1bUhmR.js";import{u as re}from"./ConfirmDialog-BkU7melV.js";import{F as ae}from"./FormAccess-BnhQnYb9.js";import{K as te}from"./KeyValueInput-BOsiIUR1.js";import{M as se}from"./MultiLineInput-OP0faqms.js";import{V as oe}from"./ViewHeader-BDBsroi3.js";import{u as ie}from"./useParams-CGVhlaFZ.js";import{S as ne}from"./ScopePicker-Ba7ikc0T.js";import"react-dom";import"./ActionListItem-Cy-NQlq4.js";import"./useIsAdminPermissionsClient-BY-AG4cQ.js";function we(){const{adminClient:o}=x(),{t:e}=B(),[m,N]=d(),[S,p]=d(),[b,C]=d(),{addAlert:f,addError:h}=q(),g=M({mode:"onChange"}),{setValue:F,handleSubmit:H}=g,{id:s,resourceId:t,realm:u}=ie(),I=j(),V=(a={})=>{Y(a,F)},{hasAccess:T}=z(),v=!T("manage-authorization");E(()=>Promise.all([o.clients.findOne({id:s}),t?o.clients.getResource({id:s,resourceId:t}):Promise.resolve(void 0),t?o.clients.listPermissionsByResource({id:s,resourceId:t}):Promise.resolve(void 0)]),([a,i,n])=>{if(!a)throw new Error(e("notFound"));N(a),C(n),p(i),V(i)},[]);const _=async a=>{const i=Z(a);try{if(t)await o.clients.updateResource({id:s,resourceId:t},i);else{const n=await o.clients.createResource({id:s},i);p(i),I($({realm:u,id:s,resourceId:n._id}))}f(e((t?"update":"create")+"ResourceSuccess"),A.success)}catch(n){h("resourceSaveError",n)}},[L,k]=re({titleKey:"deleteResource",children:c(y,{children:[e("deleteResourceConfirm"),b?.length!==0&&r(K,{variant:"warning",isInline:!0,isPlain:!0,title:e("deleteResourceWarning"),className:"pf-v5-u-pt-lg",children:r("p",{className:"pf-v5-u-pt-xs",children:b?.map(a=>r("strong",{className:"pf-v5-u-pr-md",children:a.name},a.id))})})]}),continueButtonLabel:"confirm",onConfirm:async()=>{try{await o.clients.delResource({id:s,resourceId:t}),f(e("resourceDeletedSuccess"),A.success),I(w({realm:u,clientId:s,tab:"resources"}))}catch(a){h("resourceDeletedError",a)}}});return m?c(y,{children:[r(k,{}),r(oe,{titleKey:t?S?.name:"createResource",dropdownItems:t?[r(G,{"data-testid":"delete-resource",isDisabled:v,onClick:()=>L(),children:e("delete")},"delete")]:void 0}),r(U,{variant:"light",children:r(W,{...g,children:c(ae,{isHorizontal:!0,role:"manage-authorization",className:"keycloak__resource-details__form",onSubmit:H(_),children:[r(l,{name:t?"owner.name":"",label:e("owner"),labelIcon:e("ownerHelp"),defaultValue:m.clientId,readOnly:!0}),r(l,{name:"name",label:e("name"),labelIcon:e("resourceNameHelp"),rules:{required:e("required")}}),r(l,{name:"displayName",label:e("displayName"),labelIcon:e("displayNameHelp"),rules:{required:e("required")}}),r(l,{name:"type",label:e("type"),labelIcon:e("resourceDetailsTypeHelp")}),r(D,{label:e("uris"),fieldId:"uris",labelIcon:r(R,{helpText:e("urisHelp"),fieldLabelId:"uris"}),children:r(se,{name:"uris",type:"url","aria-label":e("uris"),addButtonLabel:"addUri"})}),r(ne,{clientId:s}),r(l,{name:"icon_uri",label:e("iconUri"),labelIcon:e("iconUriHelp"),type:"url"}),r(ee,{name:"ownerManagedAccess",label:e("ownerManagedAccess"),labelIcon:e("ownerManagedAccessHelp")}),r(D,{hasNoPaddingTop:!0,label:e("resourceAttribute"),labelIcon:r(R,{helpText:e("resourceAttributeHelp"),fieldLabelId:"resourceAttribute"}),fieldId:"resourceAttribute",children:r(te,{name:"attributes",isDisabled:v})}),r(Q,{children:c("div",{className:"pf-v5-u-mt-md",children:[r(P,{variant:J.primary,type:"submit","data-testid":"save",children:e("save")}),r(P,{variant:"link","data-testid":"cancel",component:a=>r(X,{...a,to:w({realm:u,clientId:s,tab:"resources"})}),children:e("cancel")})]})})]})})})]}):r(O,{})}export{we as default};
//# sourceMappingURL=ResourceDetails-CN7VO4Y4.js.map
