{"version":3,"file":"CreateInitialAccessToken-C4pqNCf4.js","sources":["../../../../../../../src/clients/initial-access/AccessTokenDialog.tsx","../../../../../../../src/clients/initial-access/CreateInitialAccessToken.tsx"],"sourcesContent":["import { useTranslation } from \"react-i18next\";\r\nimport {\r\n  Alert,\r\n  AlertVariant,\r\n  ClipboardCopy,\r\n  Form,\r\n  FormGroup,\r\n  Modal,\r\n  ModalVariant,\r\n} from \"@patternfly/react-core\";\r\n\r\ntype AccessTokenDialogProps = {\r\n  token: string;\r\n  toggleDialog: () => void;\r\n};\r\n\r\nexport const AccessTokenDialog = ({\r\n  token,\r\n  toggleDialog,\r\n}: AccessTokenDialogProps) => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <Modal\r\n      title={t(\"initialAccessTokenDetails\")}\r\n      isOpen={true}\r\n      onClose={toggleDialog}\r\n      variant={ModalVariant.medium}\r\n    >\r\n      <Alert\r\n        title={t(\"copyInitialAccessToken\")}\r\n        component=\"h2\"\r\n        isInline\r\n        variant={AlertVariant.warning}\r\n      />\r\n      <Form className=\"pf-v5-u-mt-md\">\r\n        <FormGroup label={t(\"initialAccessToken\")} fieldId=\"initialAccessToken\">\r\n          <ClipboardCopy\r\n            id=\"initialAccessToken\"\r\n            data-testid=\"initialAccessToken\"\r\n            isReadOnly\r\n          >\r\n            {token}\r\n          </ClipboardCopy>\r\n        </FormGroup>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\n","import type ClientInitialAccessPresentation from \"@keycloak/keycloak-admin-client/lib/defs/clientInitialAccessPresentation\";\r\nimport {\r\n  ActionGroup,\r\n  AlertVariant,\r\n  Button,\r\n  FormGroup,\r\n  PageSection,\r\n} from \"@patternfly/react-core\";\r\nimport { useState } from \"react\";\r\nimport { FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { NumberControl } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport { FormAccess } from \"../../components/form/FormAccess\";\r\nimport { TimeSelectorControl } from \"../../components/time-selector/TimeSelectorControl\";\r\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport { toClients } from \"../routes/Clients\";\r\nimport { AccessTokenDialog } from \"./AccessTokenDialog\";\r\nimport { MultiLineInput } from \"../../components/multi-line-input/MultiLineInput\";\r\nimport { HelpItem } from \"@keycloak/keycloak-ui-shared\";\r\n\r\nexport default function CreateInitialAccessToken() {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const form = useForm({ mode: \"onChange\" });\r\n  const {\r\n    handleSubmit,\r\n    formState: { isValid },\r\n  } = form;\r\n\r\n  const { realm } = useRealm();\r\n  const { addAlert, addError } = useAlerts();\r\n\r\n  const navigate = useNavigate();\r\n  const [token, setToken] = useState(\"\");\r\n\r\n  const save = async (clientToken: ClientInitialAccessPresentation) => {\r\n    try {\r\n      const access = await adminClient.realms.createClientsInitialAccess(\r\n        { realm },\r\n        clientToken,\r\n      );\r\n      setToken(access.token!);\r\n    } catch (error) {\r\n      addError(\"tokenSaveError\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <FormProvider {...form}>\r\n      {token && (\r\n        <AccessTokenDialog\r\n          token={token}\r\n          toggleDialog={() => {\r\n            setToken(\"\");\r\n            addAlert(t(\"tokenSaveSuccess\"), AlertVariant.success);\r\n            navigate(toClients({ realm, tab: \"initial-access-token\" }));\r\n          }}\r\n        />\r\n      )}\r\n      <ViewHeader titleKey=\"createToken\" subKey=\"createTokenHelp\" />\r\n      <PageSection variant=\"light\">\r\n        <FormAccess\r\n          isHorizontal\r\n          role=\"create-client\"\r\n          onSubmit={handleSubmit(save)}\r\n        >\r\n          <TimeSelectorControl\r\n            name=\"expiration\"\r\n            label={t(\"expiration\")}\r\n            labelIcon={t(\"tokenExpirationHelp\")}\r\n            controller={{\r\n              defaultValue: 86400,\r\n              rules: {\r\n                min: {\r\n                  value: 1,\r\n                  message: t(\"expirationValueNotValid\"),\r\n                },\r\n              },\r\n            }}\r\n          />\r\n          <NumberControl\r\n            name=\"count\"\r\n            label={t(\"count\")}\r\n            labelIcon={t(\"countHelp\")}\r\n            controller={{\r\n              rules: {\r\n                min: 1,\r\n              },\r\n              defaultValue: 1,\r\n            }}\r\n          />\r\n          <FormGroup\r\n            label={t(\"webOrigins\")}\r\n            fieldId=\"kc-web-origins\"\r\n            labelIcon={\r\n              <HelpItem\r\n                helpText={t(\"webOriginsHelp\")}\r\n                fieldLabelId=\"webOrigins\"\r\n              />\r\n            }\r\n          >\r\n            <MultiLineInput\r\n              id=\"kc-web-origins\"\r\n              name=\"webOrigins\"\r\n              aria-label={t(\"webOrigins\")}\r\n              addButtonLabel=\"addWebOrigins\"\r\n            />\r\n          </FormGroup>\r\n          <ActionGroup>\r\n            <Button\r\n              variant=\"primary\"\r\n              type=\"submit\"\r\n              data-testid=\"save\"\r\n              isDisabled={!isValid}\r\n            >\r\n              {t(\"save\")}\r\n            </Button>\r\n            <Button\r\n              data-testid=\"cancel\"\r\n              variant=\"link\"\r\n              component={(props) => (\r\n                <Link\r\n                  {...props}\r\n                  to={toClients({ realm, tab: \"initial-access-token\" })}\r\n                />\r\n              )}\r\n            >\r\n              {t(\"cancel\")}\r\n            </Button>\r\n          </ActionGroup>\r\n        </FormAccess>\r\n      </PageSection>\r\n    </FormProvider>\r\n  );\r\n}\r\n"],"names":["AccessTokenDialog","token","toggleDialog","t","useTranslation","jsxs","Modal","ModalVariant","jsx","Alert","AlertVariant","Form","FormGroup","ClipboardCopy","CreateInitialAccessToken","adminClient","useAdminClient","form","useForm","handleSubmit","isValid","realm","useRealm","addAlert","addError","useAlerts","navigate","useNavigate","setToken","useState","FormProvider","toClients","ViewHeader","PageSection","FormAccess","clientToken","access","error","TimeSelectorControl","NumberControl","HelpItem","MultiLineInput","ActionGroup","Button","props","Link"],"mappings":"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"}