{"version":3,"file":"UsersSection-4-OFtKS4.js","sources":["../../../../../../../src/user/details/SearchFilter.tsx","../../../../../../../src/components/users/UserDataTableAttributeSearchForm.tsx","../../../../../../../src/components/users/UserDataTableToolbarItems.tsx","../../../../../../../src/components/users/UserDataTable.tsx","../../../../../../../src/user/UsersSection.tsx"],"sourcesContent":["import { KeycloakSelect } from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  Dropdown,\r\n  DropdownItem,\r\n  DropdownList,\r\n  MenuToggle,\r\n  SelectOption,\r\n  ToolbarItem,\r\n} from \"@patternfly/react-core\";\r\nimport { FilterIcon } from \"@patternfly/react-icons\";\r\nimport { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nexport type SearchType = \"default\" | \"attribute\";\r\n\r\ntype SearchToolbarProps = SearchDropdownProps;\r\n\r\ntype SearchDropdownProps = {\r\n  searchType: SearchType;\r\n  onSelect: (value: SearchType) => void;\r\n};\r\n\r\nexport const SearchDropdown = ({\r\n  searchType,\r\n  onSelect,\r\n}: SearchDropdownProps) => {\r\n  const { t } = useTranslation();\r\n  const [searchToggle, setSearchToggle] = useState(false);\r\n\r\n  const createDropdown = (searchType: SearchType) => (\r\n    <DropdownItem\r\n      key={searchType}\r\n      onClick={() => {\r\n        onSelect(searchType);\r\n        setSearchToggle(false);\r\n      }}\r\n    >\r\n      {t(`searchType.${searchType}`)}\r\n    </DropdownItem>\r\n  );\r\n  const options = [createDropdown(\"default\"), createDropdown(\"attribute\")];\r\n\r\n  return (\r\n    <Dropdown\r\n      className=\"keycloak__users__searchtype\"\r\n      onOpenChange={(isOpen) => setSearchToggle(isOpen)}\r\n      toggle={(ref) => (\r\n        <MenuToggle\r\n          data-testid=\"user-search-toggle\"\r\n          ref={ref}\r\n          id=\"toggle-id\"\r\n          onClick={() => setSearchToggle(!searchToggle)}\r\n          icon={<FilterIcon />}\r\n        >\r\n          {t(`searchType.${searchType}`)}\r\n        </MenuToggle>\r\n      )}\r\n      isOpen={searchToggle}\r\n    >\r\n      <DropdownList>{options}</DropdownList>\r\n    </Dropdown>\r\n  );\r\n};\r\n\r\nexport const SearchToolbar = ({ searchType, onSelect }: SearchToolbarProps) => {\r\n  const { t } = useTranslation();\r\n  const [open, setOpen] = useState(false);\r\n\r\n  return (\r\n    <>\r\n      <ToolbarItem>\r\n        <SearchDropdown searchType={searchType} onSelect={onSelect} />\r\n      </ToolbarItem>\r\n      <ToolbarItem>\r\n        <KeycloakSelect\r\n          className=\"keycloak__users__searchtype\"\r\n          onToggle={(val) => setOpen(val)}\r\n          isOpen={open}\r\n          selections={[t(\"default\"), t(\"attribute\")]}\r\n          onSelect={() => setOpen(false)}\r\n        >\r\n          <SelectOption value={\"default\"}>{t(\"default\")}</SelectOption>\r\n          <SelectOption value={\"attribute\"}>{t(\"attribute\")}</SelectOption>\r\n        </KeycloakSelect>\r\n      </ToolbarItem>\r\n    </>\r\n  );\r\n};\r\n","import type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\r\nimport {\r\n  KeycloakSelect,\r\n  label,\r\n  SelectVariant,\r\n  useAlerts,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  ActionGroup,\r\n  Alert,\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  Checkbox,\r\n  InputGroup,\r\n  InputGroupItem,\r\n  SelectOption,\r\n  Text,\r\n  TextContent,\r\n  TextInput,\r\n  TextVariants,\r\n} from \"@patternfly/react-core\";\r\nimport { CheckIcon } from \"@patternfly/react-icons\";\r\nimport { ReactNode, useState } from \"react\";\r\nimport { useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Form } from \"react-router-dom\";\r\nimport { UserAttribute, UserFilter } from \"./UserDataTable\";\r\n\r\ntype UserDataTableAttributeSearchFormProps = {\r\n  activeFilters: UserFilter;\r\n  setActiveFilters: (filters: UserFilter) => void;\r\n  profile: UserProfileConfig;\r\n  createAttributeSearchChips: () => ReactNode;\r\n  searchUserWithAttributes: () => void;\r\n};\r\n\r\ntype UserFilterForm = UserAttribute & { exact: boolean };\r\n\r\nexport function UserDataTableAttributeSearchForm({\r\n  activeFilters,\r\n  setActiveFilters,\r\n  profile,\r\n  createAttributeSearchChips,\r\n  searchUserWithAttributes,\r\n}: UserDataTableAttributeSearchFormProps) {\r\n  const { t } = useTranslation();\r\n  const { addAlert } = useAlerts();\r\n  const [selectAttributeKeyOpen, setSelectAttributeKeyOpen] = useState(false);\r\n\r\n  const defaultValues: UserAttribute = {\r\n    name: \"\",\r\n    displayName: \"\",\r\n    value: \"\",\r\n  };\r\n\r\n  const {\r\n    getValues,\r\n    register,\r\n    reset,\r\n    formState: { errors },\r\n    setValue,\r\n    setError,\r\n    clearErrors,\r\n  } = useForm<UserFilterForm>({\r\n    mode: \"onChange\",\r\n    defaultValues,\r\n  });\r\n\r\n  const isAttributeKeyDuplicate = () => {\r\n    return activeFilters.userAttribute.some(\r\n      (filter) => filter.name === getValues().name,\r\n    );\r\n  };\r\n\r\n  const isAttributeNameValid = () => {\r\n    let valid = false;\r\n    if (!getValues().name.length) {\r\n      setError(\"name\", {\r\n        type: \"empty\",\r\n        message: t(\"searchUserByAttributeMissingKeyError\"),\r\n      });\r\n    } else if (\r\n      activeFilters.userAttribute.some(\r\n        (filter) => filter.name === getValues().name,\r\n      )\r\n    ) {\r\n      setError(\"name\", {\r\n        type: \"conflict\",\r\n        message: t(\"searchUserByAttributeKeyAlreadyInUseError\"),\r\n      });\r\n    } else {\r\n      valid = true;\r\n    }\r\n    return valid;\r\n  };\r\n\r\n  const isAttributeValueValid = () => {\r\n    let valid = false;\r\n    if (!getValues().value.length) {\r\n      setError(\"value\", {\r\n        type: \"empty\",\r\n        message: t(\"searchUserByAttributeMissingValueError\"),\r\n      });\r\n    } else {\r\n      valid = true;\r\n    }\r\n    return valid;\r\n  };\r\n\r\n  const isAttributeValid = () =>\r\n    isAttributeNameValid() && isAttributeValueValid();\r\n\r\n  const addToFilter = () => {\r\n    if (isAttributeValid()) {\r\n      setActiveFilters({\r\n        ...activeFilters,\r\n        userAttribute: [...activeFilters.userAttribute, { ...getValues() }],\r\n      });\r\n      reset(defaultValues);\r\n    } else {\r\n      if (errors.name?.message) {\r\n        addAlert(errors.name.message, AlertVariant.danger);\r\n      }\r\n\r\n      if (errors.value?.message) {\r\n        addAlert(errors.value.message, AlertVariant.danger);\r\n      }\r\n    }\r\n  };\r\n\r\n  const clearActiveFilters = () => {\r\n    const filtered = [...activeFilters.userAttribute].filter(\r\n      (chip) => chip.name !== chip.name,\r\n    );\r\n    setActiveFilters({ ...activeFilters, userAttribute: filtered });\r\n  };\r\n\r\n  const createAttributeKeyInputField = () => {\r\n    if (profile) {\r\n      return (\r\n        <KeycloakSelect\r\n          data-testid=\"search-attribute-name-select\"\r\n          variant={SelectVariant.typeahead}\r\n          onToggle={(isOpen) => setSelectAttributeKeyOpen(isOpen)}\r\n          selections={getValues().displayName}\r\n          onSelect={(selectedValue) => {\r\n            setValue(\"displayName\", selectedValue.toString());\r\n            if (isAttributeKeyDuplicate()) {\r\n              setError(\"name\", { type: \"conflict\" });\r\n            } else {\r\n              clearErrors(\"name\");\r\n            }\r\n          }}\r\n          isOpen={selectAttributeKeyOpen}\r\n          placeholderText={t(\"selectAttribute\")}\r\n          validated={errors.name && \"error\"}\r\n          maxHeight={300}\r\n          {...register(\"displayName\", {\r\n            required: true,\r\n            validate: isAttributeNameValid,\r\n          })}\r\n        >\r\n          {profile.attributes?.map((option) => (\r\n            <SelectOption\r\n              key={option.name}\r\n              value={label(t, option.displayName!, option.name)}\r\n              onClick={(e) => {\r\n                e.stopPropagation();\r\n                setSelectAttributeKeyOpen(false);\r\n                setValue(\"name\", option.name!);\r\n              }}\r\n            >\r\n              {label(t, option.displayName!, option.name)}\r\n            </SelectOption>\r\n          ))}\r\n        </KeycloakSelect>\r\n      );\r\n    } else {\r\n      return (\r\n        <TextInput\r\n          id=\"name\"\r\n          placeholder={t(\"keyPlaceholder\")}\r\n          validated={errors.name && \"error\"}\r\n          onKeyDown={(e) => e.key === \"Enter\" && addToFilter()}\r\n          {...register(\"name\", {\r\n            required: true,\r\n            validate: isAttributeNameValid,\r\n          })}\r\n        />\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Form\r\n      className=\"user-attribute-search-form\"\r\n      data-testid=\"user-attribute-search-form\"\r\n    >\r\n      <TextContent className=\"user-attribute-search-form-headline\">\r\n        <Text component={TextVariants.h2}>{t(\"selectAttributes\")}</Text>\r\n      </TextContent>\r\n      <Alert\r\n        isInline\r\n        className=\"user-attribute-search-form-alert\"\r\n        variant=\"info\"\r\n        title={t(\"searchUserByAttributeDescription\")}\r\n        component=\"h3\"\r\n      />\r\n      <TextContent className=\"user-attribute-search-form-key-value\">\r\n        <div className=\"user-attribute-search-form-left\">\r\n          <Text component={TextVariants.h3}>{t(\"key\")}</Text>\r\n        </div>\r\n        <div className=\"user-attribute-search-form-right\">\r\n          <Text component={TextVariants.h3}>{t(\"value\")}</Text>\r\n        </div>\r\n      </TextContent>\r\n      <div className=\"user-attribute-search-form-left\">\r\n        {createAttributeKeyInputField()}\r\n      </div>\r\n      <div className=\"user-attribute-search-form-right\">\r\n        <InputGroup>\r\n          <InputGroupItem>\r\n            <TextInput\r\n              id=\"value\"\r\n              placeholder={t(\"valuePlaceholder\")}\r\n              validated={errors.value && \"error\"}\r\n              onKeyDown={(e) => {\r\n                if (e.key === \"Enter\") {\r\n                  e.preventDefault();\r\n                  addToFilter();\r\n                }\r\n              }}\r\n              {...register(\"value\", {\r\n                required: true,\r\n                validate: isAttributeValueValid,\r\n              })}\r\n            />\r\n          </InputGroupItem>\r\n          <InputGroupItem>\r\n            <Button\r\n              data-testid=\"user-attribute-search-add-filter-button\"\r\n              variant=\"control\"\r\n              icon={<CheckIcon />}\r\n              onClick={addToFilter}\r\n              aria-label={t(\"addToFilter\")}\r\n            />\r\n          </InputGroupItem>\r\n        </InputGroup>\r\n      </div>\r\n      {createAttributeSearchChips()}\r\n\r\n      <div className=\"pf-v5-u-pt-lg\">\r\n        <Checkbox\r\n          id=\"exact\"\r\n          data-testid=\"exact\"\r\n          label={t(\"exactSearch\")}\r\n          isChecked={activeFilters.exact}\r\n          onChange={(_, value) => {\r\n            setActiveFilters({\r\n              ...activeFilters,\r\n              exact: value,\r\n            });\r\n          }}\r\n        />\r\n      </div>\r\n      <ActionGroup className=\"user-attribute-search-form-action-group\">\r\n        <Button\r\n          data-testid=\"search-user-attribute-btn\"\r\n          variant=\"primary\"\r\n          type=\"submit\"\r\n          isDisabled={!activeFilters.userAttribute.length}\r\n          onClick={searchUserWithAttributes}\r\n        >\r\n          {t(\"search\")}\r\n        </Button>\r\n        <Button\r\n          variant={ButtonVariant.link}\r\n          onClick={() => {\r\n            reset();\r\n            clearActiveFilters();\r\n          }}\r\n        >\r\n          {t(\"reset\")}\r\n        </Button>\r\n      </ActionGroup>\r\n    </Form>\r\n  );\r\n}\r\n","import type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\r\nimport type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\r\nimport {\r\n  Button,\r\n  ButtonVariant,\r\n  Dropdown,\r\n  DropdownItem,\r\n  DropdownList,\r\n  InputGroup,\r\n  InputGroupItem,\r\n  MenuToggle,\r\n  SearchInput,\r\n  ToolbarItem,\r\n} from \"@patternfly/react-core\";\r\nimport { ArrowRightIcon, EllipsisVIcon } from \"@patternfly/react-icons\";\r\nimport { ReactNode, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport { useAccess } from \"../../context/access/Access\";\r\nimport { SearchDropdown, SearchType } from \"../../user/details/SearchFilter\";\r\nimport DropdownPanel from \"../dropdown-panel/DropdownPanel\";\r\nimport { UserFilter } from \"./UserDataTable\";\r\nimport { UserDataTableAttributeSearchForm } from \"./UserDataTableAttributeSearchForm\";\r\n\r\ntype UserDataTableToolbarItemsProps = {\r\n  searchDropdownOpen: boolean;\r\n  setSearchDropdownOpen: (open: boolean) => void;\r\n  realm: RealmRepresentation;\r\n  hasSelectedRows: boolean;\r\n  toggleDeleteDialog: () => void;\r\n  toggleUnlockUsersDialog: () => void;\r\n  goToCreate: () => void;\r\n  searchType: SearchType;\r\n  setSearchType: (searchType: SearchType) => void;\r\n  searchUser: string;\r\n  setSearchUser: (searchUser: string) => void;\r\n  activeFilters: UserFilter;\r\n  setActiveFilters: (activeFilters: UserFilter) => void;\r\n  refresh: () => void;\r\n  profile: UserProfileConfig;\r\n  clearAllFilters: () => void;\r\n  createAttributeSearchChips: () => ReactNode;\r\n  searchUserWithAttributes: () => void;\r\n};\r\n\r\nexport function UserDataTableToolbarItems({\r\n  searchDropdownOpen,\r\n  setSearchDropdownOpen,\r\n  realm,\r\n  hasSelectedRows,\r\n  toggleDeleteDialog,\r\n  toggleUnlockUsersDialog,\r\n  goToCreate,\r\n  searchType,\r\n  setSearchType,\r\n  searchUser,\r\n  setSearchUser,\r\n  activeFilters,\r\n  setActiveFilters,\r\n  refresh,\r\n  profile,\r\n  clearAllFilters,\r\n  createAttributeSearchChips,\r\n  searchUserWithAttributes,\r\n}: UserDataTableToolbarItemsProps) {\r\n  const { t } = useTranslation();\r\n  const [kebabOpen, setKebabOpen] = useState(false);\r\n\r\n  const { hasAccess } = useAccess();\r\n\r\n  // Only needs query-users access to attempt add/delete of users.\r\n  // This is because the user could have fine-grained access to users\r\n  // of a group.  There is no way to know this without searching the\r\n  // permissions of every group.\r\n  const isManager = hasAccess(\"query-users\");\r\n\r\n  const searchItem = () => {\r\n    return (\r\n      <ToolbarItem>\r\n        <InputGroup>\r\n          <InputGroupItem>\r\n            <SearchDropdown\r\n              searchType={searchType}\r\n              onSelect={(searchType) => {\r\n                clearAllFilters();\r\n                setSearchType(searchType);\r\n              }}\r\n            />\r\n          </InputGroupItem>\r\n          {searchType === \"default\" && defaultSearchInput()}\r\n          {searchType === \"attribute\" && attributeSearchInput()}\r\n        </InputGroup>\r\n      </ToolbarItem>\r\n    );\r\n  };\r\n\r\n  const defaultSearchInput = () => {\r\n    return (\r\n      <ToolbarItem>\r\n        <SearchInput\r\n          data-testid=\"table-search-input\"\r\n          placeholder={t(\"searchForUser\")}\r\n          aria-label={t(\"search\")}\r\n          value={searchUser}\r\n          onSearch={(_, _v, attribute) => {\r\n            setSearchUser(attribute[\"haswords\"]);\r\n            refresh();\r\n          }}\r\n          onKeyDown={(e) => {\r\n            if (e.key === \"Enter\") {\r\n              const target = e.target as HTMLInputElement;\r\n              setSearchUser(target.value);\r\n              refresh();\r\n            }\r\n          }}\r\n          onClear={() => {\r\n            setSearchUser(\"\");\r\n            refresh();\r\n          }}\r\n        />\r\n      </ToolbarItem>\r\n    );\r\n  };\r\n\r\n  const attributeSearchInput = () => {\r\n    return (\r\n      <>\r\n        <DropdownPanel\r\n          data-testid=\"select-attributes-dropdown\"\r\n          buttonText={t(\"selectAttributes\")}\r\n          setSearchDropdownOpen={setSearchDropdownOpen}\r\n          searchDropdownOpen={searchDropdownOpen}\r\n          width=\"15vw\"\r\n        >\r\n          <UserDataTableAttributeSearchForm\r\n            activeFilters={activeFilters}\r\n            setActiveFilters={setActiveFilters}\r\n            profile={profile}\r\n            createAttributeSearchChips={createAttributeSearchChips}\r\n            searchUserWithAttributes={() => {\r\n              searchUserWithAttributes();\r\n              setSearchDropdownOpen(false);\r\n            }}\r\n          />\r\n        </DropdownPanel>\r\n        <Button\r\n          icon={<ArrowRightIcon />}\r\n          variant=\"control\"\r\n          onClick={() => {\r\n            searchUserWithAttributes();\r\n            setSearchDropdownOpen(false);\r\n          }}\r\n          aria-label={t(\"searchAttributes\")}\r\n        />\r\n      </>\r\n    );\r\n  };\r\n\r\n  const bruteForceProtectionToolbarItem = !realm.bruteForceProtected ? (\r\n    <ToolbarItem>\r\n      <Button\r\n        variant={ButtonVariant.link}\r\n        onClick={toggleDeleteDialog}\r\n        data-testid=\"delete-user-btn\"\r\n        isDisabled={hasSelectedRows}\r\n      >\r\n        {t(\"deleteUser\")}\r\n      </Button>\r\n    </ToolbarItem>\r\n  ) : (\r\n    <ToolbarItem>\r\n      <Dropdown\r\n        onOpenChange={(isOpen) => setKebabOpen(isOpen)}\r\n        toggle={(ref) => (\r\n          <MenuToggle\r\n            ref={ref}\r\n            isExpanded={kebabOpen}\r\n            variant=\"plain\"\r\n            onClick={() => setKebabOpen(!kebabOpen)}\r\n          >\r\n            <EllipsisVIcon />\r\n          </MenuToggle>\r\n        )}\r\n        isOpen={kebabOpen}\r\n        shouldFocusToggleOnSelect\r\n      >\r\n        <DropdownList>\r\n          <DropdownItem\r\n            key=\"deleteUser\"\r\n            component=\"button\"\r\n            isDisabled={hasSelectedRows}\r\n            onClick={() => {\r\n              toggleDeleteDialog();\r\n              setKebabOpen(false);\r\n            }}\r\n          >\r\n            {t(\"deleteUser\")}\r\n          </DropdownItem>\r\n\r\n          <DropdownItem\r\n            key=\"unlock\"\r\n            component=\"button\"\r\n            onClick={() => {\r\n              toggleUnlockUsersDialog();\r\n              setKebabOpen(false);\r\n            }}\r\n          >\r\n            {t(\"unlockAllUsers\")}\r\n          </DropdownItem>\r\n        </DropdownList>\r\n      </Dropdown>\r\n    </ToolbarItem>\r\n  );\r\n\r\n  const actionItems = (\r\n    <>\r\n      <ToolbarItem>\r\n        <Button data-testid=\"add-user\" onClick={goToCreate}>\r\n          {t(\"addUser\")}\r\n        </Button>\r\n      </ToolbarItem>\r\n      {bruteForceProtectionToolbarItem}\r\n    </>\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {searchItem()}\r\n      {isManager ? actionItems : null}\r\n    </>\r\n  );\r\n}\r\n","import type { UserProfileConfig } from \"@keycloak/keycloak-admin-client/lib/defs/userProfileMetadata\";\r\nimport type UserRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/userRepresentation\";\r\nimport {\r\n  KeycloakDataTable,\r\n  KeycloakSpinner,\r\n  ListEmptyState,\r\n  useAlerts,\r\n  useFetch,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  Chip,\r\n  ChipGroup,\r\n  EmptyState,\r\n  FlexItem,\r\n  Label,\r\n  Text,\r\n  TextContent,\r\n  Toolbar,\r\n  ToolbarContent,\r\n  ToolbarItem,\r\n  Tooltip,\r\n} from \"@patternfly/react-core\";\r\nimport {\r\n  ExclamationCircleIcon,\r\n  InfoCircleIcon,\r\n  WarningTriangleIcon,\r\n} from \"@patternfly/react-icons\";\r\nimport type { IRowData } from \"@patternfly/react-table\";\r\nimport { JSX, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { fetchRealmInfo } from \"../../context/auth/admin-ui-endpoint\";\r\nimport { UiRealmInfo } from \"../../context/auth/uiRealmInfo\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport { SearchType } from \"../../user/details/SearchFilter\";\r\nimport { toAddUser } from \"../../user/routes/AddUser\";\r\nimport { toUser } from \"../../user/routes/User\";\r\nimport { emptyFormatter } from \"../../util\";\r\nimport { useConfirmDialog } from \"../confirm-dialog/ConfirmDialog\";\r\nimport { BruteUser, findUsers } from \"../role-mapping/resource\";\r\nimport { UserDataTableToolbarItems } from \"./UserDataTableToolbarItems\";\r\nimport { NetworkError } from \"@keycloak/keycloak-admin-client\";\r\n\r\nexport type UserFilter = {\r\n  exact: boolean;\r\n  userAttribute: UserAttribute[];\r\n};\r\n\r\nexport type UserAttribute = {\r\n  name: string;\r\n  displayName: string;\r\n  value: string;\r\n};\r\n\r\nconst UserDetailLink = (user: BruteUser) => {\r\n  const { t } = useTranslation();\r\n  const { realm } = useRealm();\r\n  return (\r\n    <>\r\n      <Link to={toUser({ realm, id: user.id!, tab: \"settings\" })}>\r\n        {user.username}\r\n        <StatusRow user={user} />\r\n      </Link>\r\n      {user.attributes?.[\"is_temporary_admin\"]?.[0] === \"true\" && (\r\n        <Tooltip content={t(\"temporaryAdmin\")}>\r\n          <WarningTriangleIcon\r\n            className=\"pf-v5-u-ml-sm\"\r\n            id=\"temporary-admin-label\"\r\n          />\r\n        </Tooltip>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\ntype StatusRowProps = {\r\n  user: BruteUser;\r\n};\r\n\r\nconst StatusRow = ({ user }: StatusRowProps) => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <>\r\n      {!user.enabled && (\r\n        <Label color=\"red\" icon={<InfoCircleIcon />}>\r\n          {t(\"disabled\")}\r\n        </Label>\r\n      )}\r\n      {user.bruteForceStatus?.disabled && (\r\n        <Label color=\"orange\" icon={<WarningTriangleIcon />}>\r\n          {t(\"temporaryLocked\")}\r\n        </Label>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nconst ValidatedEmail = (user: UserRepresentation) => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <>\r\n      {!user.emailVerified && (\r\n        <Tooltip content={t(\"notVerified\")}>\r\n          <ExclamationCircleIcon className=\"keycloak__user-section__email-verified\" />\r\n        </Tooltip>\r\n      )}{\" \"}\r\n      {emptyFormatter()(user.email) as JSX.Element}\r\n    </>\r\n  );\r\n};\r\n\r\nexport function UserDataTable() {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const { addAlert, addError } = useAlerts();\r\n  const { realm: realmName, realmRepresentation: realm } = useRealm();\r\n  const navigate = useNavigate();\r\n  const [uiRealmInfo, setUiRealmInfo] = useState<UiRealmInfo>({});\r\n  const [searchUser, setSearchUser] = useState(\"\");\r\n  const [selectedRows, setSelectedRows] = useState<UserRepresentation[]>([]);\r\n  const [searchType, setSearchType] = useState<SearchType>(\"default\");\r\n  const [searchDropdownOpen, setSearchDropdownOpen] = useState(false);\r\n  const [activeFilters, setActiveFilters] = useState<UserFilter>({\r\n    exact: false,\r\n    userAttribute: [],\r\n  });\r\n  const [profile, setProfile] = useState<UserProfileConfig>({});\r\n  const [query, setQuery] = useState(\"\");\r\n\r\n  const [key, setKey] = useState(0);\r\n  const refresh = () => setKey(key + 1);\r\n\r\n  useFetch(\r\n    async () => {\r\n      try {\r\n        return await Promise.all([\r\n          fetchRealmInfo(adminClient),\r\n          adminClient.users.getProfile(),\r\n        ]);\r\n      } catch (error) {\r\n        if (error instanceof NetworkError && error?.response?.status === 403) {\r\n          // \"User Profile\" attributes not available for Users Attribute search, when admin user does not have view- or manage-realm realm-management role\r\n          return [{}, {}] as [UiRealmInfo, UserProfileConfig];\r\n        } else {\r\n          throw error;\r\n        }\r\n      }\r\n    },\r\n    ([uiRealmInfo, profile]) => {\r\n      setUiRealmInfo(uiRealmInfo);\r\n      setProfile(profile);\r\n    },\r\n    [],\r\n  );\r\n\r\n  const loader = async (first?: number, max?: number, search?: string) => {\r\n    const params: { [name: string]: string | number | boolean } = {\r\n      first: first!,\r\n      max: max!,\r\n      q: query!,\r\n    };\r\n\r\n    const searchParam = search || searchUser || \"\";\r\n    if (searchParam) {\r\n      params.search = searchParam;\r\n    }\r\n\r\n    if (activeFilters.exact) params.exact = true;\r\n\r\n    if (!listUsers && !(params.search || params.q)) {\r\n      return [];\r\n    }\r\n\r\n    try {\r\n      return await findUsers(adminClient, {\r\n        briefRepresentation: true,\r\n        ...params,\r\n      });\r\n    } catch (error) {\r\n      if (uiRealmInfo.userProfileProvidersEnabled) {\r\n        addError(\"noUsersFoundErrorStorage\", error);\r\n      } else {\r\n        addError(\"noUsersFoundError\", error);\r\n      }\r\n      return [];\r\n    }\r\n  };\r\n\r\n  const [toggleUnlockUsersDialog, UnlockUsersConfirm] = useConfirmDialog({\r\n    titleKey: \"unlockAllUsers\",\r\n    messageKey: \"unlockUsersConfirm\",\r\n    continueButtonLabel: \"unlock\",\r\n    onConfirm: async () => {\r\n      try {\r\n        await adminClient.attackDetection.delAll();\r\n        refresh();\r\n        addAlert(t(\"unlockUsersSuccess\"), AlertVariant.success);\r\n      } catch (error) {\r\n        addError(\"unlockUsersError\", error);\r\n      }\r\n    },\r\n  });\r\n\r\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\r\n    titleKey: t(\"deleteConfirmUsers\", {\r\n      count: selectedRows.length,\r\n      name: selectedRows[0]?.username,\r\n    }),\r\n    messageKey: t(\"deleteConfirmDialog\", { count: selectedRows.length }),\r\n    continueButtonLabel: \"delete\",\r\n    continueButtonVariant: ButtonVariant.danger,\r\n    onConfirm: async () => {\r\n      try {\r\n        for (const user of selectedRows) {\r\n          await adminClient.users.del({ id: user.id! });\r\n        }\r\n        setSelectedRows([]);\r\n        clearAllFilters();\r\n        addAlert(t(\"userDeletedSuccess\"), AlertVariant.success);\r\n      } catch (error) {\r\n        addError(\"userDeletedError\", error);\r\n      }\r\n    },\r\n  });\r\n\r\n  const goToCreate = () => navigate(toAddUser({ realm: realmName }));\r\n\r\n  if (uiRealmInfo.userProfileProvidersEnabled === undefined || !realm) {\r\n    return <KeycloakSpinner />;\r\n  }\r\n\r\n  //should *only* list users when no user federation is configured\r\n  const listUsers = !uiRealmInfo.userProfileProvidersEnabled;\r\n\r\n  const clearAllFilters = () => {\r\n    setActiveFilters({ exact: false, userAttribute: [] });\r\n    setSearchUser(\"\");\r\n    setQuery(\"\");\r\n    refresh();\r\n  };\r\n\r\n  const createQueryString = (filters: UserFilter) => {\r\n    return filters.userAttribute\r\n      .map((filter) => `${filter.name}:${filter.value}`)\r\n      .join(\" \");\r\n  };\r\n\r\n  const searchUserWithAttributes = () => {\r\n    const attributes = createQueryString(activeFilters);\r\n    setQuery(attributes);\r\n    refresh();\r\n  };\r\n\r\n  const createAttributeSearchChips = () => {\r\n    return (\r\n      <FlexItem>\r\n        {activeFilters.userAttribute.length > 0 && (\r\n          <>\r\n            {Object.values(activeFilters.userAttribute).map((entry) => {\r\n              return (\r\n                <ChipGroup\r\n                  className=\"pf-v5-u-mt-md pf-v5-u-mr-md\"\r\n                  data-testid=\"user-attribute-search-chips-group\"\r\n                  key={entry.name}\r\n                  categoryName={\r\n                    entry.displayName.length ? entry.displayName : entry.name\r\n                  }\r\n                  isClosable\r\n                  onClick={(event) => {\r\n                    event.stopPropagation();\r\n\r\n                    const filtered = [...activeFilters.userAttribute].filter(\r\n                      (chip) => chip.name !== entry.name,\r\n                    );\r\n                    const active = {\r\n                      userAttribute: filtered,\r\n                      exact: activeFilters.exact,\r\n                    };\r\n\r\n                    setActiveFilters(active);\r\n                    setQuery(createQueryString(active));\r\n                    refresh();\r\n                  }}\r\n                >\r\n                  <Chip key={entry.name} isReadOnly>\r\n                    {entry.value}\r\n                  </Chip>\r\n                </ChipGroup>\r\n              );\r\n            })}\r\n          </>\r\n        )}\r\n      </FlexItem>\r\n    );\r\n  };\r\n\r\n  const toolbar = () => {\r\n    return (\r\n      <UserDataTableToolbarItems\r\n        searchDropdownOpen={searchDropdownOpen}\r\n        setSearchDropdownOpen={setSearchDropdownOpen}\r\n        realm={realm}\r\n        hasSelectedRows={selectedRows.length === 0}\r\n        toggleDeleteDialog={toggleDeleteDialog}\r\n        toggleUnlockUsersDialog={toggleUnlockUsersDialog}\r\n        goToCreate={goToCreate}\r\n        searchType={searchType}\r\n        setSearchType={setSearchType}\r\n        searchUser={searchUser}\r\n        setSearchUser={setSearchUser}\r\n        activeFilters={activeFilters}\r\n        setActiveFilters={setActiveFilters}\r\n        refresh={refresh}\r\n        profile={profile}\r\n        clearAllFilters={clearAllFilters}\r\n        createAttributeSearchChips={createAttributeSearchChips}\r\n        searchUserWithAttributes={searchUserWithAttributes}\r\n      />\r\n    );\r\n  };\r\n\r\n  const subtoolbar = () => {\r\n    if (!activeFilters.userAttribute.length) {\r\n      return;\r\n    }\r\n    return (\r\n      <div className=\"user-attribute-search-form-subtoolbar\">\r\n        <ToolbarItem>{createAttributeSearchChips()}</ToolbarItem>\r\n        <ToolbarItem>\r\n          <Button\r\n            variant=\"link\"\r\n            onClick={() => {\r\n              clearAllFilters();\r\n            }}\r\n          >\r\n            {t(\"clearAllFilters\")}\r\n          </Button>\r\n        </ToolbarItem>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <DeleteConfirm />\r\n      <UnlockUsersConfirm />\r\n      <KeycloakDataTable\r\n        isSearching={\r\n          searchUser !== \"\" || activeFilters.userAttribute.length !== 0\r\n        }\r\n        key={key}\r\n        loader={loader}\r\n        isPaginated\r\n        ariaLabelKey=\"titleUsers\"\r\n        canSelectAll\r\n        onSelect={(rows: UserRepresentation[]) => setSelectedRows([...rows])}\r\n        emptyState={\r\n          !listUsers ? (\r\n            <>\r\n              <Toolbar>\r\n                <ToolbarContent>{toolbar()}</ToolbarContent>\r\n              </Toolbar>\r\n              <EmptyState data-testid=\"empty-state\" variant=\"lg\">\r\n                <TextContent className=\"kc-search-users-text\">\r\n                  <Text>{t(\"searchForUserDescription\")}</Text>\r\n                </TextContent>\r\n              </EmptyState>\r\n            </>\r\n          ) : (\r\n            <ListEmptyState\r\n              message={t(\"noUsersFound\")}\r\n              instructions={t(\"emptyInstructions\")}\r\n              primaryActionText={t(\"createNewUser\")}\r\n              onPrimaryAction={goToCreate}\r\n            />\r\n          )\r\n        }\r\n        toolbarItem={toolbar()}\r\n        subToolbar={subtoolbar()}\r\n        actionResolver={(rowData: IRowData) => [\r\n          {\r\n            title: t(\"delete\"),\r\n            onClick: () => {\r\n              setSelectedRows([rowData.data]);\r\n              toggleDeleteDialog();\r\n            },\r\n          },\r\n        ]}\r\n        isRowDisabled={(user: UserRepresentation) => !user.access?.manage}\r\n        columns={[\r\n          {\r\n            name: \"username\",\r\n            displayKey: \"username\",\r\n            cellRenderer: UserDetailLink,\r\n          },\r\n          {\r\n            name: \"email\",\r\n            displayKey: \"email\",\r\n            cellRenderer: ValidatedEmail,\r\n          },\r\n          {\r\n            name: \"lastName\",\r\n            displayKey: \"lastName\",\r\n            cellFormatters: [emptyFormatter()],\r\n          },\r\n          {\r\n            name: \"firstName\",\r\n            displayKey: \"firstName\",\r\n            cellFormatters: [emptyFormatter()],\r\n          },\r\n        ]}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { useTranslation } from \"react-i18next\";\r\nimport { PageSection, Tab, TabTitleText } from \"@patternfly/react-core\";\r\n\r\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport helpUrls from \"../help-urls\";\r\nimport { PermissionsTab } from \"../components/permission-tab/PermissionTab\";\r\nimport { UserDataTable } from \"../components/users/UserDataTable\";\r\nimport { toUsers, UserTab } from \"./routes/Users\";\r\nimport {\r\n  RoutableTabs,\r\n  useRoutableTab,\r\n} from \"../components/routable-tabs/RoutableTabs\";\r\nimport useIsFeatureEnabled, { Feature } from \"../utils/useIsFeatureEnabled\";\r\nimport \"./user-section.css\";\r\nimport { useAccess } from \"../context/access/Access\";\r\n\r\nexport default function UsersSection() {\r\n  const { t } = useTranslation();\r\n  const { realm: realmName } = useRealm();\r\n  const { hasAccess } = useAccess();\r\n  const isFeatureEnabled = useIsFeatureEnabled();\r\n\r\n  const canViewPermissions =\r\n    isFeatureEnabled(Feature.AdminFineGrainedAuthz) &&\r\n    hasAccess(\"manage-authorization\", \"manage-users\", \"manage-clients\");\r\n\r\n  const useTab = (tab: UserTab) =>\r\n    useRoutableTab(\r\n      toUsers({\r\n        realm: realmName,\r\n        tab,\r\n      }),\r\n    );\r\n\r\n  const listTab = useTab(\"list\");\r\n  const permissionsTab = useTab(\"permissions\");\r\n\r\n  return (\r\n    <>\r\n      <ViewHeader\r\n        titleKey=\"titleUsers\"\r\n        subKey=\"usersExplain\"\r\n        helpUrl={helpUrls.usersUrl}\r\n        divider={false}\r\n      />\r\n      <PageSection\r\n        data-testid=\"users-page\"\r\n        variant=\"light\"\r\n        className=\"pf-v5-u-p-0\"\r\n      >\r\n        <RoutableTabs\r\n          data-testid=\"user-tabs\"\r\n          defaultLocation={toUsers({\r\n            realm: realmName,\r\n            tab: \"list\",\r\n          })}\r\n          isBox\r\n          mountOnEnter\r\n        >\r\n          <Tab\r\n            id=\"list\"\r\n            data-testid=\"listTab\"\r\n            title={<TabTitleText>{t(\"userList\")}</TabTitleText>}\r\n            {...listTab}\r\n          >\r\n            <UserDataTable />\r\n          </Tab>\r\n          {canViewPermissions && (\r\n            <Tab\r\n              id=\"permissions\"\r\n              data-testid=\"permissionsTab\"\r\n              title={<TabTitleText>{t(\"permissions\")}</TabTitleText>}\r\n              {...permissionsTab}\r\n            >\r\n              <PermissionsTab type=\"users\" />\r\n            </Tab>\r\n          )}\r\n        </RoutableTabs>\r\n      </PageSection>\r\n    </>\r\n  );\r\n}\r\n"],"names":["SearchDropdown","searchType","onSelect","t","useTranslation","searchToggle","setSearchToggle","useState","createDropdown","jsx","DropdownItem","options","Dropdown","isOpen","ref","MenuToggle","FilterIcon","DropdownList","UserDataTableAttributeSearchForm","activeFilters","setActiveFilters","profile","createAttributeSearchChips","searchUserWithAttributes","addAlert","useAlerts","selectAttributeKeyOpen","setSelectAttributeKeyOpen","defaultValues","getValues","register","reset","errors","setValue","setError","clearErrors","useForm","isAttributeKeyDuplicate","filter","isAttributeNameValid","valid","isAttributeValueValid","isAttributeValid","addToFilter","AlertVariant","clearActiveFilters","filtered","chip","createAttributeKeyInputField","KeycloakSelect","SelectVariant","selectedValue","option","SelectOption","label","e","TextInput","jsxs","Form","TextContent","Text","TextVariants","Alert","InputGroup","InputGroupItem","Button","CheckIcon","Checkbox","_","value","ActionGroup","ButtonVariant","UserDataTableToolbarItems","searchDropdownOpen","setSearchDropdownOpen","realm","hasSelectedRows","toggleDeleteDialog","toggleUnlockUsersDialog","goToCreate","setSearchType","searchUser","setSearchUser","refresh","clearAllFilters","kebabOpen","setKebabOpen","hasAccess","useAccess","isManager","searchItem","ToolbarItem","defaultSearchInput","attributeSearchInput","SearchInput","_v","attribute","target","Fragment","DropdownPanel","ArrowRightIcon","bruteForceProtectionToolbarItem","EllipsisVIcon","actionItems","UserDetailLink","user","useRealm","Link","toUser","StatusRow","Tooltip","WarningTriangleIcon","Label","InfoCircleIcon","ValidatedEmail","ExclamationCircleIcon","emptyFormatter","UserDataTable","adminClient","useAdminClient","addError","realmName","navigate","useNavigate","uiRealmInfo","setUiRealmInfo","selectedRows","setSelectedRows","setProfile","query","setQuery","key","setKey","useFetch","fetchRealmInfo","error","NetworkError","loader","first","max","search","params","searchParam","listUsers","findUsers","UnlockUsersConfirm","useConfirmDialog","DeleteConfirm","toAddUser","KeycloakSpinner","createQueryString","filters","attributes","FlexItem","entry","ChipGroup","event","active","Chip","toolbar","subtoolbar","KeycloakDataTable","rows","ListEmptyState","Toolbar","ToolbarContent","EmptyState","rowData","UsersSection","canViewPermissions","useIsFeatureEnabled","Feature","useTab","tab","useRoutableTab","toUsers","listTab","permissionsTab","ViewHeader","helpUrls","PageSection","RoutableTabs","Tab","TabTitleText","PermissionsTab"],"mappings":"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"}