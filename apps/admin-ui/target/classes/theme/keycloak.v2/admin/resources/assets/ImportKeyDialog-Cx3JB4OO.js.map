{"version":3,"file":"ImportKeyDialog-Cx3JB4OO.js","sources":["../../../../../../../src/clients/keys/StoreSettings.tsx","../../../../../../../src/clients/keys/ImportKeyDialog.tsx"],"sourcesContent":["import { useTranslation } from \"react-i18next\";\r\nimport { PasswordControl, TextControl } from \"@keycloak/keycloak-ui-shared\";\r\n\r\nexport const StoreSettings = ({\r\n  hidePassword = false,\r\n  isSaml = false,\r\n}: {\r\n  hidePassword?: boolean;\r\n  isSaml?: boolean;\r\n}) => {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <>\r\n      <TextControl\r\n        name=\"keyAlias\"\r\n        label={t(\"keyAlias\")}\r\n        labelIcon={t(\"keyAliasHelp\")}\r\n        rules={{\r\n          required: t(\"required\"),\r\n        }}\r\n      />\r\n      {!hidePassword && (\r\n        <PasswordControl\r\n          name=\"keyPassword\"\r\n          label={t(\"keyPassword\")}\r\n          labelIcon={t(\"keyPasswordHelp\")}\r\n          rules={{\r\n            required: t(\"required\"),\r\n          }}\r\n        />\r\n      )}\r\n      {isSaml && (\r\n        <TextControl\r\n          name=\"realmAlias\"\r\n          label={t(\"realmCertificateAlias\")}\r\n          labelIcon={t(\"realmCertificateAliasHelp\")}\r\n        />\r\n      )}\r\n      <PasswordControl\r\n        name=\"storePassword\"\r\n        label={t(\"storePassword\")}\r\n        labelIcon={t(\"storePasswordHelp\")}\r\n        rules={{\r\n          required: t(\"required\"),\r\n        }}\r\n      />\r\n    </>\r\n  );\r\n};\r\n","import { SelectControl, FileUploadControl } from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  Button,\r\n  ButtonVariant,\r\n  Form,\r\n  Modal,\r\n  ModalVariant,\r\n  Text,\r\n  TextContent,\r\n} from \"@patternfly/react-core\";\r\nimport { FormProvider, useForm, useWatch } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useServerInfo } from \"../../context/server-info/ServerInfoProvider\";\r\nimport { StoreSettings } from \"./StoreSettings\";\r\n\r\ntype ImportKeyDialogProps = {\r\n  toggleDialog: () => void;\r\n  save: (importFile: ImportFile) => void;\r\n  title?: string;\r\n  description?: string;\r\n};\r\n\r\nexport type ImportFile = {\r\n  keystoreFormat: string;\r\n  keyAlias: string;\r\n  storePassword: string;\r\n  file: File | string;\r\n};\r\n\r\nexport const ImportKeyDialog = ({\r\n  save,\r\n  toggleDialog,\r\n  title = \"generateKeys\",\r\n  description = \"generateKeysDescription\",\r\n}: ImportKeyDialogProps) => {\r\n  const { t } = useTranslation();\r\n  const form = useForm<ImportFile>();\r\n  const { control, handleSubmit } = form;\r\n\r\n  const baseFormats = useServerInfo().cryptoInfo?.supportedKeystoreTypes ?? [];\r\n\r\n  const formats = baseFormats.concat([\r\n    \"Certificate PEM\",\r\n    \"Public Key PEM\",\r\n    \"JSON Web Key Set\",\r\n  ]);\r\n\r\n  const format = useWatch({\r\n    control,\r\n    name: \"keystoreFormat\",\r\n    defaultValue: formats[0],\r\n  });\r\n\r\n  return (\r\n    <Modal\r\n      variant={ModalVariant.medium}\r\n      title={t(title)}\r\n      isOpen\r\n      onClose={toggleDialog}\r\n      actions={[\r\n        <Button\r\n          id=\"modal-confirm\"\r\n          data-testid=\"confirm\"\r\n          key=\"confirm\"\r\n          onClick={async () => {\r\n            await handleSubmit((importFile) => {\r\n              save(importFile);\r\n              toggleDialog();\r\n            })();\r\n          }}\r\n        >\r\n          {t(\"import\")}\r\n        </Button>,\r\n        <Button\r\n          id=\"modal-cancel\"\r\n          data-testid=\"cancel\"\r\n          key=\"cancel\"\r\n          variant={ButtonVariant.link}\r\n          onClick={toggleDialog}\r\n        >\r\n          {t(\"cancel\")}\r\n        </Button>,\r\n      ]}\r\n    >\r\n      <TextContent>\r\n        <Text>{t(description)}</Text>\r\n      </TextContent>\r\n      <Form className=\"pf-v5-u-pt-lg\">\r\n        <FormProvider {...form}>\r\n          <SelectControl\r\n            name=\"keystoreFormat\"\r\n            label={t(\"archiveFormat\")}\r\n            labelIcon={t(\"archiveFormatHelp\")}\r\n            controller={{\r\n              defaultValue: formats[0],\r\n            }}\r\n            options={formats}\r\n          />\r\n          <FileUploadControl\r\n            label={t(\"importFile\")}\r\n            id=\"importFile\"\r\n            name=\"file\"\r\n            rules={{\r\n              required: t(\"required\"),\r\n            }}\r\n          />\r\n          {baseFormats.includes(format) && <StoreSettings hidePassword />}\r\n        </FormProvider>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\n"],"names":["StoreSettings","hidePassword","isSaml","t","useTranslation","jsxs","Fragment","jsx","TextControl","PasswordControl","ImportKeyDialog","save","toggleDialog","title","description","form","useForm","control","handleSubmit","baseFormats","useServerInfo","formats","format","useWatch","Modal","ModalVariant","Button","importFile","ButtonVariant","TextContent","Text","Form","FormProvider","SelectControl","FileUploadControl"],"mappings":"kNAGO,MAAMA,EAAgB,CAAC,CAC5B,aAAAC,EAAe,GACf,OAAAC,EAAS,EACX,IAGM,CACJ,KAAM,CAAE,EAAAC,CAAA,EAAMC,EAAA,EAEd,OACEC,EAAAC,EAAA,CACE,SAAA,CAAAC,EAACC,EAAA,CACC,KAAK,WACL,MAAOL,EAAE,UAAU,EACnB,UAAWA,EAAE,cAAc,EAC3B,MAAO,CACL,SAAUA,EAAE,UAAU,CAAA,CACxB,CAAA,EAED,CAACF,GACAM,EAACE,EAAA,CACC,KAAK,cACL,MAAON,EAAE,aAAa,EACtB,UAAWA,EAAE,iBAAiB,EAC9B,MAAO,CACL,SAAUA,EAAE,UAAU,CAAA,CACxB,CAAA,EAGHD,GACCK,EAACC,EAAA,CACC,KAAK,aACL,MAAOL,EAAE,uBAAuB,EAChC,UAAWA,EAAE,2BAA2B,CAAA,CAAA,EAG5CI,EAACE,EAAA,CACC,KAAK,gBACL,MAAON,EAAE,eAAe,EACxB,UAAWA,EAAE,mBAAmB,EAChC,MAAO,CACL,SAAUA,EAAE,UAAU,CAAA,CACxB,CAAA,CACF,EACF,CAEJ,ECpBaO,EAAkB,CAAC,CAC9B,KAAAC,EACA,aAAAC,EACA,MAAAC,EAAQ,eACR,YAAAC,EAAc,yBAChB,IAA4B,CAC1B,KAAM,CAAE,EAAAX,CAAA,EAAMC,EAAA,EACRW,EAAOC,EAAA,EACP,CAAE,QAAAC,EAAS,aAAAC,CAAA,EAAiBH,EAE5BI,EAAcC,EAAA,EAAgB,YAAY,wBAA0B,CAAA,EAEpEC,EAAUF,EAAY,OAAO,CACjC,kBACA,iBACA,kBAAA,CACD,EAEKG,EAASC,EAAS,CACtB,QAAAN,EACA,KAAM,iBACN,aAAcI,EAAQ,CAAC,CAAA,CACxB,EAED,OACEhB,EAACmB,EAAA,CACC,QAASC,EAAa,OACtB,MAAOtB,EAAEU,CAAK,EACd,OAAM,GACN,QAASD,EACT,QAAS,CACPL,EAACmB,EAAA,CACC,GAAG,gBACH,cAAY,UAEZ,QAAS,SAAY,CACnB,MAAMR,EAAcS,GAAe,CACjChB,EAAKgB,CAAU,EACff,EAAA,CACF,CAAC,EAAA,CACH,EAEC,WAAE,QAAQ,CAAA,EARP,SAAA,EAUNL,EAACmB,EAAA,CACC,GAAG,eACH,cAAY,SAEZ,QAASE,EAAc,KACvB,QAAShB,EAER,WAAE,QAAQ,CAAA,EAJP,QAAA,CAKN,EAGF,SAAA,CAAAL,EAACsB,GACC,SAAAtB,EAACuB,EAAA,CAAM,SAAA3B,EAAEW,CAAW,EAAE,CAAA,CACxB,IACCiB,EAAA,CAAK,UAAU,gBACd,SAAA1B,EAAC2B,EAAA,CAAc,GAAGjB,EAChB,SAAA,CAAAR,EAAC0B,EAAA,CACC,KAAK,iBACL,MAAO9B,EAAE,eAAe,EACxB,UAAWA,EAAE,mBAAmB,EAChC,WAAY,CACV,aAAckB,EAAQ,CAAC,CAAA,EAEzB,QAASA,CAAA,CAAA,EAEXd,EAAC2B,EAAA,CACC,MAAO/B,EAAE,YAAY,EACrB,GAAG,aACH,KAAK,OACL,MAAO,CACL,SAAUA,EAAE,UAAU,CAAA,CACxB,CAAA,EAEDgB,EAAY,SAASG,CAAM,GAAKf,EAACP,EAAA,CAAc,aAAY,EAAA,CAAC,CAAA,CAAA,CAC/D,CAAA,CACF,CAAA,CAAA,CAAA,CAGN"}