{"version":3,"file":"SettingsCache-Cam5Obyz.js","sources":["../../../../../../../src/user-federation/shared/Header.tsx","../../../../../../../src/components/wizard-section-header/WizardSectionHeader.tsx","../../../../../../../src/user-federation/shared/SettingsCache.tsx"],"sourcesContent":["import {\r\n  AlertVariant,\r\n  ButtonVariant,\r\n  DropdownItem,\r\n} from \"@patternfly/react-core\";\r\nimport { ReactElement } from \"react\";\r\nimport { Controller, useFormContext } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useConfirmDialog } from \"../../components/confirm-dialog/ConfirmDialog\";\r\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport { CustomUserFederationRouteParams } from \"../routes/CustomUserFederation\";\r\nimport { toUserFederation } from \"../routes/UserFederation\";\r\n\r\ntype HeaderProps = {\r\n  provider: string;\r\n  save: () => void;\r\n  dropdownItems?: ReactElement[];\r\n  noDivider?: boolean;\r\n};\r\n\r\nexport const Header = ({\r\n  provider,\r\n  save,\r\n  noDivider = false,\r\n  dropdownItems = [],\r\n}: HeaderProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const { id } = useParams<Partial<CustomUserFederationRouteParams>>();\r\n  const navigate = useNavigate();\r\n\r\n  const { addAlert, addError } = useAlerts();\r\n  const { realm } = useRealm();\r\n\r\n  const { control, setValue } = useFormContext();\r\n\r\n  const [toggleDisableDialog, DisableConfirm] = useConfirmDialog({\r\n    titleKey: \"userFedDisableConfirmTitle\",\r\n    messageKey: \"userFedDisableConfirm\",\r\n    continueButtonLabel: \"disable\",\r\n    onConfirm: () => {\r\n      setValue(\"config.enabled[0]\", \"false\");\r\n      save();\r\n    },\r\n  });\r\n\r\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\r\n    titleKey: \"userFedDeleteConfirmTitle\",\r\n    messageKey: \"userFedDeleteConfirm\",\r\n    continueButtonLabel: \"delete\",\r\n    continueButtonVariant: ButtonVariant.danger,\r\n    onConfirm: async () => {\r\n      try {\r\n        await adminClient.components.del({ id: id! });\r\n        addAlert(t(\"userFedDeletedSuccess\"), AlertVariant.success);\r\n        navigate(toUserFederation({ realm }), { replace: true });\r\n      } catch (error) {\r\n        addError(\"userFedDeleteError\", error);\r\n      }\r\n    },\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <DisableConfirm />\r\n      <DeleteConfirm />\r\n      <Controller\r\n        name=\"config.enabled\"\r\n        defaultValue={[\"true\"]}\r\n        control={control}\r\n        render={({ field }) =>\r\n          !id ? (\r\n            <ViewHeader\r\n              titleKey={t(\"addProvider\", {\r\n                provider: provider,\r\n                count: 1,\r\n              })}\r\n            />\r\n          ) : (\r\n            <ViewHeader\r\n              divider={!noDivider}\r\n              titleKey={provider}\r\n              dropdownItems={[\r\n                ...dropdownItems,\r\n                <DropdownItem\r\n                  key=\"delete\"\r\n                  onClick={() => toggleDeleteDialog()}\r\n                  data-testid=\"delete-cmd\"\r\n                >\r\n                  {t(\"deleteProvider\")}\r\n                </DropdownItem>,\r\n              ]}\r\n              isEnabled={field.value?.[0] === \"true\" || field.value === \"true\"}\r\n              onToggle={(value) => {\r\n                if (!value) {\r\n                  toggleDisableDialog();\r\n                } else {\r\n                  field.onChange([value.toString()]);\r\n                  save();\r\n                }\r\n              }}\r\n            />\r\n          )\r\n        }\r\n      />\r\n    </>\r\n  );\r\n};\r\n","import { Text, TextContent, Title } from \"@patternfly/react-core\";\r\n\r\nimport \"./wizard-section-header.css\";\r\n\r\nexport type WizardSectionHeaderProps = {\r\n  title: string;\r\n  description?: string;\r\n  showDescription?: boolean;\r\n};\r\n\r\nexport const WizardSectionHeader = ({\r\n  title,\r\n  description,\r\n  showDescription = false,\r\n}: WizardSectionHeaderProps) => {\r\n  return (\r\n    <>\r\n      <Title\r\n        size={\"xl\"}\r\n        headingLevel={\"h2\"}\r\n        className={\r\n          showDescription\r\n            ? \"kc-wizard-section-header__title--has-description\"\r\n            : \"kc-wizard-section-header__title\"\r\n        }\r\n      >\r\n        {title}\r\n      </Title>\r\n      {showDescription && (\r\n        <TextContent className=\"kc-wizard-section-header__description\">\r\n          <Text>{description}</Text>\r\n        </TextContent>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n","import {\r\n  NumberControl,\r\n  SelectControl,\r\n  SelectControlOption,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport { isEqual } from \"lodash-es\";\r\nimport { UseFormReturn, useWatch } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { FormAccess } from \"../../components/form/FormAccess\";\r\nimport { WizardSectionHeader } from \"../../components/wizard-section-header/WizardSectionHeader\";\r\n\r\nexport type SettingsCacheProps = {\r\n  form: UseFormReturn;\r\n  showSectionHeading?: boolean;\r\n  showSectionDescription?: boolean;\r\n  unWrap?: boolean;\r\n};\r\n\r\nconst CacheFields = ({ form }: { form: UseFormReturn }) => {\r\n  const { t } = useTranslation();\r\n\r\n  const cachePolicyType = useWatch({\r\n    control: form.control,\r\n    name: \"config.cachePolicy\",\r\n  });\r\n\r\n  const hourOptions: SelectControlOption[] = [];\r\n  let hourDisplay = \"\";\r\n  for (let index = 0; index < 24; index++) {\r\n    if (index < 10) {\r\n      hourDisplay = `0${index}`;\r\n    } else {\r\n      hourDisplay = `${index}`;\r\n    }\r\n    hourOptions.push({ key: `${index}`, value: hourDisplay });\r\n  }\r\n\r\n  const minuteOptions: SelectControlOption[] = [];\r\n  let minuteDisplay = \"\";\r\n  for (let index = 0; index < 60; index++) {\r\n    if (index < 10) {\r\n      minuteDisplay = `0${index}`;\r\n    } else {\r\n      minuteDisplay = `${index}`;\r\n    }\r\n    minuteOptions.push({ key: `${index}`, value: minuteDisplay });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <SelectControl\r\n        id=\"kc-cache-policy\"\r\n        name=\"config.cachePolicy\"\r\n        label={t(\"cachePolicy\")}\r\n        labelIcon={t(\"cachePolicyHelp\")}\r\n        controller={{\r\n          defaultValue: [\"DEFAULT\"],\r\n        }}\r\n        aria-label={t(\"selectCacheType\")}\r\n        options={[\r\n          \"DEFAULT\",\r\n          \"EVICT_DAILY\",\r\n          \"EVICT_WEEKLY\",\r\n          \"MAX_LIFESPAN\",\r\n          \"NO_CACHE\",\r\n        ]}\r\n      />\r\n      {isEqual(cachePolicyType, [\"EVICT_WEEKLY\"]) ? (\r\n        <SelectControl\r\n          id=\"kc-eviction-day\"\r\n          name=\"config.evictionDay[0]\"\r\n          label={t(\"evictionDay\")}\r\n          labelIcon={t(\"evictionDayHelp\")}\r\n          controller={{\r\n            defaultValue: \"1\",\r\n          }}\r\n          aria-label={t(\"selectEvictionDay\")}\r\n          options={[\r\n            { key: \"1\", value: t(\"Sunday\") },\r\n            { key: \"2\", value: t(\"Monday\") },\r\n            { key: \"3\", value: t(\"Tuesday\") },\r\n            { key: \"4\", value: t(\"Wednesday\") },\r\n            { key: \"5\", value: t(\"Thursday\") },\r\n            { key: \"6\", value: t(\"Friday\") },\r\n            { key: \"7\", value: t(\"Saturday\") },\r\n          ]}\r\n        />\r\n      ) : null}\r\n      {isEqual(cachePolicyType, [\"EVICT_DAILY\"]) ||\r\n      isEqual(cachePolicyType, [\"EVICT_WEEKLY\"]) ? (\r\n        <>\r\n          <SelectControl\r\n            id=\"kc-eviction-hour\"\r\n            name=\"config.evictionHour\"\r\n            label={t(\"evictionHour\")}\r\n            labelIcon={t(\"evictionHourHelp\")}\r\n            controller={{\r\n              defaultValue: [\"0\"],\r\n            }}\r\n            aria-label={t(\"selectEvictionHour\")}\r\n            options={hourOptions}\r\n          />\r\n          <SelectControl\r\n            id=\"kc-eviction-minute\"\r\n            name=\"config.evictionMinute\"\r\n            label={t(\"evictionMinute\")}\r\n            labelIcon={t(\"evictionMinuteHelp\")}\r\n            controller={{\r\n              defaultValue: [\"0\"],\r\n            }}\r\n            aria-label={t(\"selectEvictionMinute\")}\r\n            options={minuteOptions}\r\n          />\r\n        </>\r\n      ) : null}\r\n      {isEqual(cachePolicyType, [\"MAX_LIFESPAN\"]) ? (\r\n        <NumberControl\r\n          data-testid=\"kerberos-cache-lifespan\"\r\n          name=\"config.maxLifespan[0]\"\r\n          label={t(\"maxLifespan\")}\r\n          labelIcon={t(\"maxLifespanHelp\")}\r\n          unit={t(\"ms\")}\r\n          controller={{ defaultValue: 0, rules: { min: 0 } }}\r\n        />\r\n      ) : null}\r\n    </>\r\n  );\r\n};\r\n\r\nexport const SettingsCache = ({\r\n  form,\r\n  showSectionHeading = false,\r\n  showSectionDescription = false,\r\n  unWrap = false,\r\n}: SettingsCacheProps) => {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <>\r\n      {showSectionHeading && (\r\n        <WizardSectionHeader\r\n          title={t(\"cacheSettings\")}\r\n          description={t(\"cacheSettingsDescription\")}\r\n          showDescription={showSectionDescription}\r\n        />\r\n      )}\r\n      {unWrap ? (\r\n        <CacheFields form={form} />\r\n      ) : (\r\n        <FormAccess role=\"manage-realm\" isHorizontal>\r\n          <CacheFields form={form} />\r\n        </FormAccess>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n"],"names":["Header","provider","save","noDivider","dropdownItems","adminClient","useAdminClient","t","useTranslation","id","useParams","navigate","useNavigate","addAlert","addError","useAlerts","realm","useRealm","control","setValue","useFormContext","toggleDisableDialog","DisableConfirm","useConfirmDialog","toggleDeleteDialog","DeleteConfirm","ButtonVariant","AlertVariant","toUserFederation","error","jsxs","Fragment","jsx","Controller","field","ViewHeader","DropdownItem","value","WizardSectionHeader","title","description","showDescription","Title","TextContent","Text","CacheFields","form","cachePolicyType","useWatch","hourOptions","hourDisplay","index","minuteOptions","minuteDisplay","SelectControl","isEqual","NumberControl","SettingsCache","showSectionHeading","showSectionDescription","unWrap","FormAccess"],"mappings":"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"}