import{jsxs as b,jsx as e,Fragment as T}from"react/jsx-runtime";import{u as v,a as C,_ as D,aS as R,P as E,O as x,S as P,W as O,aa as F,o as h,b as L,y as H,p as N,b1 as g,cb as w}from"./main-o1hptXRo.js";import{useState as I}from"react";import{M as V}from"./MapperList-Vu_yIY9K.js";import{u as j,R as k}from"./RoutableTabs-DyhWhd6v.js";import{V as G}from"./ViewHeader-BDBsroi3.js";import{u as K}from"./useParams-CGVhlaFZ.js";import{F as _}from"./FormAccess-BnhQnYb9.js";import{R as q}from"./RoleMapping-BOcI-Nkp.js";import{a as M,b as y}from"./Tabs-DSwQhKoJ.js";import"react-dom";import"./useLocaleSort-C-diWts5.js";import"./DataListItemRow-B_0B-ko6.js";import"./PageHandler-B1ed5nYb.js";import"./DynamicComponents-CnLlz98z.js";import"./ClientSelect-BY77LEpN.js";import"./IdentityProviderSelect-rmWlUbIg.js";import"./GroupPickerDialog-U3luvxlw.js";import"./ActionListItem-Cy-NQlq4.js";import"./MultiLineInput-OP0faqms.js";import"./CodeEditor-C4IS5oxi.js";import"./constants-BclHbWtx.js";import"./translationFormatter-DQJeO7lr.js";import"./ConfirmDialog-BkU7melV.js";const z=({client:p})=>{const{adminClient:l}=v(),{t:s}=C(),{addAlert:r,addError:m}=D(),[t,f]=I(p),{hasAccess:a}=R(),u=a("manage-clients")||t.access?.manage,S=async c=>{try{const n=c.filter(i=>i.client===void 0).map(i=>i.role).flat();await Promise.all([l.clients.addRealmScopeMappings({id:t.id},n),...c.filter(i=>i.client!==void 0).map(i=>l.clients.addClientScopeMappings({id:t.id,client:i.client.id},[i.role]))]),r(s("clientScopeSuccess"),h.success)}catch(n){m("clientScopeError",n)}},A=async()=>{const c={...t,fullScopeAllowed:!t.fullScopeAllowed};try{await l.clients.update({id:t.id},c),r(s("clientScopeSuccess"),h.success),f(c)}catch(n){m("clientScopeError",n)}};return b(E,{children:[e(_,{role:"manage-clients",fineGrainedAccess:t.access?.manage,isHorizontal:!0,children:e(x,{hasNoPaddingTop:!0,label:s("fullScopeAllowed"),labelIcon:e(O,{helpText:s("fullScopeAllowedHelp"),fieldLabelId:"fullScopeAllowed"}),fieldId:"fullScopeAllowed",children:e(P,{id:"fullScopeAllowed",label:s("on"),labelOff:s("off"),isChecked:t.fullScopeAllowed,onChange:A,"aria-label":s("fullScopeAllowed")})})}),!t.fullScopeAllowed&&b(T,{children:[e(F,{}),e(q,{name:t.clientId,id:t.id,type:"clients",save:S,isManager:u})]})]})};function Se(){const{adminClient:p}=v(),{t:l}=C(),s=L(),{realm:r,clientId:m}=K(),{addAlert:t,addError:f}=D(),[a,u]=I();H(()=>p.clients.findOne({id:m}),u,[]);const S=o=>j(g({realm:r,clientId:m,tab:o})),A=S("mappers"),c=S("scope");if(!a)return e(N,{});const n=async o=>{if(Array.isArray(o))try{await p.clients.addMultipleProtocolMappers({id:a.id},o),u(await p.clients.findOne({id:a.id})),t(l("mappingCreatedSuccess"),h.success)}catch(d){f("mappingCreatedError",d)}else{const d=o;s(w({realm:r,id:a.id,mapperId:d.id,viewMode:"new"}))}},i=async o=>{try{await p.clients.delProtocolMapper({id:a.id,mapperId:o.id}),u({...a,protocolMappers:a.protocolMappers?.filter(d=>d.id!==o.id)}),t(l("mappingDeletedSuccess"),h.success)}catch(d){f("mappingDeletedError",d)}return!0};return b(T,{children:[e(G,{titleKey:a.clientId+"-dedicated",subKey:"dedicatedScopeExplain",divider:!1}),e(E,{variant:"light",className:"pf-v5-u-p-0",children:b(k,{isBox:!0,mountOnEnter:!0,defaultLocation:g({realm:r,clientId:m,tab:"mappers"}),children:[e(M,{title:e(y,{children:l("mappers")}),"data-testid":"mappersTab",...A,children:e(V,{model:a,onAdd:n,onDelete:i,detailLink:o=>w({realm:r,id:a.id,mapperId:o,viewMode:"edit"})})}),e(M,{title:e(y,{children:l("scope")}),"data-testid":"scopeTab",...c,children:e(z,{client:a})})]})})]})}export{Se as default};
//# sourceMappingURL=DedicatedScopes-BBK4hG1F.js.map
