{"version":3,"file":"CreateFlow-Cw0t9GzN.js","sources":["../../../../../../../src/authentication/form/CreateFlow.tsx"],"sourcesContent":["import type AuthenticationFlowRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/authenticationFlowRepresentation\";\r\nimport {\r\n  ActionGroup,\r\n  AlertVariant,\r\n  Button,\r\n  PageSection,\r\n} from \"@patternfly/react-core\";\r\nimport { FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { FormSubmitButton, SelectControl } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport { FormAccess } from \"../../components/form/FormAccess\";\r\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport { toAuthentication } from \"../routes/Authentication\";\r\nimport { toFlow } from \"../routes/Flow\";\r\nimport { NameDescription } from \"./NameDescription\";\r\n\r\nconst TYPES = [\"basic-flow\", \"client-flow\"] as const;\r\n\r\nexport default function CreateFlow() {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const navigate = useNavigate();\r\n  const { realm } = useRealm();\r\n  const { addAlert } = useAlerts();\r\n  const form = useForm<AuthenticationFlowRepresentation>();\r\n  const { handleSubmit, formState } = form;\r\n\r\n  const onSubmit = async (formValues: AuthenticationFlowRepresentation) => {\r\n    const flow = { ...formValues, builtIn: false, topLevel: true };\r\n\r\n    try {\r\n      const { id } =\r\n        await adminClient.authenticationManagement.createFlow(flow);\r\n      addAlert(t(\"flowCreatedSuccess\"), AlertVariant.success);\r\n      navigate(\r\n        toFlow({\r\n          realm,\r\n          id: id!,\r\n          usedBy: \"notInUse\",\r\n        }),\r\n      );\r\n    } catch (error: any) {\r\n      addAlert(\r\n        t(\"flowCreateError\", {\r\n          error: error.response?.data?.errorMessage || error,\r\n        }),\r\n        AlertVariant.danger,\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <ViewHeader titleKey=\"createFlow\" subKey=\"authenticationCreateFlowHelp\" />\r\n      <PageSection variant=\"light\">\r\n        <FormProvider {...form}>\r\n          <FormAccess\r\n            isHorizontal\r\n            role=\"manage-authorization\"\r\n            onSubmit={handleSubmit(onSubmit)}\r\n          >\r\n            <NameDescription />\r\n            <SelectControl\r\n              name=\"providerId\"\r\n              label={t(\"flowType\")}\r\n              labelIcon={t(\"topLevelFlowTypeHelp\")}\r\n              aria-label={t(\"selectFlowType\")}\r\n              controller={{ defaultValue: TYPES[0] }}\r\n              options={TYPES.map((type) => ({\r\n                key: type,\r\n                value: t(`top-level-flow-type.${type}`),\r\n              }))}\r\n            />\r\n            <ActionGroup>\r\n              <FormSubmitButton\r\n                formState={formState}\r\n                data-testid=\"create\"\r\n                allowInvalid\r\n                allowNonDirty\r\n              >\r\n                {t(\"create\")}\r\n              </FormSubmitButton>\r\n              <Button\r\n                data-testid=\"cancel\"\r\n                variant=\"link\"\r\n                component={(props) => (\r\n                  <Link {...props} to={toAuthentication({ realm })}></Link>\r\n                )}\r\n              >\r\n                {t(\"cancel\")}\r\n              </Button>\r\n            </ActionGroup>\r\n          </FormAccess>\r\n        </FormProvider>\r\n      </PageSection>\r\n    </>\r\n  );\r\n}\r\n"],"names":["TYPES","CreateFlow","adminClient","useAdminClient","t","useTranslation","navigate","useNavigate","realm","useRealm","addAlert","useAlerts","form","useForm","handleSubmit","formState","jsxs","Fragment","jsx","ViewHeader","PageSection","FormProvider","FormAccess","formValues","flow","id","AlertVariant","toFlow","error","NameDescription","SelectControl","type","ActionGroup","FormSubmitButton","Button","props","Link","toAuthentication"],"mappings":"qXAoBA,MAAMA,EAAQ,CAAC,aAAc,aAAa,EAE1C,SAAwBC,GAAa,CACnC,KAAM,CAAE,YAAAC,CAAA,EAAgBC,EAAA,EAElB,CAAE,EAAAC,CAAA,EAAMC,EAAA,EACRC,EAAWC,EAAA,EACX,CAAE,MAAAC,CAAA,EAAUC,EAAA,EACZ,CAAE,SAAAC,CAAA,EAAaC,EAAA,EACfC,EAAOC,EAAA,EACP,CAAE,aAAAC,EAAc,UAAAC,CAAA,EAAcH,EA0BpC,OACEI,EAAAC,EAAA,CACE,SAAA,CAAAC,EAACC,EAAA,CAAW,SAAS,aAAa,OAAO,+BAA+B,IACvEC,EAAA,CAAY,QAAQ,QACnB,SAAAF,EAACG,EAAA,CAAc,GAAGT,EAChB,SAAAI,EAACM,EAAA,CACC,aAAY,GACZ,KAAK,uBACL,SAAUR,EAhCH,MAAOS,GAAiD,CACvE,MAAMC,EAAO,CAAE,GAAGD,EAAY,QAAS,GAAO,SAAU,EAAA,EAExD,GAAI,CACF,KAAM,CAAE,GAAAE,CAAA,EACN,MAAMvB,EAAY,yBAAyB,WAAWsB,CAAI,EAC5Dd,EAASN,EAAE,oBAAoB,EAAGsB,EAAa,OAAO,EACtDpB,EACEqB,EAAO,CACL,MAAAnB,EACA,GAAAiB,EACA,OAAQ,UAAA,CACT,CAAA,CAEL,OAASG,EAAY,CACnBlB,EACEN,EAAE,kBAAmB,CACnB,MAAOwB,EAAM,UAAU,MAAM,cAAgBA,CAAA,CAC9C,EACDF,EAAa,MAAA,CAEjB,CACF,CAUyC,EAE/B,SAAA,CAAAR,EAACW,EAAA,EAAgB,EACjBX,EAACY,EAAA,CACC,KAAK,aACL,MAAO1B,EAAE,UAAU,EACnB,UAAWA,EAAE,sBAAsB,EACnC,aAAYA,EAAE,gBAAgB,EAC9B,WAAY,CAAE,aAAcJ,EAAM,CAAC,CAAA,EACnC,QAASA,EAAM,IAAK+B,IAAU,CAC5B,IAAKA,EACL,MAAO3B,EAAE,uBAAuB2B,CAAI,EAAE,CAAA,EACtC,CAAA,CAAA,IAEHC,EAAA,CACC,SAAA,CAAAd,EAACe,EAAA,CACC,UAAAlB,EACA,cAAY,SACZ,aAAY,GACZ,cAAa,GAEZ,WAAE,QAAQ,CAAA,CAAA,EAEbG,EAACgB,EAAA,CACC,cAAY,SACZ,QAAQ,OACR,UAAYC,GACVjB,EAACkB,EAAA,CAAM,GAAGD,EAAO,GAAIE,EAAiB,CAAE,MAAA7B,CAAA,CAAO,CAAA,CAAG,EAGnD,WAAE,QAAQ,CAAA,CAAA,CACb,CAAA,CACF,CAAA,CAAA,CAAA,EAEJ,CAAA,CACF,CAAA,EACF,CAEJ"}