{"version":3,"file":"AuthenticationSection-C-T_5FuR.js","sources":["../../../../../../../src/authentication/components/RequiredActionConfigModal.tsx","../../../../../../../src/authentication/RequiredActions.tsx","../../../../../../../src/authentication/components/UsedBy.tsx","../../../../../../../src/authentication/policies/CibaPolicy.tsx","../../../../../../../src/authentication/policies/OtpPolicy.tsx","../../../../../../../src/authentication/policies/PolicyRow.tsx","../../../../../../../src/authentication/policies/util.ts","../../../../../../../src/authentication/policies/PasswordPolicy.tsx","../../../../../../../src/authentication/policies/WebauthnPolicy.tsx","../../../../../../../src/authentication/policies/Policies.tsx","../../../../../../../src/authentication/AuthenticationSection.tsx"],"sourcesContent":["import RequiredActionConfigInfoRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/requiredActionConfigInfoRepresentation\";\r\nimport RequiredActionConfigRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/requiredActionConfigRepresentation\";\r\nimport type RequiredActionProviderRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/requiredActionProviderRepresentation\";\r\nimport {\r\n  isUserProfileError,\r\n  setUserProfileServerError,\r\n  useAlerts,\r\n  useFetch,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  ActionGroup,\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  Form,\r\n  Modal,\r\n  ModalVariant,\r\n} from \"@patternfly/react-core\";\r\nimport { TrashIcon } from \"@patternfly/react-icons\";\r\nimport { useState } from \"react\";\r\nimport { FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { DynamicComponents } from \"../../components/dynamic/DynamicComponents\";\r\nimport { convertFormValuesToObject, convertToFormValues } from \"../../util\";\r\n\r\ntype RequiredActionConfigModalForm = {\r\n  // alias: string;\r\n  config: { [index: string]: string };\r\n};\r\n\r\ntype RequiredActionConfigModalProps = {\r\n  requiredAction: RequiredActionProviderRepresentation;\r\n  onClose: () => void;\r\n};\r\n\r\nexport const RequiredActionConfigModal = ({\r\n  requiredAction,\r\n  onClose,\r\n}: RequiredActionConfigModalProps) => {\r\n  const { adminClient } = useAdminClient();\r\n  const { t } = useTranslation();\r\n  const { addAlert, addError } = useAlerts();\r\n\r\n  const [configDescription, setConfigDescription] =\r\n    useState<RequiredActionConfigInfoRepresentation>();\r\n\r\n  const form = useForm<RequiredActionConfigModalForm>();\r\n  const { setValue, handleSubmit } = form;\r\n\r\n  // // default config all required actions should have\r\n  // const defaultConfigProperties = [];\r\n\r\n  const setupForm = (config?: RequiredActionConfigRepresentation) => {\r\n    convertToFormValues(config || {}, setValue);\r\n  };\r\n\r\n  useFetch(\r\n    async () => {\r\n      const configDescription =\r\n        await adminClient.authenticationManagement.getRequiredActionConfigDescription(\r\n          {\r\n            alias: requiredAction.alias!,\r\n          },\r\n        );\r\n\r\n      const config =\r\n        await adminClient.authenticationManagement.getRequiredActionConfig({\r\n          alias: requiredAction.alias!,\r\n        });\r\n\r\n      // merge default and fetched config properties\r\n      configDescription.properties = [\r\n        //...defaultConfigProperties!,\r\n        ...configDescription.properties!,\r\n      ];\r\n\r\n      return { configDescription, config };\r\n    },\r\n    ({ configDescription, config }) => {\r\n      setConfigDescription(configDescription);\r\n      setupForm(config);\r\n    },\r\n    [],\r\n  );\r\n\r\n  const save = async (saved: RequiredActionConfigModalForm) => {\r\n    const newConfig = convertFormValuesToObject(saved);\r\n    try {\r\n      await adminClient.authenticationManagement.updateRequiredActionConfig(\r\n        { alias: requiredAction.alias! },\r\n        newConfig,\r\n      );\r\n      setupForm(newConfig);\r\n      addAlert(t(\"configSaveSuccess\"), AlertVariant.success);\r\n      onClose();\r\n    } catch (error) {\r\n      if (isUserProfileError(error)) {\r\n        setUserProfileServerError(\r\n          error,\r\n          (name: string | number, error: unknown) => {\r\n            // TODO: Does not set set the error message to the field, yet.\r\n            // Still, this will do all front end replacement and translation of keys.\r\n            addError(\"configSaveError\", (error as any).message);\r\n          },\r\n          t,\r\n        );\r\n      } else {\r\n        addError(\"configSaveError\", error);\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      variant={ModalVariant.small}\r\n      isOpen\r\n      title={t(\"requiredActionConfig\", { name: requiredAction.name })}\r\n      onClose={onClose}\r\n    >\r\n      <Form id=\"required-action-config-form\" onSubmit={handleSubmit(save)}>\r\n        <FormProvider {...form}>\r\n          <DynamicComponents\r\n            stringify\r\n            properties={configDescription?.properties || []}\r\n          />\r\n        </FormProvider>\r\n        <ActionGroup>\r\n          <Button data-testid=\"save\" variant=\"primary\" type=\"submit\">\r\n            {t(\"save\")}\r\n          </Button>\r\n          <Button\r\n            data-testid=\"cancel\"\r\n            variant={ButtonVariant.link}\r\n            onClick={onClose}\r\n          >\r\n            {t(\"cancel\")}\r\n          </Button>\r\n          <Button\r\n            className=\"pf-v5-u-ml-3xl\"\r\n            data-testid=\"clear\"\r\n            variant={ButtonVariant.link}\r\n            onClick={async () => {\r\n              await adminClient.authenticationManagement.removeRequiredActionConfig(\r\n                {\r\n                  alias: requiredAction.alias!,\r\n                },\r\n              );\r\n              form.reset({});\r\n              onClose();\r\n            }}\r\n          >\r\n            {t(\"clear\")} <TrashIcon />\r\n          </Button>\r\n        </ActionGroup>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\n","import { fetchWithError } from \"@keycloak/keycloak-admin-client\";\r\nimport type RequiredActionProviderRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/requiredActionProviderRepresentation\";\r\nimport type RequiredActionProviderSimpleRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/requiredActionProviderSimpleRepresentation\";\r\nimport { useAlerts, useFetch } from \"@keycloak/keycloak-ui-shared\";\r\nimport { AlertVariant, Button, Switch } from \"@patternfly/react-core\";\r\nimport { CogIcon } from \"@patternfly/react-icons\";\r\nimport { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport { KeycloakSpinner } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport { addTrailingSlash, toKey } from \"../util\";\r\nimport { getAuthorizationHeaders } from \"../utils/getAuthorizationHeaders\";\r\nimport { DraggableTable } from \"./components/DraggableTable\";\r\nimport { RequiredActionConfigModal } from \"./components/RequiredActionConfigModal\";\r\n\r\ntype DataType = RequiredActionProviderRepresentation &\r\n  RequiredActionProviderSimpleRepresentation & {\r\n    configurable?: boolean;\r\n  };\r\n\r\ntype Row = {\r\n  name?: string;\r\n  enabled: boolean;\r\n  defaultAction: boolean;\r\n  data: DataType;\r\n};\r\n\r\nexport const RequiredActions = () => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const { addAlert, addError } = useAlerts();\r\n\r\n  const [actions, setActions] = useState<Row[]>();\r\n  const [selectedAction, setSelectedAction] = useState<DataType>();\r\n  const [key, setKey] = useState(0);\r\n  const refresh = () => setKey(key + 1);\r\n  const { realm: realmName } = useRealm();\r\n\r\n  const loadActions = async (): Promise<\r\n    RequiredActionProviderRepresentation[]\r\n  > => {\r\n    const requiredActionsRequest = await fetchWithError(\r\n      `${addTrailingSlash(\r\n        adminClient.baseUrl,\r\n      )}admin/realms/${realmName}/ui-ext/authentication-management/required-actions`,\r\n      {\r\n        method: \"GET\",\r\n        headers: getAuthorizationHeaders(await adminClient.getAccessToken()),\r\n      },\r\n    );\r\n\r\n    return (await requiredActionsRequest.json()) as DataType[];\r\n  };\r\n\r\n  useFetch(\r\n    async () => {\r\n      const [requiredActions, unregisteredRequiredActions] = await Promise.all([\r\n        loadActions(),\r\n        adminClient.authenticationManagement.getUnregisteredRequiredActions(),\r\n      ]);\r\n      return [\r\n        ...requiredActions.map((action) => ({\r\n          name: action.name!,\r\n          enabled: action.enabled!,\r\n          defaultAction: action.defaultAction!,\r\n          data: action,\r\n        })),\r\n        ...unregisteredRequiredActions.map((action) => ({\r\n          name: action.name!,\r\n          enabled: false,\r\n          defaultAction: false,\r\n          data: action,\r\n        })),\r\n      ];\r\n    },\r\n    (actions) => setActions(actions),\r\n    [key],\r\n  );\r\n\r\n  const isUnregisteredAction = (data: DataType): boolean => {\r\n    return !(\"alias\" in data);\r\n  };\r\n\r\n  const updateAction = async (\r\n    action: DataType,\r\n    field: \"enabled\" | \"defaultAction\",\r\n  ) => {\r\n    try {\r\n      if (field in action) {\r\n        action[field] = !action[field];\r\n        // remove configurable property from action which only exists for the admin ui\r\n        delete action.configurable;\r\n        await adminClient.authenticationManagement.updateRequiredAction(\r\n          { alias: action.alias! },\r\n          action,\r\n        );\r\n      } else if (isUnregisteredAction(action)) {\r\n        await adminClient.authenticationManagement.registerRequiredAction({\r\n          name: action.name,\r\n          providerId: action.providerId,\r\n        });\r\n      }\r\n      refresh();\r\n      addAlert(t(\"updatedRequiredActionSuccess\"), AlertVariant.success);\r\n    } catch (error) {\r\n      addError(\"updatedRequiredActionError\", error);\r\n    }\r\n  };\r\n\r\n  const executeMove = async (\r\n    action: RequiredActionProviderRepresentation,\r\n    times: number,\r\n  ) => {\r\n    try {\r\n      const alias = action.alias!;\r\n      for (let index = 0; index < Math.abs(times); index++) {\r\n        if (times > 0) {\r\n          await adminClient.authenticationManagement.lowerRequiredActionPriority(\r\n            {\r\n              alias,\r\n            },\r\n          );\r\n        } else {\r\n          await adminClient.authenticationManagement.raiseRequiredActionPriority(\r\n            {\r\n              alias,\r\n            },\r\n          );\r\n        }\r\n      }\r\n      refresh();\r\n\r\n      addAlert(t(\"updatedRequiredActionSuccess\"), AlertVariant.success);\r\n    } catch (error) {\r\n      addError(\"updatedRequiredActionError\", error);\r\n    }\r\n  };\r\n\r\n  if (!actions) {\r\n    return <KeycloakSpinner />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      {selectedAction && (\r\n        <RequiredActionConfigModal\r\n          requiredAction={selectedAction}\r\n          onClose={() => setSelectedAction(undefined)}\r\n        />\r\n      )}\r\n      <DraggableTable\r\n        keyField=\"name\"\r\n        onDragFinish={async (nameDragged, items) => {\r\n          const keys = actions.map((e) => e.name);\r\n          const newIndex = items.indexOf(nameDragged);\r\n          const oldIndex = keys.indexOf(nameDragged);\r\n          const dragged = actions[oldIndex].data;\r\n          if (!dragged.alias) return;\r\n\r\n          const times = newIndex - oldIndex;\r\n          await executeMove(dragged, times);\r\n        }}\r\n        columns={[\r\n          {\r\n            name: \"name\",\r\n            displayKey: \"action\",\r\n            width: 50,\r\n          },\r\n          {\r\n            name: \"enabled\",\r\n            displayKey: \"enabled\",\r\n            cellRenderer: (row) => (\r\n              <Switch\r\n                id={`enable-${toKey(row.name || \"\")}`}\r\n                label={t(\"on\")}\r\n                labelOff={t(\"off\")}\r\n                isChecked={row.enabled}\r\n                onChange={async () => {\r\n                  await updateAction(row.data, \"enabled\");\r\n                }}\r\n                aria-label={row.name}\r\n              />\r\n            ),\r\n            width: 20,\r\n          },\r\n          {\r\n            name: \"default\",\r\n            displayKey: \"setAsDefaultAction\",\r\n            thTooltipText: \"authDefaultActionTooltip\",\r\n            cellRenderer: (row) => (\r\n              <Switch\r\n                id={`default-${toKey(row.name || \"\")}`}\r\n                label={t(\"on\")}\r\n                isDisabled={!row.enabled}\r\n                labelOff={!row.enabled ? t(\"disabledOff\") : t(\"off\")}\r\n                isChecked={row.defaultAction}\r\n                onChange={async () => {\r\n                  await updateAction(row.data, \"defaultAction\");\r\n                }}\r\n                aria-label={row.name}\r\n              />\r\n            ),\r\n            width: 20,\r\n          },\r\n          {\r\n            name: \"config\",\r\n            displayKey: \"configure\",\r\n            cellRenderer: (row) =>\r\n              row.data.configurable ? (\r\n                <Button\r\n                  variant=\"plain\"\r\n                  aria-label={t(\"settings\")}\r\n                  onClick={() => setSelectedAction(row.data)}\r\n                >\r\n                  <CogIcon />\r\n                </Button>\r\n              ) : undefined,\r\n            width: 10,\r\n          },\r\n        ]}\r\n        data={actions}\r\n      />\r\n    </>\r\n  );\r\n};\r\n","import { KeycloakDataTable } from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  Button,\r\n  Modal,\r\n  ModalVariant,\r\n  Popover,\r\n  Text,\r\n  TextContent,\r\n  TextVariants,\r\n} from \"@patternfly/react-core\";\r\nimport { CheckCircleIcon } from \"@patternfly/react-icons\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { fetchUsedBy } from \"../../components/role-mapping/resource\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport useToggle from \"../../utils/useToggle\";\r\nimport { AuthenticationType, REALM_FLOWS } from \"../constants\";\r\n\r\nimport style from \"./used-by.module.css\";\r\n\r\ntype UsedByProps = {\r\n  authType: AuthenticationType;\r\n};\r\n\r\nconst Label = ({ label }: { label: string }) => (\r\n  <>\r\n    <CheckCircleIcon className={style.label} /> {label}\r\n  </>\r\n);\r\n\r\ntype UsedByModalProps = {\r\n  id: string;\r\n  onClose: () => void;\r\n  isSpecificClient: boolean;\r\n};\r\n\r\nconst UsedByModal = ({ id, isSpecificClient, onClose }: UsedByModalProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n\r\n  const loader = async (\r\n    first?: number,\r\n    max?: number,\r\n    search?: string,\r\n  ): Promise<{ name: string }[]> => {\r\n    const result = await fetchUsedBy(adminClient, {\r\n      id,\r\n      type: isSpecificClient ? \"clients\" : \"idp\",\r\n      first: first || 0,\r\n      max: max || 10,\r\n      search,\r\n    });\r\n    return result.map((p) => ({ name: p }));\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      header={\r\n        <TextContent>\r\n          <Text component={TextVariants.h1}>{t(\"flowUsedBy\")}</Text>\r\n          <Text>\r\n            {t(\"flowUsedByDescription\", {\r\n              value: isSpecificClient ? t(\"clients\") : t(\"identiyProviders\"),\r\n            })}\r\n          </Text>\r\n        </TextContent>\r\n      }\r\n      variant={ModalVariant.medium}\r\n      isOpen\r\n      onClose={onClose}\r\n      actions={[\r\n        <Button\r\n          data-testid=\"cancel\"\r\n          id=\"modal-cancel\"\r\n          key=\"cancel\"\r\n          onClick={onClose}\r\n        >\r\n          {t(\"close\")}\r\n        </Button>,\r\n      ]}\r\n    >\r\n      <KeycloakDataTable\r\n        loader={loader}\r\n        isPaginated\r\n        ariaLabelKey=\"usedBy\"\r\n        searchPlaceholderKey=\"search\"\r\n        columns={[\r\n          {\r\n            name: \"name\",\r\n          },\r\n        ]}\r\n      />\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport const UsedBy = ({ authType: { id, usedBy } }: UsedByProps) => {\r\n  const { t } = useTranslation();\r\n  const { realmRepresentation: realm } = useRealm();\r\n  const [open, toggle] = useToggle();\r\n\r\n  const key = Object.entries(realm!).find(\r\n    (e) => e[1] === usedBy?.values[0],\r\n  )?.[0];\r\n\r\n  return (\r\n    <>\r\n      {open && (\r\n        <UsedByModal\r\n          id={id!}\r\n          onClose={toggle}\r\n          isSpecificClient={usedBy?.type === \"SPECIFIC_CLIENTS\"}\r\n        />\r\n      )}\r\n      {(usedBy?.type === \"SPECIFIC_PROVIDERS\" ||\r\n        usedBy?.type === \"SPECIFIC_CLIENTS\") &&\r\n        (usedBy.values.length <= 8 ? (\r\n          <Popover\r\n            key={id}\r\n            aria-label={t(\"usedBy\")}\r\n            bodyContent={\r\n              <div key={`usedBy-${id}-${usedBy.values}`}>\r\n                {t(\r\n                  \"appliedBy\" +\r\n                    (usedBy.type === \"SPECIFIC_CLIENTS\"\r\n                      ? \"Clients\"\r\n                      : \"Providers\"),\r\n                )}{\" \"}\r\n                {usedBy.values.map((used, index) => (\r\n                  <>\r\n                    <strong>{used}</strong>\r\n                    {index < usedBy.values.length - 1 ? \", \" : \"\"}\r\n                  </>\r\n                ))}\r\n              </div>\r\n            }\r\n          >\r\n            <Button variant=\"link\" className={style.label}>\r\n              <Label label={t(`used.${usedBy.type}`)} />\r\n            </Button>\r\n          </Popover>\r\n        ) : (\r\n          <Button variant=\"link\" className={style.label} onClick={toggle}>\r\n            <Label label={t(`used.${usedBy.type}`)} />\r\n          </Button>\r\n        ))}\r\n      {usedBy?.type === \"DEFAULT\" && (\r\n        <Label label={t(`flow.${REALM_FLOWS.get(key!)}`)} />\r\n      )}\r\n      {!usedBy?.type && t(\"used.notInUse\")}\r\n    </>\r\n  );\r\n};\r\n","import type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\r\nimport {\r\n  ActionGroup,\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  PageSection,\r\n} from \"@patternfly/react-core\";\r\nimport { useEffect } from \"react\";\r\nimport { FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { SelectControl, TextControl } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport { FormAccess } from \"../../components/form/FormAccess\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport { convertFormValuesToObject, convertToFormValues } from \"../../util\";\r\n\r\nconst CIBA_BACKHANNEL_TOKEN_DELIVERY_MODES = [\"poll\", \"ping\"] as const;\r\nconst CIBA_EXPIRES_IN_MIN = 10;\r\nconst CIBA_EXPIRES_IN_MAX = 600;\r\nconst CIBA_INTERVAL_MIN = 0;\r\nconst CIBA_INTERVAL_MAX = 600;\r\n\r\ntype CibaPolicyProps = {\r\n  realm: RealmRepresentation;\r\n  realmUpdated: (realm: RealmRepresentation) => void;\r\n};\r\n\r\ntype FormFields = Omit<\r\n  RealmRepresentation,\r\n  \"clients\" | \"components\" | \"groups\"\r\n>;\r\n\r\nexport const CibaPolicy = ({ realm, realmUpdated }: CibaPolicyProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const form = useForm<FormFields>({ mode: \"onChange\" });\r\n  const { realm: realmName } = useRealm();\r\n  const { addAlert, addError } = useAlerts();\r\n\r\n  const setupForm = (realm: RealmRepresentation) =>\r\n    convertToFormValues(realm, form.setValue);\r\n\r\n  useEffect(() => setupForm(realm), []);\r\n\r\n  const onSubmit = async (formValues: FormFields) => {\r\n    try {\r\n      await adminClient.realms.update(\r\n        { realm: realmName },\r\n        convertFormValuesToObject(formValues),\r\n      );\r\n\r\n      const updatedRealm = await adminClient.realms.findOne({\r\n        realm: realmName,\r\n      });\r\n\r\n      realmUpdated(updatedRealm!);\r\n      setupForm(updatedRealm!);\r\n      addAlert(t(\"updateCibaSuccess\"), AlertVariant.success);\r\n    } catch (error) {\r\n      addError(\"updateCibaError\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <PageSection variant=\"light\">\r\n      <FormAccess\r\n        role=\"manage-realm\"\r\n        isHorizontal\r\n        onSubmit={form.handleSubmit(onSubmit)}\r\n      >\r\n        <FormProvider {...form}>\r\n          <SelectControl\r\n            name=\"attributes.cibaBackchannelTokenDeliveryMode\"\r\n            label={t(\"cibaBackchannelTokenDeliveryMode\")}\r\n            labelIcon={t(\"cibaBackchannelTokenDeliveryModeHelp\")}\r\n            options={CIBA_BACKHANNEL_TOKEN_DELIVERY_MODES.map((mode) => ({\r\n              key: mode,\r\n              value: t(`cibaBackhannelTokenDeliveryModes.${mode}`),\r\n            }))}\r\n            controller={{ defaultValue: \"\" }}\r\n          />\r\n          <TextControl\r\n            name=\"attributes.cibaExpiresIn\"\r\n            type=\"number\"\r\n            min={CIBA_EXPIRES_IN_MIN}\r\n            max={CIBA_EXPIRES_IN_MAX}\r\n            label={t(\"cibaExpiresIn\")}\r\n            labelIcon={t(\"cibaExpiresInHelp\")}\r\n            rules={{\r\n              min: {\r\n                value: CIBA_EXPIRES_IN_MIN,\r\n                message: t(\"greaterThan\", {\r\n                  value: CIBA_EXPIRES_IN_MIN,\r\n                }),\r\n              },\r\n              max: {\r\n                value: CIBA_EXPIRES_IN_MAX,\r\n                message: t(\"lessThan\", { value: CIBA_EXPIRES_IN_MAX }),\r\n              },\r\n              required: t(\"required\"),\r\n            }}\r\n          />\r\n          <TextControl\r\n            name=\"attributes.cibaInterval\"\r\n            type=\"number\"\r\n            min={CIBA_EXPIRES_IN_MIN}\r\n            max={CIBA_EXPIRES_IN_MAX}\r\n            label={t(\"cibaInterval\")}\r\n            labelIcon={t(\"cibaIntervalHelp\")}\r\n            rules={{\r\n              min: {\r\n                value: CIBA_INTERVAL_MIN,\r\n                message: t(\"greaterThan\", {\r\n                  value: CIBA_INTERVAL_MIN,\r\n                }),\r\n              },\r\n              max: {\r\n                value: CIBA_INTERVAL_MAX,\r\n                message: t(\"lessThan\", { value: CIBA_INTERVAL_MAX }),\r\n              },\r\n              required: t(\"required\"),\r\n            }}\r\n          />\r\n          <SelectControl\r\n            name=\"attributes.cibaAuthRequestedUserHint\"\r\n            label={t(\"cibaAuthRequestedUserHint\")}\r\n            labelIcon={t(\"cibaAuthRequestedUserHintHelp\")}\r\n            options={[\"login_hint\", \"id_token_hint\", \"login_hint_token\"]}\r\n            controller={{ defaultValue: \"\" }}\r\n            isDisabled\r\n          />\r\n        </FormProvider>\r\n        <ActionGroup>\r\n          <Button\r\n            data-testid=\"save\"\r\n            variant=\"primary\"\r\n            type=\"submit\"\r\n            isDisabled={!form.formState.isValid || !form.formState.isDirty}\r\n          >\r\n            {t(\"save\")}\r\n          </Button>\r\n          <Button\r\n            data-testid=\"reload\"\r\n            variant={ButtonVariant.link}\r\n            onClick={() => setupForm({ ...realm })}\r\n          >\r\n            {t(\"reload\")}\r\n          </Button>\r\n        </ActionGroup>\r\n      </FormAccess>\r\n    </PageSection>\r\n  );\r\n};\r\n","import type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\r\nimport {\r\n  HelpItem,\r\n  NumberControl,\r\n  SelectControl,\r\n  SwitchControl,\r\n  useAlerts,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  ActionGroup,\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  Chip,\r\n  ChipGroup,\r\n  FormGroup,\r\n  PageSection,\r\n  Radio,\r\n} from \"@patternfly/react-core\";\r\nimport { useMemo } from \"react\";\r\nimport { Controller, FormProvider, useForm, useWatch } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { FormAccess } from \"../../components/form/FormAccess\";\r\nimport { TimeSelectorControl } from \"../../components/time-selector/TimeSelectorControl\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport useLocaleSort from \"../../utils/useLocaleSort\";\r\n\r\nimport \"./otp-policy.css\";\r\n\r\nconst POLICY_TYPES = [\"totp\", \"hotp\"] as const;\r\nconst OTP_HASH_ALGORITHMS = [\"SHA1\", \"SHA256\", \"SHA512\"] as const;\r\nconst NUMBER_OF_DIGITS = [6, 8] as const;\r\n\r\ntype OtpPolicyProps = {\r\n  realm: RealmRepresentation;\r\n  realmUpdated: (realm: RealmRepresentation) => void;\r\n};\r\n\r\ntype FormFields = Omit<\r\n  RealmRepresentation,\r\n  \"clients\" | \"components\" | \"groups\" | \"users\" | \"federatedUsers\"\r\n>;\r\n\r\nexport const OtpPolicy = ({ realm, realmUpdated }: OtpPolicyProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const form = useForm<FormFields>({\r\n    mode: \"onChange\",\r\n    defaultValues: {\r\n      otpPolicyType: realm.otpPolicyType ?? POLICY_TYPES[0],\r\n      otpPolicyAlgorithm:\r\n        realm.otpPolicyAlgorithm ?? `Hmac${OTP_HASH_ALGORITHMS[0]}`,\r\n      otpPolicyDigits: realm.otpPolicyDigits ?? NUMBER_OF_DIGITS[0],\r\n      otpPolicyLookAheadWindow: realm.otpPolicyLookAheadWindow ?? 1,\r\n      otpPolicyPeriod: realm.otpPolicyPeriod ?? 30,\r\n      otpPolicyInitialCounter: realm.otpPolicyInitialCounter ?? 30,\r\n      otpPolicyCodeReusable: realm.otpPolicyCodeReusable ?? false,\r\n    },\r\n  });\r\n  const {\r\n    control,\r\n    reset,\r\n    handleSubmit,\r\n    formState: { isValid, isDirty },\r\n  } = form;\r\n  const { realm: realmName } = useRealm();\r\n  const { addAlert, addError } = useAlerts();\r\n  const localeSort = useLocaleSort();\r\n\r\n  const otpType = useWatch({ name: \"otpPolicyType\", control });\r\n\r\n  const setupForm = (formValues: FormFields) => reset(formValues);\r\n\r\n  const supportedApplications = useMemo(() => {\r\n    const labels = (realm.otpSupportedApplications ?? []).map((key) =>\r\n      t(`otpSupportedApplications.${key}`),\r\n    );\r\n\r\n    return localeSort(labels, (label) => label);\r\n  }, [realm.otpSupportedApplications]);\r\n\r\n  const onSubmit = async (formValues: FormFields) => {\r\n    try {\r\n      await adminClient.realms.update({ realm: realmName }, formValues);\r\n      const updatedRealm = await adminClient.realms.findOne({\r\n        realm: realmName,\r\n      });\r\n      realmUpdated(updatedRealm!);\r\n      setupForm(updatedRealm!);\r\n      addAlert(t(\"updateOtpSuccess\"), AlertVariant.success);\r\n    } catch (error) {\r\n      addError(\"updateOtpError\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <PageSection variant=\"light\">\r\n      <FormAccess\r\n        role=\"manage-realm\"\r\n        isHorizontal\r\n        onSubmit={handleSubmit(onSubmit)}\r\n        className=\"keycloak__otp_policies_authentication__form\"\r\n      >\r\n        <FormProvider {...form}>\r\n          <FormGroup\r\n            label={t(\"otpType\")}\r\n            labelIcon={\r\n              <HelpItem helpText={t(\"otpTypeHelp\")} fieldLabelId=\"otpType\" />\r\n            }\r\n            hasNoPaddingTop\r\n          >\r\n            <Controller\r\n              name=\"otpPolicyType\"\r\n              data-testid=\"otpPolicyType\"\r\n              defaultValue={POLICY_TYPES[0]}\r\n              control={control}\r\n              render={({ field: { value, onChange } }) => (\r\n                <>\r\n                  {POLICY_TYPES.map((type) => (\r\n                    <Radio\r\n                      key={type}\r\n                      id={type}\r\n                      data-testid={type}\r\n                      isChecked={value === type}\r\n                      name=\"otpPolicyType\"\r\n                      onChange={() => onChange(type)}\r\n                      label={t(`policyType.${type}`)}\r\n                      className=\"keycloak__otp_policies_authentication__policy-type\"\r\n                    />\r\n                  ))}\r\n                </>\r\n              )}\r\n            />\r\n          </FormGroup>\r\n          <SelectControl\r\n            name=\"otpPolicyAlgorithm\"\r\n            label={t(\"otpHashAlgorithm\")}\r\n            labelIcon={t(\"otpHashAlgorithmHelp\")}\r\n            options={OTP_HASH_ALGORITHMS.map((type) => ({\r\n              key: `Hmac${type}`,\r\n              value: type,\r\n            }))}\r\n            controller={{ defaultValue: `Hmac${OTP_HASH_ALGORITHMS[0]}` }}\r\n          />\r\n          <FormGroup\r\n            label={t(\"otpPolicyDigits\")}\r\n            labelIcon={\r\n              <HelpItem\r\n                helpText={t(\"otpPolicyDigitsHelp\")}\r\n                fieldLabelId=\"otpPolicyDigits\"\r\n              />\r\n            }\r\n            hasNoPaddingTop\r\n          >\r\n            <Controller\r\n              name=\"otpPolicyDigits\"\r\n              data-testid=\"otpPolicyDigits\"\r\n              defaultValue={NUMBER_OF_DIGITS[0]}\r\n              control={control}\r\n              render={({ field }) => (\r\n                <>\r\n                  {NUMBER_OF_DIGITS.map((type) => (\r\n                    <Radio\r\n                      key={type}\r\n                      id={`digit-${type}`}\r\n                      data-testid={`digit-${type}`}\r\n                      isChecked={field.value === type}\r\n                      name=\"otpPolicyDigits\"\r\n                      onChange={() => field.onChange(type)}\r\n                      label={type}\r\n                      className=\"keycloak__otp_policies_authentication__number-of-digits\"\r\n                    />\r\n                  ))}\r\n                </>\r\n              )}\r\n            />\r\n          </FormGroup>\r\n          <NumberControl\r\n            name=\"otpPolicyLookAheadWindow\"\r\n            label={t(\"lookAround\")}\r\n            labelIcon={t(\"lookAroundHelp\")}\r\n            controller={{ defaultValue: 1, rules: { min: 0 } }}\r\n          />\r\n          {otpType === POLICY_TYPES[0] && (\r\n            <TimeSelectorControl\r\n              name=\"otpPolicyPeriod\"\r\n              label={t(\"otpPolicyPeriod\")}\r\n              labelIcon={t(\"otpPolicyPeriodHelp\")}\r\n              units={[\"second\", \"minute\"]}\r\n              controller={{\r\n                defaultValue: 30,\r\n                rules: {\r\n                  min: 1,\r\n                  max: {\r\n                    value: 120,\r\n                    message: t(\"maxLength\", { length: \"2 \" + t(\"minutes\") }),\r\n                  },\r\n                },\r\n              }}\r\n            />\r\n          )}\r\n          {otpType === POLICY_TYPES[1] && (\r\n            <NumberControl\r\n              name=\"otpPolicyInitialCounter\"\r\n              label={t(\"initialCounter\")}\r\n              labelIcon={t(\"initialCounterHelp\")}\r\n              controller={{ defaultValue: 30, rules: { min: 1, max: 120 } }}\r\n            />\r\n          )}\r\n          <FormGroup\r\n            label={t(\"supportedApplications\")}\r\n            labelIcon={\r\n              <HelpItem\r\n                helpText={t(\"supportedApplicationsHelp\")}\r\n                fieldLabelId=\"supportedApplications\"\r\n              />\r\n            }\r\n          >\r\n            <span data-testid=\"supportedApplications\">\r\n              <ChipGroup>\r\n                {supportedApplications.map((label) => (\r\n                  <Chip key={label} isReadOnly>\r\n                    {label}\r\n                  </Chip>\r\n                ))}\r\n              </ChipGroup>\r\n            </span>\r\n          </FormGroup>\r\n\r\n          {otpType === POLICY_TYPES[0] && (\r\n            <SwitchControl\r\n              name=\"otpPolicyCodeReusable\"\r\n              label={t(\"otpPolicyCodeReusable\")}\r\n              labelIcon={t(\"otpPolicyCodeReusableHelp\")}\r\n              labelOn={t(\"on\")}\r\n              labelOff={t(\"off\")}\r\n            />\r\n          )}\r\n\r\n          <ActionGroup>\r\n            <Button\r\n              data-testid=\"save\"\r\n              variant=\"primary\"\r\n              type=\"submit\"\r\n              isDisabled={!isValid || !isDirty}\r\n            >\r\n              {t(\"save\")}\r\n            </Button>\r\n            <Button\r\n              data-testid=\"reload\"\r\n              variant={ButtonVariant.link}\r\n              onClick={() => reset({ ...realm })}\r\n            >\r\n              {t(\"reload\")}\r\n            </Button>\r\n          </ActionGroup>\r\n        </FormProvider>\r\n      </FormAccess>\r\n    </PageSection>\r\n  );\r\n};\r\n","import type PasswordPolicyTypeRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/passwordPolicyTypeRepresentation\";\r\nimport {\r\n  Button,\r\n  FormGroup,\r\n  NumberInput,\r\n  Split,\r\n  SplitItem,\r\n  Switch,\r\n  TextInput,\r\n  ValidatedOptions,\r\n} from \"@patternfly/react-core\";\r\nimport { MinusCircleIcon } from \"@patternfly/react-icons\";\r\nimport { Controller, useFormContext } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { FormErrorText, HelpItem } from \"@keycloak/keycloak-ui-shared\";\r\n\r\nimport \"./policy-row.css\";\r\n\r\ntype PolicyRowProps = {\r\n  policy: PasswordPolicyTypeRepresentation;\r\n  onRemove: (id?: string) => void;\r\n};\r\n\r\nexport const PolicyRow = ({\r\n  policy: { id, configType, defaultValue, displayName },\r\n  onRemove,\r\n}: PolicyRowProps) => {\r\n  const { t } = useTranslation();\r\n  const {\r\n    control,\r\n    register,\r\n    formState: { errors },\r\n  } = useFormContext();\r\n\r\n  const error = errors[id!];\r\n\r\n  return (\r\n    <FormGroup\r\n      label={displayName}\r\n      fieldId={id!}\r\n      isRequired\r\n      labelIcon={\r\n        <HelpItem\r\n          helpText={t(`passwordPoliciesHelp.${id}`)}\r\n          fieldLabelId={id!}\r\n        />\r\n      }\r\n    >\r\n      <Split>\r\n        <SplitItem isFilled>\r\n          {configType && configType !== \"int\" && (\r\n            <TextInput\r\n              id={id}\r\n              data-testid={id}\r\n              {...register(id!, { required: true })}\r\n              defaultValue={defaultValue}\r\n              validated={\r\n                error ? ValidatedOptions.error : ValidatedOptions.default\r\n              }\r\n            />\r\n          )}\r\n          {configType === \"int\" && (\r\n            <Controller\r\n              name={id!}\r\n              defaultValue={Number.parseInt(defaultValue || \"0\")}\r\n              control={control}\r\n              render={({ field }) => {\r\n                const MIN_VALUE = 0;\r\n                const setValue = (newValue: number) =>\r\n                  field.onChange(Math.max(newValue, MIN_VALUE));\r\n                const value = Number(field.value);\r\n\r\n                return (\r\n                  <NumberInput\r\n                    id={id}\r\n                    value={value}\r\n                    min={MIN_VALUE}\r\n                    onPlus={() => setValue(value + 1)}\r\n                    onMinus={() => setValue(value - 1)}\r\n                    onChange={(event) => {\r\n                      const newValue = Number(event.currentTarget.value);\r\n                      setValue(!isNaN(newValue) ? newValue : 0);\r\n                    }}\r\n                    className=\"keycloak__policies_authentication__number-field\"\r\n                  />\r\n                );\r\n              }}\r\n            />\r\n          )}\r\n          {!configType && (\r\n            <Switch\r\n              id={id!}\r\n              label={t(\"on\")}\r\n              labelOff={t(\"off\")}\r\n              isChecked\r\n              isDisabled\r\n              aria-label={displayName}\r\n            />\r\n          )}\r\n        </SplitItem>\r\n        <SplitItem>\r\n          <Button\r\n            data-testid={`remove-${id}`}\r\n            variant=\"link\"\r\n            className=\"keycloak__policies_authentication__minus-icon\"\r\n            onClick={() => onRemove(id)}\r\n            aria-label={t(\"remove\")}\r\n          >\r\n            <MinusCircleIcon />\r\n          </Button>\r\n        </SplitItem>\r\n      </Split>\r\n      {error && <FormErrorText message={t(\"required\")} />}\r\n    </FormGroup>\r\n  );\r\n};\r\n","import type PasswordPolicyTypeRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/passwordPolicyTypeRepresentation\";\r\n\r\nexport type SubmittedValues = {\r\n  [index: string]: string;\r\n};\r\n\r\nconst POLICY_SEPARATOR = \" and \";\r\n\r\nexport const serializePolicy = (\r\n  policies: PasswordPolicyTypeRepresentation[],\r\n  submitted: SubmittedValues,\r\n) =>\r\n  policies\r\n    .map((policy) => `${policy.id}(${submitted[policy.id!]})`)\r\n    .join(POLICY_SEPARATOR);\r\n\r\ntype PolicyValue = PasswordPolicyTypeRepresentation & {\r\n  value?: string;\r\n};\r\n\r\nexport const parsePolicy = (\r\n  value: string,\r\n  policies: PasswordPolicyTypeRepresentation[],\r\n) =>\r\n  value\r\n    .split(POLICY_SEPARATOR)\r\n    .map(parsePolicyToken)\r\n    .reduce<PolicyValue[]>((result, { id, value }) => {\r\n      const matchingPolicy = policies.find((policy) => policy.id === id);\r\n\r\n      if (!matchingPolicy) {\r\n        return result;\r\n      }\r\n\r\n      return result.concat({ ...matchingPolicy, value });\r\n    }, []);\r\n\r\ntype PolicyTokenParsed = {\r\n  id: string;\r\n  value?: string;\r\n};\r\n\r\nfunction parsePolicyToken(token: string): PolicyTokenParsed {\r\n  const valueStart = token.indexOf(\"(\");\r\n\r\n  if (valueStart === -1) {\r\n    return { id: token.trim() };\r\n  }\r\n\r\n  const id = token.substring(0, valueStart).trim();\r\n  const valueEnd = token.lastIndexOf(\")\");\r\n\r\n  if (valueEnd === -1) {\r\n    return { id };\r\n  }\r\n\r\n  const value = token.substring(valueStart + 1, valueEnd).trim();\r\n\r\n  return { id, value };\r\n}\r\n","import type PasswordPolicyTypeRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/passwordPolicyTypeRepresentation\";\r\nimport type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\r\nimport {\r\n  ActionGroup,\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  Divider,\r\n  EmptyState,\r\n  EmptyStateActions,\r\n  EmptyStateBody,\r\n  EmptyStateFooter,\r\n  EmptyStateHeader,\r\n  EmptyStateIcon,\r\n  PageSection,\r\n  Toolbar,\r\n  ToolbarContent,\r\n  ToolbarItem,\r\n  Select,\r\n  MenuToggle,\r\n  SelectList,\r\n  SelectOption,\r\n} from \"@patternfly/react-core\";\r\nimport { PlusCircleIcon } from \"@patternfly/react-icons\";\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport { FormAccess } from \"../../components/form/FormAccess\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport { useServerInfo } from \"../../context/server-info/ServerInfoProvider\";\r\nimport { PolicyRow } from \"./PolicyRow\";\r\nimport { SubmittedValues, parsePolicy, serializePolicy } from \"./util\";\r\n\r\ntype PolicySelectProps = {\r\n  onSelect: (row: PasswordPolicyTypeRepresentation) => void;\r\n  selectedPolicies: PasswordPolicyTypeRepresentation[];\r\n};\r\n\r\nconst PolicySelect = ({ onSelect, selectedPolicies }: PolicySelectProps) => {\r\n  const { t } = useTranslation();\r\n  const { passwordPolicies } = useServerInfo();\r\n  const [open, setOpen] = useState(false);\r\n\r\n  const policies = useMemo(\r\n    () =>\r\n      passwordPolicies?.filter(\r\n        (p) => selectedPolicies.find((o) => o.id === p.id) === undefined,\r\n      ),\r\n    [selectedPolicies],\r\n  );\r\n\r\n  return (\r\n    <Select\r\n      onSelect={(_, selection) => {\r\n        onSelect(selection as PasswordPolicyTypeRepresentation);\r\n        setOpen(false);\r\n      }}\r\n      toggle={(ref) => (\r\n        <MenuToggle\r\n          ref={ref}\r\n          onClick={() => setOpen(!open)}\r\n          isExpanded={open}\r\n          isDisabled={policies?.length === 0}\r\n          style={{ width: \"300px\" }}\r\n          data-testid=\"add-policy\"\r\n        >\r\n          {t(\"addPolicy\")}\r\n        </MenuToggle>\r\n      )}\r\n      isOpen={open}\r\n    >\r\n      <SelectList>\r\n        {policies?.map((policy) => (\r\n          <SelectOption key={policy.id} value={policy}>\r\n            {policy.displayName}\r\n          </SelectOption>\r\n        ))}\r\n      </SelectList>\r\n    </Select>\r\n  );\r\n};\r\n\r\ntype PasswordPolicyProps = {\r\n  realm: RealmRepresentation;\r\n  realmUpdated: (realm: RealmRepresentation) => void;\r\n};\r\n\r\nexport const PasswordPolicy = ({\r\n  realm,\r\n  realmUpdated,\r\n}: PasswordPolicyProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const { passwordPolicies } = useServerInfo();\r\n\r\n  const { addAlert, addError } = useAlerts();\r\n  const { realm: realmName, refresh } = useRealm();\r\n\r\n  const [rows, setRows] = useState<PasswordPolicyTypeRepresentation[]>([]);\r\n  const onSelect = (row: PasswordPolicyTypeRepresentation) => {\r\n    setRows([...rows, row]);\r\n    setValue(row.id!, row.defaultValue!, { shouldDirty: true });\r\n  };\r\n\r\n  const form = useForm<SubmittedValues>({\r\n    defaultValues: {},\r\n  });\r\n  const {\r\n    handleSubmit,\r\n    setValue,\r\n    reset,\r\n    formState: { isDirty },\r\n  } = form;\r\n\r\n  const setupForm = (realm: RealmRepresentation) => {\r\n    reset();\r\n    const values = parsePolicy(realm.passwordPolicy || \"\", passwordPolicies!);\r\n    values.forEach((v) => {\r\n      setValue(v.id!, v.value!);\r\n    });\r\n    setRows(values);\r\n  };\r\n\r\n  useEffect(() => setupForm(realm), []);\r\n\r\n  const save = async (values: SubmittedValues) => {\r\n    const updatedRealm = {\r\n      ...realm,\r\n      passwordPolicy: serializePolicy(rows, values),\r\n    };\r\n    try {\r\n      await adminClient.realms.update({ realm: realmName }, updatedRealm);\r\n      realmUpdated(updatedRealm);\r\n      setupForm(updatedRealm);\r\n      refresh();\r\n      addAlert(t(\"updatePasswordPolicySuccess\"), AlertVariant.success);\r\n    } catch (error: any) {\r\n      addError(\"updatePasswordPolicyError\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <PageSection variant=\"light\" className=\"pf-v5-u-p-0\">\r\n      {(rows.length !== 0 || realm.passwordPolicy) && (\r\n        <>\r\n          <Toolbar>\r\n            <ToolbarContent>\r\n              <ToolbarItem>\r\n                <PolicySelect onSelect={onSelect} selectedPolicies={rows} />\r\n              </ToolbarItem>\r\n            </ToolbarContent>\r\n          </Toolbar>\r\n          <Divider />\r\n          <PageSection variant=\"light\">\r\n            <FormProvider {...form}>\r\n              <FormAccess\r\n                className=\"keycloak__policies_authentication__form\"\r\n                role=\"manage-realm\"\r\n                isHorizontal\r\n                onSubmit={handleSubmit(save)}\r\n              >\r\n                {rows.map((r, index) => (\r\n                  <PolicyRow\r\n                    key={`${r.id}-${index}`}\r\n                    policy={r}\r\n                    onRemove={(id) => {\r\n                      setRows(rows.filter((r) => r.id !== id));\r\n                      setValue(r.id!, \"\", { shouldDirty: true });\r\n                    }}\r\n                  />\r\n                ))}\r\n                <ActionGroup>\r\n                  <Button\r\n                    data-testid=\"save\"\r\n                    variant=\"primary\"\r\n                    type=\"submit\"\r\n                    isDisabled={!isDirty}\r\n                  >\r\n                    {t(\"save\")}\r\n                  </Button>\r\n                  <Button\r\n                    data-testid=\"reload\"\r\n                    variant={ButtonVariant.link}\r\n                    onClick={() => setupForm(realm)}\r\n                  >\r\n                    {t(\"reload\")}\r\n                  </Button>\r\n                </ActionGroup>\r\n              </FormAccess>\r\n            </FormProvider>\r\n          </PageSection>\r\n        </>\r\n      )}\r\n      {!rows.length && !realm.passwordPolicy && (\r\n        <EmptyState data-testid=\"empty-state\" variant=\"lg\">\r\n          <EmptyStateHeader\r\n            titleText={<>{t(\"noPasswordPolicies\")}</>}\r\n            icon={<EmptyStateIcon icon={PlusCircleIcon} />}\r\n            headingLevel=\"h1\"\r\n          />\r\n          <EmptyStateBody>{t(\"noPasswordPoliciesInstructions\")}</EmptyStateBody>\r\n          <EmptyStateFooter>\r\n            <EmptyStateActions>\r\n              <PolicySelect onSelect={onSelect} selectedPolicies={[]} />\r\n            </EmptyStateActions>\r\n          </EmptyStateFooter>\r\n        </EmptyState>\r\n      )}\r\n    </PageSection>\r\n  );\r\n};\r\n","import type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\r\nimport {\r\n  ActionGroup,\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  FormGroup,\r\n  PageSection,\r\n  Popover,\r\n  Text,\r\n  TextContent,\r\n} from \"@patternfly/react-core\";\r\nimport { QuestionCircleIcon } from \"@patternfly/react-icons\";\r\nimport { useEffect } from \"react\";\r\nimport { FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport {\r\n  HelpItem,\r\n  SelectControl,\r\n  SwitchControl,\r\n  TextControl,\r\n  useHelp,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport { FormAccess } from \"../../components/form/FormAccess\";\r\nimport { MultiLineInput } from \"../../components/multi-line-input/MultiLineInput\";\r\nimport { TimeSelectorControl } from \"../../components/time-selector/TimeSelectorControl\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport { convertFormValuesToObject, convertToFormValues } from \"../../util\";\r\nimport useIsFeatureEnabled, { Feature } from \"../../utils/useIsFeatureEnabled\";\r\n\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport \"./webauthn-policy.css\";\r\n\r\nconst SIGNATURE_ALGORITHMS = [\r\n  \"ES256\",\r\n  \"ES384\",\r\n  \"ES512\",\r\n  \"RS256\",\r\n  \"RS384\",\r\n  \"RS512\",\r\n  \"Ed25519\",\r\n  \"RS1\",\r\n] as const;\r\nconst ATTESTATION_PREFERENCE = [\r\n  \"not specified\",\r\n  \"none\",\r\n  \"indirect\",\r\n  \"direct\",\r\n] as const;\r\n\r\nconst AUTHENTICATOR_ATTACHMENT = [\r\n  \"not specified\",\r\n  \"platform\",\r\n  \"cross-platform\",\r\n] as const;\r\n\r\nconst RESIDENT_KEY_OPTIONS = [\"not specified\", \"Yes\", \"No\"] as const;\r\n\r\nconst USER_VERIFY = [\r\n  \"not specified\",\r\n  \"required\",\r\n  \"preferred\",\r\n  \"discouraged\",\r\n] as const;\r\n\r\ntype WeauthnSelectProps = {\r\n  name: string;\r\n  label: string;\r\n  labelIcon?: string;\r\n  options: readonly string[];\r\n  labelPrefix?: string;\r\n  isMultiSelect?: boolean;\r\n};\r\n\r\nconst WebauthnSelect = ({\r\n  name,\r\n  label,\r\n  labelIcon,\r\n  options,\r\n  labelPrefix,\r\n  isMultiSelect = false,\r\n}: WeauthnSelectProps) => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <SelectControl\r\n      name={name}\r\n      label={label}\r\n      labelIcon={labelIcon}\r\n      variant={isMultiSelect ? \"typeaheadMulti\" : \"single\"}\r\n      controller={{ defaultValue: options[0] }}\r\n      options={options.map((option) => ({\r\n        key: option,\r\n        value: labelPrefix ? t(`${labelPrefix}.${option}`) : option,\r\n      }))}\r\n    />\r\n  );\r\n};\r\n\r\ntype WebauthnPolicyProps = {\r\n  realm: RealmRepresentation;\r\n  realmUpdated: (realm: RealmRepresentation) => void;\r\n  isPasswordLess?: boolean;\r\n};\r\n\r\nexport const WebauthnPolicy = ({\r\n  realm,\r\n  realmUpdated,\r\n  isPasswordLess = false,\r\n}: WebauthnPolicyProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const { addAlert, addError } = useAlerts();\r\n  const { realm: realmName } = useRealm();\r\n  const { enabled } = useHelp();\r\n  const form = useForm({ mode: \"onChange\" });\r\n  const {\r\n    setValue,\r\n    handleSubmit,\r\n    formState: { isDirty },\r\n  } = form;\r\n\r\n  const namePrefix = isPasswordLess\r\n    ? \"webAuthnPolicyPasswordless\"\r\n    : \"webAuthnPolicy\";\r\n\r\n  const setupForm = (realm: RealmRepresentation) =>\r\n    convertToFormValues(realm, setValue);\r\n\r\n  useEffect(() => setupForm(realm), []);\r\n\r\n  const onSubmit = async (realm: RealmRepresentation) => {\r\n    const submittedRealm = convertFormValuesToObject(realm);\r\n    try {\r\n      await adminClient.realms.update({ realm: realmName }, submittedRealm);\r\n      realmUpdated(submittedRealm);\r\n      setupForm(submittedRealm);\r\n      addAlert(t(\"webAuthnUpdateSuccess\"), AlertVariant.success);\r\n    } catch (error) {\r\n      addError(\"webAuthnUpdateError\", error);\r\n    }\r\n  };\r\n\r\n  const isFeatureEnabled = useIsFeatureEnabled();\r\n\r\n  return (\r\n    <PageSection variant=\"light\">\r\n      {enabled && (\r\n        <Popover bodyContent={t(`${namePrefix}FormHelp`)}>\r\n          <TextContent className=\"keycloak__section_intro__help\">\r\n            <Text>\r\n              <QuestionCircleIcon /> {t(\"webauthnIntro\")}\r\n            </Text>\r\n          </TextContent>\r\n        </Popover>\r\n      )}\r\n\r\n      <FormAccess\r\n        role=\"manage-realm\"\r\n        isHorizontal\r\n        onSubmit={handleSubmit(onSubmit)}\r\n        className=\"keycloak__webauthn_policies_authentication__form\"\r\n      >\r\n        <FormProvider {...form}>\r\n          <TextControl\r\n            name={`${namePrefix}RpEntityName`}\r\n            label={t(\"webAuthnPolicyRpEntityName\")}\r\n            labelIcon={t(\"webAuthnPolicyRpEntityNameHelp\")}\r\n            rules={{ required: t(\"required\") }}\r\n          />\r\n          <WebauthnSelect\r\n            name={`${namePrefix}SignatureAlgorithms`}\r\n            label={t(\"webAuthnPolicySignatureAlgorithms\")}\r\n            labelIcon={t(\"webAuthnPolicySignatureAlgorithmsHelp\")}\r\n            options={SIGNATURE_ALGORITHMS}\r\n            isMultiSelect\r\n          />\r\n          <TextControl\r\n            name={`${namePrefix}RpId`}\r\n            label={t(\"webAuthnPolicyRpId\")}\r\n            labelIcon={t(\"webAuthnPolicyRpIdHelp\")}\r\n          />\r\n          <WebauthnSelect\r\n            name={`${namePrefix}AttestationConveyancePreference`}\r\n            label={t(\"webAuthnPolicyAttestationConveyancePreference\")}\r\n            labelIcon={t(\"webAuthnPolicyAttestationConveyancePreferenceHelp\")}\r\n            options={ATTESTATION_PREFERENCE}\r\n            labelPrefix=\"attestationPreference\"\r\n          />\r\n          <WebauthnSelect\r\n            name={`${namePrefix}AuthenticatorAttachment`}\r\n            label={t(\"webAuthnPolicyAuthenticatorAttachment\")}\r\n            labelIcon={t(\"webAuthnPolicyAuthenticatorAttachmentHelp\")}\r\n            options={AUTHENTICATOR_ATTACHMENT}\r\n            labelPrefix=\"authenticatorAttachment\"\r\n          />\r\n          <WebauthnSelect\r\n            name={`${namePrefix}RequireResidentKey`}\r\n            label={t(\"webAuthnPolicyRequireResidentKey\")}\r\n            labelIcon={t(\"webAuthnPolicyRequireResidentKeyHelp\")}\r\n            options={RESIDENT_KEY_OPTIONS}\r\n            labelPrefix=\"residentKey\"\r\n          />\r\n          <WebauthnSelect\r\n            name={`${namePrefix}UserVerificationRequirement`}\r\n            label={t(\"webAuthnPolicyUserVerificationRequirement\")}\r\n            labelIcon={t(\"webAuthnPolicyUserVerificationRequirementHelp\")}\r\n            options={USER_VERIFY}\r\n            labelPrefix=\"userVerify\"\r\n          />\r\n          <TimeSelectorControl\r\n            name={`${namePrefix}CreateTimeout`}\r\n            label={t(\"webAuthnPolicyCreateTimeout\")}\r\n            labelIcon={t(\"webAuthnPolicyCreateTimeoutHelp\")}\r\n            units={[\"second\", \"minute\", \"hour\"]}\r\n            controller={{\r\n              defaultValue: 0,\r\n              rules: {\r\n                min: 0,\r\n                max: {\r\n                  value: 31536,\r\n                  message: t(\"webAuthnPolicyCreateTimeoutHint\"),\r\n                },\r\n              },\r\n            }}\r\n          />\r\n          <SwitchControl\r\n            name={`${namePrefix}AvoidSameAuthenticatorRegister`}\r\n            label={t(\"webAuthnPolicyAvoidSameAuthenticatorRegister\")}\r\n            labelIcon={t(\"webAuthnPolicyAvoidSameAuthenticatorRegisterHelp\")}\r\n            labelOn={t(\"on\")}\r\n            labelOff={t(\"off\")}\r\n          />\r\n          <FormGroup\r\n            label={t(\"webAuthnPolicyAcceptableAaguids\")}\r\n            fieldId=\"webAuthnPolicyAcceptableAaguids\"\r\n            labelIcon={\r\n              <HelpItem\r\n                helpText={t(\"webAuthnPolicyAcceptableAaguidsHelp\")}\r\n                fieldLabelId=\"webAuthnPolicyAcceptableAaguids\"\r\n              />\r\n            }\r\n          >\r\n            <MultiLineInput\r\n              name={`${namePrefix}AcceptableAaguids`}\r\n              aria-label={t(\"webAuthnPolicyAcceptableAaguids\")}\r\n              addButtonLabel=\"addAaguids\"\r\n            />\r\n          </FormGroup>\r\n          <FormGroup\r\n            label={t(\"webAuthnPolicyExtraOrigins\")}\r\n            fieldId=\"webAuthnPolicyExtraOrigins\"\r\n            labelIcon={\r\n              <HelpItem\r\n                helpText={t(\"webAuthnPolicyExtraOriginsHelp\")}\r\n                fieldLabelId=\"webAuthnPolicyExtraOrigins\"\r\n              />\r\n            }\r\n          >\r\n            <MultiLineInput\r\n              name={`${namePrefix}ExtraOrigins`}\r\n              aria-label={t(\"webAuthnPolicyExtraOrigins\")}\r\n              addButtonLabel=\"addOrigins\"\r\n            />\r\n          </FormGroup>\r\n          {isPasswordLess && isFeatureEnabled(Feature.Passkeys) && (\r\n            <SwitchControl\r\n              name={`${namePrefix}PasskeysEnabled`}\r\n              label={t(\"webAuthnPolicyPasskeysEnabled\")}\r\n              labelIcon={t(\"webAuthnPolicyPasskeysEnabledHelp\")}\r\n              labelOn={t(\"on\")}\r\n              labelOff={t(\"off\")}\r\n            />\r\n          )}\r\n        </FormProvider>\r\n\r\n        <ActionGroup>\r\n          <Button\r\n            data-testid=\"save\"\r\n            variant=\"primary\"\r\n            type=\"submit\"\r\n            isDisabled={!isDirty}\r\n          >\r\n            {t(\"save\")}\r\n          </Button>\r\n          <Button\r\n            data-testid=\"reload\"\r\n            variant={ButtonVariant.link}\r\n            onClick={() => setupForm(realm)}\r\n          >\r\n            {t(\"reload\")}\r\n          </Button>\r\n        </ActionGroup>\r\n      </FormAccess>\r\n    </PageSection>\r\n  );\r\n};\r\n","import { Tab, Tabs, TabTitleText } from \"@patternfly/react-core\";\r\nimport { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { KeycloakSpinner } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport { CibaPolicy } from \"./CibaPolicy\";\r\nimport { OtpPolicy } from \"./OtpPolicy\";\r\nimport { PasswordPolicy } from \"./PasswordPolicy\";\r\nimport { WebauthnPolicy } from \"./WebauthnPolicy\";\r\n\r\nexport const Policies = () => {\r\n  const { t } = useTranslation();\r\n  const [subTab, setSubTab] = useState(1);\r\n  const { realmRepresentation: realm, refresh } = useRealm();\r\n\r\n  if (!realm) {\r\n    return <KeycloakSpinner />;\r\n  }\r\n\r\n  return (\r\n    <Tabs\r\n      activeKey={subTab}\r\n      onSelect={(_, key) => setSubTab(key as number)}\r\n      mountOnEnter\r\n      unmountOnExit\r\n    >\r\n      <Tab\r\n        id=\"passwordPolicy\"\r\n        data-testid=\"passwordPolicy\"\r\n        eventKey={1}\r\n        title={<TabTitleText>{t(\"passwordPolicy\")}</TabTitleText>}\r\n      >\r\n        <PasswordPolicy realm={realm} realmUpdated={refresh} />\r\n      </Tab>\r\n      <Tab\r\n        id=\"otpPolicy\"\r\n        data-testid=\"otpPolicy\"\r\n        eventKey={2}\r\n        title={<TabTitleText>{t(\"otpPolicy\")}</TabTitleText>}\r\n      >\r\n        <OtpPolicy realm={realm} realmUpdated={refresh} />\r\n      </Tab>\r\n      <Tab\r\n        id=\"webauthnPolicy\"\r\n        data-testid=\"webauthnPolicy\"\r\n        eventKey={3}\r\n        title={<TabTitleText>{t(\"webauthnPolicy\")}</TabTitleText>}\r\n      >\r\n        <WebauthnPolicy realm={realm} realmUpdated={refresh} />\r\n      </Tab>\r\n      <Tab\r\n        id=\"webauthnPasswordlessPolicy\"\r\n        data-testid=\"webauthnPasswordlessPolicy\"\r\n        eventKey={4}\r\n        title={<TabTitleText>{t(\"webauthnPasswordlessPolicy\")}</TabTitleText>}\r\n      >\r\n        <WebauthnPolicy realm={realm} realmUpdated={refresh} isPasswordLess />\r\n      </Tab>\r\n      <Tab\r\n        data-testid=\"tab-ciba-policy\"\r\n        eventKey={5}\r\n        title={<TabTitleText>{t(\"cibaPolicy\")}</TabTitleText>}\r\n      >\r\n        <CibaPolicy realm={realm} realmUpdated={refresh} />\r\n      </Tab>\r\n    </Tabs>\r\n  );\r\n};\r\n","import { fetchWithError } from \"@keycloak/keycloak-admin-client\";\r\nimport {\r\n  KeycloakDataTable,\r\n  KeycloakSpinner,\r\n  ListEmptyState,\r\n  useAlerts,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  Label,\r\n  PageSection,\r\n  Tab,\r\n  TabTitleText,\r\n  ToolbarItem,\r\n} from \"@patternfly/react-core\";\r\nimport { sortBy } from \"lodash-es\";\r\nimport { useState } from \"react\";\r\nimport { Trans, useTranslation } from \"react-i18next\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport { useConfirmDialog } from \"../components/confirm-dialog/ConfirmDialog\";\r\nimport {\r\n  RoutableTabs,\r\n  useRoutableTab,\r\n} from \"../components/routable-tabs/RoutableTabs\";\r\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport helpUrls from \"../help-urls\";\r\nimport { addTrailingSlash } from \"../util\";\r\nimport { getAuthorizationHeaders } from \"../utils/getAuthorizationHeaders\";\r\nimport useLocaleSort, { mapByKey } from \"../utils/useLocaleSort\";\r\nimport useToggle from \"../utils/useToggle\";\r\nimport { BindFlowDialog } from \"./BindFlowDialog\";\r\nimport { DuplicateFlowModal } from \"./DuplicateFlowModal\";\r\nimport { RequiredActions } from \"./RequiredActions\";\r\nimport { UsedBy } from \"./components/UsedBy\";\r\nimport { AuthenticationType } from \"./constants\";\r\nimport { Policies } from \"./policies/Policies\";\r\nimport { AuthenticationTab, toAuthentication } from \"./routes/Authentication\";\r\nimport { toCreateFlow } from \"./routes/CreateFlow\";\r\nimport { toFlow } from \"./routes/Flow\";\r\n\r\nconst AliasRenderer = ({ id, alias, usedBy, builtIn }: AuthenticationType) => {\r\n  const { t } = useTranslation();\r\n  const { realm } = useRealm();\r\n\r\n  return (\r\n    <>\r\n      <Link\r\n        to={toFlow({\r\n          realm,\r\n          id: id!,\r\n          usedBy: usedBy?.type || \"notInUse\",\r\n          builtIn: builtIn ? \"builtIn\" : undefined,\r\n        })}\r\n        key={`link-${id}`}\r\n      >\r\n        {alias}\r\n      </Link>{\" \"}\r\n      {builtIn && <Label key={`label-${id}`}>{t(\"buildIn\")}</Label>}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default function AuthenticationSection() {\r\n  const { adminClient } = useAdminClient();\r\n  const { t } = useTranslation();\r\n  const { realm: realmName, realmRepresentation: realm } = useRealm();\r\n  const [key, setKey] = useState(0);\r\n  const refresh = () => setKey(key + 1);\r\n  const { addAlert, addError } = useAlerts();\r\n  const localeSort = useLocaleSort();\r\n  const [selectedFlow, setSelectedFlow] = useState<AuthenticationType>();\r\n  const [open, toggleOpen] = useToggle();\r\n  const [bindFlowOpen, toggleBindFlow] = useToggle();\r\n\r\n  const loader = async () => {\r\n    const flowsRequest = await fetchWithError(\r\n      `${addTrailingSlash(\r\n        adminClient.baseUrl,\r\n      )}admin/realms/${realmName}/ui-ext/authentication-management/flows`,\r\n      {\r\n        method: \"GET\",\r\n        headers: getAuthorizationHeaders(await adminClient.getAccessToken()),\r\n      },\r\n    );\r\n    const flows = await flowsRequest.json();\r\n\r\n    if (!flows) {\r\n      return [];\r\n    }\r\n\r\n    return sortBy(\r\n      localeSort<AuthenticationType>(flows, mapByKey(\"alias\")),\r\n      (flow) => flow.usedBy?.type,\r\n    );\r\n  };\r\n\r\n  const useTab = (tab: AuthenticationTab) =>\r\n    useRoutableTab(toAuthentication({ realm: realmName, tab }));\r\n\r\n  const flowsTab = useTab(\"flows\");\r\n  const requiredActionsTab = useTab(\"required-actions\");\r\n  const policiesTab = useTab(\"policies\");\r\n\r\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\r\n    titleKey: \"deleteConfirmFlow\",\r\n    children: (\r\n      <Trans i18nKey=\"deleteConfirmFlowMessage\">\r\n        {\" \"}\r\n        <strong>{{ flow: selectedFlow ? selectedFlow.alias : \"\" }}</strong>.\r\n      </Trans>\r\n    ),\r\n    continueButtonLabel: \"delete\",\r\n    continueButtonVariant: ButtonVariant.danger,\r\n    onConfirm: async () => {\r\n      try {\r\n        await adminClient.authenticationManagement.deleteFlow({\r\n          flowId: selectedFlow!.id!,\r\n        });\r\n        refresh();\r\n        addAlert(t(\"deleteFlowSuccess\"), AlertVariant.success);\r\n      } catch (error) {\r\n        addError(\"deleteFlowError\", error);\r\n      }\r\n    },\r\n  });\r\n\r\n  if (!realm) return <KeycloakSpinner />;\r\n\r\n  return (\r\n    <>\r\n      <DeleteConfirm />\r\n      {open && selectedFlow && (\r\n        <DuplicateFlowModal\r\n          name={selectedFlow.alias!}\r\n          description={selectedFlow.description!}\r\n          toggleDialog={toggleOpen}\r\n          onComplete={() => {\r\n            refresh();\r\n            toggleOpen();\r\n          }}\r\n        />\r\n      )}\r\n      {bindFlowOpen && (\r\n        <BindFlowDialog\r\n          onClose={() => {\r\n            toggleBindFlow();\r\n            refresh();\r\n          }}\r\n          flowAlias={selectedFlow?.alias!}\r\n        />\r\n      )}\r\n      <ViewHeader\r\n        titleKey=\"titleAuthentication\"\r\n        subKey=\"authenticationExplain\"\r\n        helpUrl={helpUrls.authenticationUrl}\r\n        divider={false}\r\n      />\r\n      <PageSection variant=\"light\" className=\"pf-v5-u-p-0\">\r\n        <RoutableTabs\r\n          isBox\r\n          defaultLocation={toAuthentication({ realm: realmName, tab: \"flows\" })}\r\n        >\r\n          <Tab\r\n            data-testid=\"flows\"\r\n            title={<TabTitleText>{t(\"flows\")}</TabTitleText>}\r\n            {...flowsTab}\r\n          >\r\n            <KeycloakDataTable\r\n              key={key}\r\n              loader={loader}\r\n              ariaLabelKey=\"titleAuthentication\"\r\n              searchPlaceholderKey=\"searchForFlow\"\r\n              toolbarItem={\r\n                <ToolbarItem>\r\n                  <Button\r\n                    component={(props) => (\r\n                      <Link\r\n                        {...props}\r\n                        to={toCreateFlow({ realm: realmName })}\r\n                      />\r\n                    )}\r\n                  >\r\n                    {t(\"createFlow\")}\r\n                  </Button>\r\n                </ToolbarItem>\r\n              }\r\n              actionResolver={({ data }) => [\r\n                {\r\n                  title: t(\"duplicate\"),\r\n                  onClick: () => {\r\n                    toggleOpen();\r\n                    setSelectedFlow(data);\r\n                  },\r\n                },\r\n                ...(data.usedBy?.type !== \"DEFAULT\"\r\n                  ? [\r\n                      {\r\n                        title: t(\"bindFlow\"),\r\n                        onClick: () => {\r\n                          toggleBindFlow();\r\n                          setSelectedFlow(data);\r\n                        },\r\n                      },\r\n                    ]\r\n                  : []),\r\n                ...(!data.builtIn && !data.usedBy\r\n                  ? [\r\n                      {\r\n                        title: t(\"delete\"),\r\n                        onClick: () => {\r\n                          setSelectedFlow(data);\r\n                          toggleDeleteDialog();\r\n                        },\r\n                      },\r\n                    ]\r\n                  : []),\r\n              ]}\r\n              columns={[\r\n                {\r\n                  name: \"alias\",\r\n                  displayKey: \"flowName\",\r\n                  cellRenderer: (row) => <AliasRenderer {...row} />,\r\n                },\r\n                {\r\n                  name: \"usedBy\",\r\n                  displayKey: \"usedBy\",\r\n                  cellRenderer: (row) => <UsedBy authType={row} />,\r\n                },\r\n                {\r\n                  name: \"description\",\r\n                  displayKey: \"description\",\r\n                },\r\n              ]}\r\n              emptyState={\r\n                <ListEmptyState\r\n                  message={t(\"emptyEvents\")}\r\n                  instructions={t(\"emptyEventsInstructions\")}\r\n                />\r\n              }\r\n            />\r\n          </Tab>\r\n          <Tab\r\n            data-testid=\"requiredActions\"\r\n            title={<TabTitleText>{t(\"requiredActions\")}</TabTitleText>}\r\n            {...requiredActionsTab}\r\n          >\r\n            <RequiredActions />\r\n          </Tab>\r\n          <Tab\r\n            data-testid=\"policies\"\r\n            title={<TabTitleText>{t(\"policies\")}</TabTitleText>}\r\n            {...policiesTab}\r\n          >\r\n            <Policies />\r\n          </Tab>\r\n        </RoutableTabs>\r\n      </PageSection>\r\n    </>\r\n  );\r\n}\r\n"],"names":["RequiredActionConfigModal","requiredAction","onClose","adminClient","useAdminClient","useTranslation","addAlert","addError","useAlerts","configDescription","setConfigDescription","useState","form","useForm","setValue","handleSubmit","setupForm","config","convertToFormValues","useFetch","save","saved","newConfig","convertFormValuesToObject","AlertVariant","error","isUserProfileError","setUserProfileServerError","name","jsx","Modal","ModalVariant","Form","FormProvider","DynamicComponents","ActionGroup","Button","ButtonVariant","jsxs","TrashIcon","RequiredActions","t","actions","setActions","selectedAction","setSelectedAction","key","setKey","refresh","realmName","useRealm","loadActions","fetchWithError","addTrailingSlash","getAuthorizationHeaders","requiredActions","unregisteredRequiredActions","action","isUnregisteredAction","data","updateAction","field","executeMove","times","alias","index","Fragment","DraggableTable","nameDragged","items","keys","e","newIndex","oldIndex","dragged","row","Switch","toKey","CogIcon","KeycloakSpinner","Label","label","CheckCircleIcon","style","UsedByModal","id","isSpecificClient","loader","first","max","search","fetchUsedBy","p","TextContent","Text","TextVariants","KeycloakDataTable","UsedBy","usedBy","realm","open","toggle","useToggle","Popover","used","REALM_FLOWS","CIBA_BACKHANNEL_TOKEN_DELIVERY_MODES","CIBA_EXPIRES_IN_MIN","CIBA_EXPIRES_IN_MAX","CIBA_INTERVAL_MIN","CIBA_INTERVAL_MAX","CibaPolicy","realmUpdated","useEffect","onSubmit","formValues","updatedRealm","PageSection","FormAccess","SelectControl","mode","TextControl","POLICY_TYPES","OTP_HASH_ALGORITHMS","NUMBER_OF_DIGITS","OtpPolicy","control","reset","isValid","isDirty","localeSort","useLocaleSort","otpType","useWatch","supportedApplications","useMemo","labels","FormGroup","HelpItem","Controller","value","onChange","type","Radio","NumberControl","TimeSelectorControl","ChipGroup","Chip","SwitchControl","PolicyRow","configType","defaultValue","displayName","onRemove","register","errors","useFormContext","Split","SplitItem","TextInput","ValidatedOptions","newValue","NumberInput","event","MinusCircleIcon","FormErrorText","POLICY_SEPARATOR","serializePolicy","policies","submitted","policy","parsePolicy","parsePolicyToken","result","matchingPolicy","token","valueStart","valueEnd","PolicySelect","onSelect","selectedPolicies","passwordPolicies","useServerInfo","setOpen","o","Select","_","selection","ref","MenuToggle","SelectList","SelectOption","PasswordPolicy","rows","setRows","values","v","Toolbar","ToolbarContent","ToolbarItem","Divider","r","EmptyState","EmptyStateHeader","EmptyStateIcon","PlusCircleIcon","EmptyStateBody","EmptyStateFooter","EmptyStateActions","SIGNATURE_ALGORITHMS","ATTESTATION_PREFERENCE","AUTHENTICATOR_ATTACHMENT","RESIDENT_KEY_OPTIONS","USER_VERIFY","WebauthnSelect","labelIcon","options","labelPrefix","isMultiSelect","option","WebauthnPolicy","isPasswordLess","enabled","useHelp","namePrefix","submittedRealm","isFeatureEnabled","useIsFeatureEnabled","QuestionCircleIcon","MultiLineInput","Feature","Policies","subTab","setSubTab","Tabs","Tab","TabTitleText","AliasRenderer","builtIn","Link","toFlow","AuthenticationSection","selectedFlow","setSelectedFlow","toggleOpen","bindFlowOpen","toggleBindFlow","flows","sortBy","mapByKey","flow","useTab","tab","useRoutableTab","toAuthentication","flowsTab","requiredActionsTab","policiesTab","toggleDeleteDialog","DeleteConfirm","useConfirmDialog","Trans","DuplicateFlowModal","BindFlowDialog","ViewHeader","helpUrls","RoutableTabs","props","toCreateFlow","ListEmptyState"],"mappings":"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"}