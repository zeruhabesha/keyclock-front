{"version":3,"file":"ScopeForm-BaMejMtZ.js","sources":["../../../../../../../src/client-scopes/details/ScopeForm.tsx"],"sourcesContent":["import type ClientScopeRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/clientScopeRepresentation\";\r\nimport type { KeyMetadataRepresentation } from \"@keycloak/keycloak-admin-client/lib/defs/keyMetadataRepresentation\";\r\nimport { ActionGroup, Button } from \"@patternfly/react-core\";\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { FormProvider, useForm, useWatch } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {\r\n  FormSubmitButton,\r\n  SelectControl,\r\n  TextAreaControl,\r\n  TextControl,\r\n  useFetch,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\n\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { getProtocolName } from \"../../clients/utils\";\r\nimport { DefaultSwitchControl } from \"../../components/SwitchControl\";\r\nimport {\r\n  ClientScopeDefaultOptionalType,\r\n  allClientScopeTypes,\r\n} from \"../../components/client-scope/ClientScopeTypes\";\r\nimport { FormAccess } from \"../../components/form/FormAccess\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport {\r\n  useLoginProviders,\r\n  useServerInfo,\r\n} from \"../../context/server-info/ServerInfoProvider\";\r\nimport { convertAttributeNameToForm, convertToFormValues } from \"../../util\";\r\nimport useIsFeatureEnabled, { Feature } from \"../../utils/useIsFeatureEnabled\";\r\nimport { toClientScopes } from \"../routes/ClientScopes\";\r\n\r\nconst OID4VC_PROTOCOL = \"oid4vc\";\r\nconst VC_FORMAT_JWT_VC = \"jwt_vc\";\r\nconst VC_FORMAT_SD_JWT = \"dc+sd-jwt\";\r\n\r\n// Validation function for comma-separated lists\r\nconst validateCommaSeparatedList = (value: string | undefined) => {\r\n  if (!value || value.trim() === \"\") {\r\n    return true;\r\n  }\r\n  if (value.includes(\", \") || value.includes(\" ,\")) {\r\n    return \"Comma-separated list must not contain spaces around commas\";\r\n  }\r\n  const entries = value.split(\",\");\r\n  const hasEmptyEntries = entries.some((entry) => entry.trim() === \"\");\r\n  if (hasEmptyEntries) {\r\n    return \"Comma-separated list contains empty entries\";\r\n  }\r\n  return true;\r\n};\r\n\r\ntype ScopeFormProps = {\r\n  clientScope?: ClientScopeRepresentation;\r\n  save: (clientScope: ClientScopeDefaultOptionalType) => void;\r\n};\r\n\r\nexport const ScopeForm = ({ clientScope, save }: ScopeFormProps) => {\r\n  const { t } = useTranslation();\r\n  const { adminClient } = useAdminClient();\r\n  const form = useForm<ClientScopeDefaultOptionalType>({ mode: \"onChange\" });\r\n  const { control, handleSubmit, setValue, formState } = form;\r\n  const { isDirty, isValid } = formState;\r\n  const { realm } = useRealm();\r\n\r\n  const providers = useLoginProviders();\r\n  const serverInfo = useServerInfo();\r\n  const isFeatureEnabled = useIsFeatureEnabled();\r\n  const isDynamicScopesEnabled = isFeatureEnabled(Feature.DynamicScopes);\r\n\r\n  // Get available signature algorithms from server info\r\n  const signatureAlgorithms = useMemo(\r\n    () =>\r\n      serverInfo?.providers?.signature?.providers\r\n        ? Object.keys(serverInfo.providers.signature.providers)\r\n        : [],\r\n    [serverInfo],\r\n  );\r\n\r\n  // Fetch realm keys for signing_key_id dropdown\r\n  const [realmKeys, setRealmKeys] = useState<KeyMetadataRepresentation[]>([]);\r\n\r\n  useFetch(\r\n    async () => {\r\n      const keysMetadata = await adminClient.realms.getKeys({ realm });\r\n      return keysMetadata.keys || [];\r\n    },\r\n    setRealmKeys,\r\n    [],\r\n  );\r\n\r\n  // Prepare key options for SelectControl\r\n  // Filter only active keys suitable for signing credentials\r\n  const keyOptions = useMemo(() => {\r\n    const options = [{ key: \"\", value: t(\"useDefaultKey\") }];\r\n    if (realmKeys && realmKeys.length > 0) {\r\n      const keyOptions = realmKeys\r\n        .filter(\r\n          (key) =>\r\n            key.kid &&\r\n            key.status === \"ACTIVE\" &&\r\n            key.algorithm &&\r\n            signatureAlgorithms.includes(key.algorithm),\r\n        )\r\n        .map((key) => ({\r\n          key: key.kid!,\r\n          value: `${key.kid} (${key.algorithm})`,\r\n        }));\r\n      options.push(...keyOptions);\r\n    }\r\n    return options;\r\n  }, [realmKeys, signatureAlgorithms, t]);\r\n\r\n  const displayOnConsentScreen: string = useWatch({\r\n    control,\r\n    name: convertAttributeNameToForm(\"attributes.display.on.consent.screen\"),\r\n    defaultValue:\r\n      clientScope?.attributes?.[\"display.on.consent.screen\"] ?? \"true\",\r\n  });\r\n\r\n  const dynamicScope = useWatch({\r\n    control,\r\n    name: convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n      \"attributes.is.dynamic.scope\",\r\n    ),\r\n    defaultValue: \"false\",\r\n  });\r\n\r\n  const selectedProtocol = useWatch({\r\n    control,\r\n    name: \"protocol\",\r\n  });\r\n\r\n  const selectedFormat = useWatch({\r\n    control,\r\n    name: convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n      \"attributes.vc.format\",\r\n    ),\r\n    defaultValue: clientScope?.attributes?.[\"vc.format\"] ?? VC_FORMAT_SD_JWT,\r\n  });\r\n\r\n  const isOid4vcProtocol = selectedProtocol === OID4VC_PROTOCOL;\r\n  const isOid4vcEnabled = isFeatureEnabled(Feature.OpenId4VCI);\r\n  const isNotSaml = selectedProtocol != \"saml\";\r\n\r\n  const setDynamicRegex = (value: string, append: boolean) =>\r\n    setValue(\r\n      convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n        \"attributes.dynamic.scope.regexp\",\r\n      ),\r\n      append ? `${value}:*` : value,\r\n      { shouldDirty: true }, // Mark the field as dirty when we modify the field\r\n    );\r\n\r\n  useEffect(() => {\r\n    convertToFormValues(clientScope ?? {}, setValue);\r\n  }, [clientScope, setValue]);\r\n\r\n  return (\r\n    <FormAccess\r\n      role=\"manage-clients\"\r\n      onSubmit={handleSubmit(save)}\r\n      isHorizontal\r\n    >\r\n      <FormProvider {...form}>\r\n        <TextControl\r\n          name=\"name\"\r\n          label={t(\"name\")}\r\n          labelIcon={t(\"scopeNameHelp\")}\r\n          rules={{\r\n            required: t(\"required\"),\r\n            onChange: (e) => {\r\n              if (isDynamicScopesEnabled)\r\n                setDynamicRegex(e.target.validated, true);\r\n            },\r\n          }}\r\n        />\r\n        {isDynamicScopesEnabled && (\r\n          <>\r\n            <DefaultSwitchControl\r\n              name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                \"attributes.is.dynamic.scope\",\r\n              )}\r\n              label={t(\"dynamicScope\")}\r\n              labelIcon={t(\"dynamicScopeHelp\")}\r\n              onChange={(event, value) => {\r\n                setDynamicRegex(\r\n                  value ? form.getValues(\"name\") || \"\" : \"\",\r\n                  value,\r\n                );\r\n              }}\r\n              stringify\r\n            />\r\n            {dynamicScope === \"true\" && (\r\n              <TextControl\r\n                name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                  \"attributes.dynamic.scope.regexp\",\r\n                )}\r\n                label={t(\"dynamicScopeFormat\")}\r\n                labelIcon={t(\"dynamicScopeFormatHelp\")}\r\n                isDisabled\r\n              />\r\n            )}\r\n          </>\r\n        )}\r\n        <TextAreaControl\r\n          name=\"description\"\r\n          label={t(\"description\")}\r\n          labelIcon={t(\"scopeDescriptionHelp\")}\r\n          rules={{\r\n            maxLength: {\r\n              value: 255,\r\n              message: t(\"maxLength\"),\r\n            },\r\n          }}\r\n        />\r\n        <SelectControl\r\n          id=\"kc-type\"\r\n          name=\"type\"\r\n          label={t(\"type\")}\r\n          labelIcon={t(\"scopeTypeHelp\")}\r\n          controller={{ defaultValue: allClientScopeTypes[0] }}\r\n          options={allClientScopeTypes.map((key) => ({\r\n            key,\r\n            value: t(`clientScopeType.${key}`),\r\n          }))}\r\n        />\r\n        {!clientScope && (\r\n          <SelectControl\r\n            id=\"kc-protocol\"\r\n            name=\"protocol\"\r\n            label={t(\"protocol\")}\r\n            labelIcon={t(\"protocolHelp\")}\r\n            controller={{ defaultValue: providers[0] }}\r\n            options={providers\r\n              .filter((option) =>\r\n                option === OID4VC_PROTOCOL ? isOid4vcEnabled : true,\r\n              )\r\n              .map((option) => ({\r\n                key: option,\r\n                value: getProtocolName(t, option),\r\n              }))}\r\n          />\r\n        )}\r\n        <DefaultSwitchControl\r\n          name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n            \"attributes.display.on.consent.screen\",\r\n          )}\r\n          defaultValue={displayOnConsentScreen}\r\n          label={t(\"displayOnConsentScreen\")}\r\n          labelIcon={t(\"displayOnConsentScreenHelp\")}\r\n          stringify\r\n        />\r\n        {displayOnConsentScreen === \"true\" && (\r\n          <TextAreaControl\r\n            name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n              \"attributes.consent.screen.text\",\r\n            )}\r\n            label={t(\"consentScreenText\")}\r\n            labelIcon={t(\"consentScreenTextHelp\")}\r\n          />\r\n        )}\r\n        <DefaultSwitchControl\r\n          name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n            \"attributes.include.in.token.scope\",\r\n          )}\r\n          label={t(\"includeInTokenScope\")}\r\n          labelIcon={t(\"includeInTokenScopeHelp\")}\r\n          stringify\r\n        />\r\n        {isNotSaml && (\r\n          <DefaultSwitchControl\r\n            name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n              \"attributes.include.in.openid.provider.metadata\",\r\n            )}\r\n            defaultValue=\"true\"\r\n            label={t(\"includeInOpenIdProviderMetadata\")}\r\n            labelIcon={t(\"includeInOpenIdProviderMetadataHelp\")}\r\n            stringify\r\n          />\r\n        )}\r\n        <TextControl\r\n          name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n            \"attributes.gui.order\",\r\n          )}\r\n          label={t(\"guiOrder\")}\r\n          labelIcon={t(\"guiOrderHelp\")}\r\n          type=\"number\"\r\n          min={0}\r\n        />\r\n\r\n        {isOid4vcProtocol && isOid4vcEnabled && (\r\n          <>\r\n            <TextControl\r\n              name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                \"attributes.vc.credential_configuration_id\",\r\n              )}\r\n              label={t(\"credentialConfigurationId\")}\r\n              labelIcon={t(\"credentialConfigurationIdHelp\")}\r\n            />\r\n            <TextControl\r\n              name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                \"attributes.vc.credential_identifier\",\r\n              )}\r\n              label={t(\"credentialIdentifier\")}\r\n              labelIcon={t(\"credentialIdentifierHelp\")}\r\n            />\r\n            <TextControl\r\n              name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                \"attributes.vc.issuer_did\",\r\n              )}\r\n              label={t(\"issuerDid\")}\r\n              labelIcon={t(\"issuerDidHelp\")}\r\n            />\r\n            <TextControl\r\n              name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                \"attributes.vc.expiry_in_seconds\",\r\n              )}\r\n              label={t(\"credentialLifetime\")}\r\n              labelIcon={t(\"credentialLifetimeHelp\")}\r\n              type=\"number\"\r\n              min={1}\r\n            />\r\n            <SelectControl\r\n              id=\"kc-vc-format\"\r\n              name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                \"attributes.vc.format\",\r\n              )}\r\n              label={t(\"supportedFormats\")}\r\n              labelIcon={t(\"supportedFormatsHelp\")}\r\n              controller={{ defaultValue: VC_FORMAT_SD_JWT }}\r\n              options={[\r\n                {\r\n                  key: VC_FORMAT_SD_JWT,\r\n                  value: `SD-JWT VC (${VC_FORMAT_SD_JWT})`,\r\n                },\r\n                {\r\n                  key: VC_FORMAT_JWT_VC,\r\n                  value: `JWT VC (${VC_FORMAT_JWT_VC})`,\r\n                },\r\n              ]}\r\n            />\r\n            <TextControl\r\n              name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                \"attributes.vc.credential_build_config.token_jws_type\",\r\n              )}\r\n              label={t(\"tokenJwsType\")}\r\n              labelIcon={t(\"tokenJwsTypeHelp\")}\r\n              defaultValue={\r\n                clientScope?.attributes?.[\r\n                  \"vc.credential_build_config.token_jws_type\"\r\n                ] ?? \"JWS\"\r\n              }\r\n            />\r\n            {realmKeys && realmKeys.length > 0 && (\r\n              <SelectControl\r\n                id=\"kc-signing-key-id\"\r\n                name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                  \"attributes.vc.signing_key_id\",\r\n                )}\r\n                label={t(\"signingKeyId\")}\r\n                labelIcon={t(\"signingKeyIdHelp\")}\r\n                controller={{\r\n                  defaultValue:\r\n                    clientScope?.attributes?.[\"vc.signing_key_id\"] ?? \"\",\r\n                }}\r\n                options={keyOptions}\r\n              />\r\n            )}\r\n            <TextAreaControl\r\n              name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                \"attributes.vc.display\",\r\n              )}\r\n              label={t(\"credentialDisplay\")}\r\n              labelIcon={t(\"credentialDisplayHelp\")}\r\n              rules={{\r\n                validate: (value: string | undefined) => {\r\n                  if (!value || value.trim() === \"\") {\r\n                    return true;\r\n                  }\r\n                  try {\r\n                    JSON.parse(value);\r\n                    return true;\r\n                  } catch {\r\n                    return \"Invalid JSON format\";\r\n                  }\r\n                },\r\n              }}\r\n            />\r\n            {(selectedFormat === VC_FORMAT_JWT_VC ||\r\n              selectedFormat === VC_FORMAT_SD_JWT) && (\r\n              <TextControl\r\n                name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                  \"attributes.vc.supported_credential_types\",\r\n                )}\r\n                label={t(\"supportedCredentialTypes\")}\r\n                labelIcon={t(\"supportedCredentialTypesHelp\")}\r\n                rules={{\r\n                  validate: validateCommaSeparatedList,\r\n                }}\r\n              />\r\n            )}\r\n            {selectedFormat === VC_FORMAT_SD_JWT && (\r\n              <>\r\n                <TextControl\r\n                  name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                    \"attributes.vc.verifiable_credential_type\",\r\n                  )}\r\n                  label={t(\"verifiableCredentialType\")}\r\n                  labelIcon={t(\"verifiableCredentialTypeHelp\")}\r\n                />\r\n                <TextControl\r\n                  name={convertAttributeNameToForm<ClientScopeDefaultOptionalType>(\r\n                    \"attributes.vc.credential_build_config.sd_jwt.visible_claims\",\r\n                  )}\r\n                  label={t(\"visibleClaims\")}\r\n                  labelIcon={t(\"visibleClaimsHelp\")}\r\n                  defaultValue={\r\n                    clientScope?.attributes?.[\r\n                      \"vc.credential_build_config.sd_jwt.visible_claims\"\r\n                    ] ?? \"id,iat,nbf,exp,jti\"\r\n                  }\r\n                  rules={{\r\n                    validate: validateCommaSeparatedList,\r\n                  }}\r\n                />\r\n              </>\r\n            )}\r\n          </>\r\n        )}\r\n\r\n        <ActionGroup>\r\n          <FormSubmitButton\r\n            data-testid=\"save\"\r\n            formState={formState}\r\n            disabled={!isDirty || !isValid}\r\n          >\r\n            {t(\"save\")}\r\n          </FormSubmitButton>\r\n          <Button\r\n            variant=\"link\"\r\n            component={(props) => (\r\n              <Link {...props} to={toClientScopes({ realm })}></Link>\r\n            )}\r\n          >\r\n            {t(\"cancel\")}\r\n          </Button>\r\n        </ActionGroup>\r\n      </FormProvider>\r\n    </FormAccess>\r\n  );\r\n};\r\n"],"names":["OID4VC_PROTOCOL","VC_FORMAT_JWT_VC","VC_FORMAT_SD_JWT","validateCommaSeparatedList","value","entry","ScopeForm","clientScope","save","t","useTranslation","adminClient","useAdminClient","form","useForm","control","handleSubmit","setValue","formState","isDirty","isValid","realm","useRealm","providers","useLoginProviders","serverInfo","useServerInfo","isFeatureEnabled","useIsFeatureEnabled","isDynamicScopesEnabled","Feature","signatureAlgorithms","useMemo","realmKeys","setRealmKeys","useState","useFetch","keyOptions","options","key","displayOnConsentScreen","useWatch","convertAttributeNameToForm","dynamicScope","selectedProtocol","selectedFormat","isOid4vcProtocol","isOid4vcEnabled","isNotSaml","setDynamicRegex","append","useEffect","convertToFormValues","jsx","FormAccess","jsxs","FormProvider","TextControl","e","Fragment","DefaultSwitchControl","event","TextAreaControl","SelectControl","allClientScopeTypes","option","getProtocolName","ActionGroup","FormSubmitButton","Button","props","Link","toClientScopes"],"mappings":"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"}