import{jsxs as D,Fragment as w,jsx as p}from"react/jsx-runtime";import{useState as b,useMemo as I}from"react";import{u as L,a as x,a0 as C,O as T,S as j,W as S,Q as k,cD as A}from"./main-o1hptXRo.js";const g=(r,o,t={})=>{if(!Number.isFinite(o))throw new TypeError("Expected `wait` to be a finite number");let u,e,a=[],l=[];const i=()=>{clearTimeout(e),e=null;try{t.signal?.throwIfAborted()}catch(s){for(const y of l)y(s);a=[],l=[]}};return function(...s){return new Promise((y,f)=>{try{t.signal?.throwIfAborted()}catch(c){f(c);return}const h=t.before&&!e;clearTimeout(e),e=setTimeout(async()=>{e=null;const c=a,E=l;a=[],l=[];try{const v=t.before?u:await r.apply(this,s);for(const m of c)m(v)}catch(v){for(const m of E)m(v)}u=void 0,t.signal?.removeEventListener("abort",i)},o),h?(async()=>{try{u=await r.apply(this,s),y(u)}catch(c){f(c)}})():(a.push(y),l.push(f),t.signal&&a.length===1&&t.signal.addEventListener("abort",i,{once:!0}))})}};g.promise=r=>{let o;return async function(...t){if(o)return o;try{return o=r.apply(this,t),await o}finally{o=void 0}}};const O=({id:r,fileUpload:o,children:t})=>{const{adminClient:u}=L(),{t:e}=x(),{setValue:a,clearErrors:l,formState:{errors:i}}=C(),[s,y]=b(!0),[f,h]=b(!1),[c,E]=b(),v=d=>{Object.keys(d).map(n=>a(`config.${n}`,d[n]))},m=async d=>{h(!0);try{const n=await u.identityProviders.importFromUrl({providerId:r,fromUrl:d});v(n),E(n)}catch(n){return n.message}finally{h(!1)}},F=I(()=>g(m,1e3),[]);return D(w,{children:[p(T,{label:e(r==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor"),fieldId:"kc-discovery-endpoint",labelIcon:p(S,{helpText:e(r==="oidc"?"useDiscoveryEndpointHelp":"useEntityDescriptorHelp"),fieldLabelId:"discoveryEndpoint"}),children:p(j,{id:"kc-discovery-endpoint-switch",label:e("on"),labelOff:e("off"),isChecked:s,onChange:(d,n)=>{l("discoveryError"),y(n)},"aria-label":e(r==="oidc"?"useDiscoveryEndpoint":"useEntityDescriptor")})}),s&&D(w,{children:[p("div",{style:{display:"none"},"data-testid":"playwright-result",children:i.discoveryError||i.discoveryEndpoint?"error":c?"success":"default"}),p(k,{name:"discoveryEndpoint",label:e(r==="oidc"?"discoveryEndpoint":"samlEntityDescriptor"),labelIcon:e(r==="oidc"?"discoveryEndpointHelp":"samlEntityDescriptorHelp"),type:"url",placeholder:r==="oidc"?"https://hostname/realms/master/.well-known/openid-configuration":"",validated:i.discoveryError||i.discoveryEndpoint?"error":c?"success":"default",customIcon:f?p(A,{isInline:!0}):void 0,rules:{required:e("required"),validate:d=>F(d)}})]}),!s&&o,s&&!i.discoveryError&&t(!0),!s&&t(!1)]})};export{O as D};
//# sourceMappingURL=DiscoveryEndpointField-CeImOp4h.js.map
