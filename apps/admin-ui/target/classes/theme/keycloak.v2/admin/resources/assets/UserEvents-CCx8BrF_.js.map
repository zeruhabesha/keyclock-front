{"version":3,"file":"UserEvents-CCx8BrF_.js","sources":["../../../../../../../src/events/UserEvents.tsx"],"sourcesContent":["import type EventRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/eventRepresentation\";\r\nimport type EventType from \"@keycloak/keycloak-admin-client/lib/defs/eventTypes\";\r\nimport {\r\n  KeycloakDataTable,\r\n  KeycloakSelect,\r\n  ListEmptyState,\r\n  SelectVariant,\r\n  TextControl,\r\n  useFetch,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  ActionGroup,\r\n  Button,\r\n  Chip,\r\n  ChipGroup,\r\n  DatePicker,\r\n  DescriptionList,\r\n  DescriptionListDescription,\r\n  DescriptionListGroup,\r\n  DescriptionListTerm,\r\n  Flex,\r\n  FlexItem,\r\n  Form,\r\n  FormGroup,\r\n  Icon,\r\n  SelectOption,\r\n  Tooltip,\r\n} from \"@patternfly/react-core\";\r\nimport { CheckCircleIcon, WarningTriangleIcon } from \"@patternfly/react-icons\";\r\nimport { cellWidth } from \"@patternfly/react-table\";\r\nimport { pickBy } from \"lodash-es\";\r\nimport { useState } from \"react\";\r\nimport { Controller, FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport { EventsBanners } from \"../Banners\";\r\nimport DropdownPanel from \"../components/dropdown-panel/DropdownPanel\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport { toUser } from \"../user/routes/User\";\r\nimport useFormatDate, { FORMAT_DATE_AND_TIME } from \"../utils/useFormatDate\";\r\nimport useLocaleSort from \"../utils/useLocaleSort\";\r\n\r\nimport \"./events.css\";\r\n\r\ntype UserEventSearchForm = {\r\n  client: string;\r\n  dateFrom: string;\r\n  dateTo: string;\r\n  user: string;\r\n  type: EventType[];\r\n  ipAddress: string;\r\n};\r\n\r\nconst StatusRow = (event: EventRepresentation) =>\r\n  !event.error ? (\r\n    <span>\r\n      <Icon status=\"success\">\r\n        <CheckCircleIcon />\r\n      </Icon>\r\n      {event.type}\r\n    </span>\r\n  ) : (\r\n    <Tooltip content={event.error}>\r\n      <span>\r\n        <Icon status=\"warning\">\r\n          <WarningTriangleIcon />\r\n        </Icon>\r\n        {event.type}\r\n      </span>\r\n    </Tooltip>\r\n  );\r\n\r\nconst DetailCell = (event: EventRepresentation) => (\r\n  <DescriptionList isHorizontal className=\"keycloak_eventsection_details\">\r\n    {event.details &&\r\n      Object.entries(event.details).map(([key, value]) => (\r\n        <DescriptionListGroup key={key}>\r\n          <DescriptionListTerm>{key}</DescriptionListTerm>\r\n          <DescriptionListDescription>{value}</DescriptionListDescription>\r\n        </DescriptionListGroup>\r\n      ))}\r\n    {event.error && (\r\n      <DescriptionListGroup key=\"error\">\r\n        <DescriptionListTerm>error</DescriptionListTerm>\r\n        <DescriptionListDescription>{event.error}</DescriptionListDescription>\r\n      </DescriptionListGroup>\r\n    )}\r\n  </DescriptionList>\r\n);\r\n\r\nconst UserDetailLink = (event: EventRepresentation) => {\r\n  const { t } = useTranslation();\r\n  const { realm } = useRealm();\r\n\r\n  return (\r\n    <>\r\n      {event.userId && (\r\n        <Link\r\n          key={`link-${event.time}-${event.type}`}\r\n          to={toUser({\r\n            realm,\r\n            id: event.userId,\r\n            tab: \"settings\",\r\n          })}\r\n        >\r\n          {event.userId}\r\n        </Link>\r\n      )}\r\n      {!event.userId && t(\"noUserDetails\")}\r\n    </>\r\n  );\r\n};\r\n\r\ntype UserEventsProps = {\r\n  user?: string;\r\n  client?: string;\r\n};\r\n\r\nexport const UserEvents = ({ user, client }: UserEventsProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const localeSort = useLocaleSort();\r\n  const { realm } = useRealm();\r\n  const formatDate = useFormatDate();\r\n  const [key, setKey] = useState(0);\r\n  const [searchDropdownOpen, setSearchDropdownOpen] = useState(false);\r\n  const [selectOpen, setSelectOpen] = useState(false);\r\n  const [events, setEvents] = useState<string[]>();\r\n  const [userEventsEnabled, setUserEventsEnabled] = useState<boolean>();\r\n  const [activeFilters, setActiveFilters] = useState<\r\n    Partial<UserEventSearchForm>\r\n  >({});\r\n\r\n  const defaultValues: UserEventSearchForm = {\r\n    client: client ? client : \"\",\r\n    dateFrom: \"\",\r\n    dateTo: \"\",\r\n    user: user ? user : \"\",\r\n    type: [],\r\n    ipAddress: \"\",\r\n  };\r\n\r\n  const filterLabels: Record<keyof UserEventSearchForm, string> = {\r\n    client: t(\"client\"),\r\n    dateFrom: t(\"dateFrom\"),\r\n    dateTo: t(\"dateTo\"),\r\n    user: t(\"userId\"),\r\n    type: t(\"eventType\"),\r\n    ipAddress: t(\"ipAddress\"),\r\n  };\r\n\r\n  const form = useForm<UserEventSearchForm>({\r\n    mode: \"onChange\",\r\n    defaultValues,\r\n  });\r\n\r\n  const {\r\n    getValues,\r\n    reset,\r\n    formState: { isDirty },\r\n    control,\r\n    handleSubmit,\r\n  } = form;\r\n\r\n  useFetch(\r\n    () => adminClient.realms.getConfigEvents({ realm }),\r\n    (events) => {\r\n      setUserEventsEnabled(events?.eventsEnabled!);\r\n      setEvents(localeSort(events?.enabledEventTypes || [], (e) => e));\r\n    },\r\n    [],\r\n  );\r\n\r\n  function loader(first?: number, max?: number) {\r\n    return adminClient.realms.findEvents({\r\n      client,\r\n      user,\r\n      // The admin client wants 'dateFrom' and 'dateTo' to be Date objects, however it cannot actually handle them so we need to cast to any.\r\n      ...(activeFilters as any),\r\n      realm,\r\n      first,\r\n      max,\r\n    });\r\n  }\r\n\r\n  function onSubmit() {\r\n    setSearchDropdownOpen(false);\r\n    commitFilters();\r\n  }\r\n\r\n  function resetSearch() {\r\n    reset();\r\n    commitFilters();\r\n  }\r\n\r\n  function removeFilter(key: keyof UserEventSearchForm) {\r\n    const formValues: UserEventSearchForm = { ...getValues() };\r\n    delete formValues[key];\r\n\r\n    reset({ ...defaultValues, ...formValues });\r\n    commitFilters();\r\n  }\r\n\r\n  function removeFilterValue(\r\n    key: keyof UserEventSearchForm,\r\n    valueToRemove: EventType,\r\n  ) {\r\n    const formValues = getValues();\r\n    const fieldValue = formValues[key];\r\n    const newFieldValue = Array.isArray(fieldValue)\r\n      ? fieldValue.filter((val) => val !== valueToRemove)\r\n      : fieldValue;\r\n\r\n    reset({ ...formValues, [key]: newFieldValue });\r\n    commitFilters();\r\n  }\r\n\r\n  function commitFilters() {\r\n    const newFilters: Partial<UserEventSearchForm> = pickBy(\r\n      getValues(),\r\n      (value) => value !== \"\" || (Array.isArray(value) && value.length > 0),\r\n    );\r\n\r\n    if (user) {\r\n      delete newFilters.user;\r\n    }\r\n\r\n    if (client) {\r\n      delete newFilters.client;\r\n    }\r\n\r\n    setActiveFilters(newFilters);\r\n    setKey(key + 1);\r\n  }\r\n\r\n  const userEventSearchFormDisplay = () => {\r\n    return (\r\n      <FormProvider {...form}>\r\n        <Flex\r\n          direction={{ default: \"column\" }}\r\n          spaceItems={{ default: \"spaceItemsNone\" }}\r\n        >\r\n          <FlexItem>\r\n            <DropdownPanel\r\n              buttonText={t(\"searchUserEventsBtn\")}\r\n              setSearchDropdownOpen={setSearchDropdownOpen}\r\n              searchDropdownOpen={searchDropdownOpen}\r\n              marginRight=\"2.5rem\"\r\n              width=\"15vw\"\r\n            >\r\n              <Form\r\n                data-testid=\"searchForm\"\r\n                className=\"keycloak__events_search__form\"\r\n                onSubmit={handleSubmit(onSubmit)}\r\n                isHorizontal\r\n              >\r\n                {!user && (\r\n                  <TextControl\r\n                    name=\"user\"\r\n                    label={t(\"userId\")}\r\n                    data-testid=\"userId-searchField\"\r\n                  />\r\n                )}\r\n                <FormGroup\r\n                  label={t(\"eventType\")}\r\n                  fieldId=\"kc-eventType\"\r\n                  className=\"keycloak__events_search__form_label\"\r\n                >\r\n                  <Controller\r\n                    name=\"type\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <KeycloakSelect\r\n                        className=\"keycloak__events_search__type_select\"\r\n                        data-testid=\"event-type-searchField\"\r\n                        chipGroupProps={{\r\n                          numChips: 1,\r\n                          expandedText: t(\"hide\"),\r\n                          collapsedText: t(\"showRemaining\"),\r\n                        }}\r\n                        variant={SelectVariant.typeaheadMulti}\r\n                        typeAheadAriaLabel=\"Select\"\r\n                        onToggle={(isOpen) => setSelectOpen(isOpen)}\r\n                        selections={field.value}\r\n                        onSelect={(selectedValue) => {\r\n                          const option = selectedValue.toString() as EventType;\r\n                          const changedValue = field.value.includes(option)\r\n                            ? field.value.filter(\r\n                                (item: string) => item !== option,\r\n                              )\r\n                            : [...field.value, option];\r\n\r\n                          field.onChange(changedValue);\r\n                        }}\r\n                        onClear={() => {\r\n                          field.onChange([]);\r\n                        }}\r\n                        isOpen={selectOpen}\r\n                        aria-labelledby={\"eventType\"}\r\n                        chipGroupComponent={\r\n                          <ChipGroup>\r\n                            {field.value.map((chip: string) => (\r\n                              <Chip\r\n                                key={chip}\r\n                                onClick={(event) => {\r\n                                  event.stopPropagation();\r\n                                  field.onChange(\r\n                                    field.value.filter(\r\n                                      (val: string) => val !== chip,\r\n                                    ),\r\n                                  );\r\n                                }}\r\n                              >\r\n                                {t(`eventTypes.${chip}.name`)}\r\n                              </Chip>\r\n                            ))}\r\n                          </ChipGroup>\r\n                        }\r\n                      >\r\n                        {events?.map((option) => (\r\n                          <SelectOption key={option} value={option}>\r\n                            {t(`eventTypes.${option}.name`)}\r\n                          </SelectOption>\r\n                        ))}\r\n                      </KeycloakSelect>\r\n                    )}\r\n                  />\r\n                </FormGroup>\r\n                {!client && (\r\n                  <TextControl\r\n                    name=\"client\"\r\n                    label={t(\"client\")}\r\n                    data-testid=\"client-searchField\"\r\n                  />\r\n                )}\r\n                <FormGroup\r\n                  label={t(\"dateFrom\")}\r\n                  fieldId=\"kc-dateFrom\"\r\n                  className=\"keycloak__events_search__form_label\"\r\n                >\r\n                  <Controller\r\n                    name=\"dateFrom\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <DatePicker\r\n                        className=\"pf-v5-u-w-100\"\r\n                        value={field.value}\r\n                        onChange={(_, value) => field.onChange(value)}\r\n                        inputProps={{ id: \"kc-dateFrom\" }}\r\n                      />\r\n                    )}\r\n                  />\r\n                </FormGroup>\r\n                <FormGroup\r\n                  label={t(\"dateTo\")}\r\n                  fieldId=\"kc-dateTo\"\r\n                  className=\"keycloak__events_search__form_label\"\r\n                >\r\n                  <Controller\r\n                    name=\"dateTo\"\r\n                    control={control}\r\n                    render={({ field }) => (\r\n                      <DatePicker\r\n                        className=\"pf-v5-u-w-100\"\r\n                        value={field.value}\r\n                        onChange={(_, value) => field.onChange(value)}\r\n                        inputProps={{ id: \"kc-dateTo\" }}\r\n                      />\r\n                    )}\r\n                  />\r\n                </FormGroup>\r\n                <TextControl\r\n                  name=\"ipAddress\"\r\n                  label={t(\"ipAddress\")}\r\n                  data-testid=\"ipAddress-searchField\"\r\n                />\r\n                <ActionGroup>\r\n                  <Button\r\n                    data-testid=\"search-events-btn\"\r\n                    variant=\"primary\"\r\n                    type=\"submit\"\r\n                    isDisabled={!isDirty}\r\n                  >\r\n                    {t(\"searchUserEventsBtn\")}\r\n                  </Button>\r\n                  <Button\r\n                    variant=\"secondary\"\r\n                    onClick={resetSearch}\r\n                    isDisabled={!isDirty}\r\n                  >\r\n                    {t(\"resetBtn\")}\r\n                  </Button>\r\n                </ActionGroup>\r\n              </Form>\r\n            </DropdownPanel>\r\n          </FlexItem>\r\n          <FlexItem>\r\n            {Object.entries(activeFilters).length > 0 && (\r\n              <div className=\"keycloak__searchChips pf-v5-u-ml-md\">\r\n                {Object.entries(activeFilters).map((filter) => {\r\n                  const [key, value] = filter as [\r\n                    keyof UserEventSearchForm,\r\n                    string | EventType[],\r\n                  ];\r\n\r\n                  if (\r\n                    (key === \"user\" && !!user) ||\r\n                    (key === \"client\" && !!client)\r\n                  ) {\r\n                    return null;\r\n                  }\r\n\r\n                  return (\r\n                    <ChipGroup\r\n                      className=\"pf-v5-u-mt-md pf-v5-u-mr-md\"\r\n                      key={key}\r\n                      categoryName={filterLabels[key]}\r\n                      onClick={() => removeFilter(key)}\r\n                      isClosable\r\n                    >\r\n                      {typeof value === \"string\" ? (\r\n                        <Chip isReadOnly>{value}</Chip>\r\n                      ) : (\r\n                        value.map((entry) => (\r\n                          <Chip\r\n                            key={entry}\r\n                            onClick={() => removeFilterValue(key, entry)}\r\n                          >\r\n                            {t(`eventTypes.${entry}.name`)}\r\n                          </Chip>\r\n                        ))\r\n                      )}\r\n                    </ChipGroup>\r\n                  );\r\n                })}\r\n              </div>\r\n            )}\r\n          </FlexItem>\r\n        </Flex>\r\n      </FormProvider>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <>\r\n      {!userEventsEnabled && <EventsBanners type=\"userEvents\" />}\r\n      <KeycloakDataTable\r\n        key={key}\r\n        loader={loader}\r\n        detailColumns={[\r\n          {\r\n            name: \"details\",\r\n            enabled: (event) => event.details !== undefined,\r\n            cellRenderer: DetailCell,\r\n          },\r\n        ]}\r\n        isPaginated\r\n        ariaLabelKey=\"titleEvents\"\r\n        toolbarItem={userEventSearchFormDisplay()}\r\n        columns={[\r\n          {\r\n            name: \"time\",\r\n            displayKey: \"time\",\r\n            cellRenderer: (row) =>\r\n              formatDate(new Date(row.time!), FORMAT_DATE_AND_TIME),\r\n          },\r\n          ...(!user\r\n            ? [\r\n                {\r\n                  name: \"userId\",\r\n                  cellRenderer: UserDetailLink,\r\n                },\r\n              ]\r\n            : []),\r\n          {\r\n            name: \"type\",\r\n            displayKey: \"eventType\",\r\n            cellRenderer: StatusRow,\r\n          },\r\n          {\r\n            name: \"ipAddress\",\r\n            displayKey: \"ipAddress\",\r\n            transforms: [cellWidth(10)],\r\n          },\r\n          ...(!client\r\n            ? [\r\n                {\r\n                  name: \"clientId\",\r\n                  displayKey: \"client\",\r\n                },\r\n              ]\r\n            : []),\r\n        ]}\r\n        emptyState={\r\n          <ListEmptyState\r\n            message={t(\"emptyUserEvents\")}\r\n            instructions={t(\"emptyUserEventsInstructions\")}\r\n            primaryActionText={t(\"refresh\")}\r\n            onPrimaryAction={() => setKey(key + 1)}\r\n          />\r\n        }\r\n        isSearching={Object.keys(activeFilters).length > 0}\r\n      />\r\n    </>\r\n  );\r\n};\r\n"],"names":["StatusRow","event","jsx","Tooltip","Icon","WarningTriangleIcon","CheckCircleIcon","DetailCell","jsxs","DescriptionList","key","value","DescriptionListGroup","DescriptionListTerm","DescriptionListDescription","UserDetailLink","t","useTranslation","realm","useRealm","Fragment","Link","toUser","UserEvents","user","client","adminClient","useAdminClient","localeSort","useLocaleSort","formatDate","useFormatDate","setKey","useState","searchDropdownOpen","setSearchDropdownOpen","selectOpen","setSelectOpen","events","setEvents","userEventsEnabled","setUserEventsEnabled","activeFilters","setActiveFilters","defaultValues","filterLabels","form","useForm","getValues","reset","isDirty","control","handleSubmit","useFetch","e","loader","first","max","onSubmit","commitFilters","resetSearch","removeFilter","formValues","removeFilterValue","valueToRemove","fieldValue","newFieldValue","val","newFilters","pickBy","EventsBanners","KeycloakDataTable","FormProvider","Flex","FlexItem","DropdownPanel","Form","TextControl","FormGroup","Controller","field","KeycloakSelect","SelectVariant","isOpen","selectedValue","option","changedValue","item","ChipGroup","chip","Chip","SelectOption","DatePicker","_","ActionGroup","Button","filter","entry","row","FORMAT_DATE_AND_TIME","cellWidth","ListEmptyState"],"mappings":"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"}