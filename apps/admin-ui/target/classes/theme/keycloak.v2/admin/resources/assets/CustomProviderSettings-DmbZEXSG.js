import{jsxs as l,jsx as e}from"react/jsx-runtime";import{a as I,a0 as x,l as U,O as v,R as b,S as P,W as C,Q as f,u as E,b as H,j as O,_ as j,d as D,e as L,y as R,m as q,p as z,P as G,A as Q,g as k,L as W,eL as F,n as B,o as J}from"./main-o1hptXRo.js";import{D as K}from"./DynamicComponents-CnLlz98z.js";import{F as M}from"./FormAccess-BnhQnYb9.js";import{u as X}from"./useParams-CGVhlaFZ.js";import{E as Y}from"./ExtendedHeader-tajt2h2R.js";import{S as Z}from"./SettingsCache-Cam5Obyz.js";import{useState as $}from"react";import"react-dom";import"./ClientSelect-BY77LEpN.js";import"./IdentityProviderSelect-rmWlUbIg.js";import"./GroupPickerDialog-U3luvxlw.js";import"./DataListItemRow-B_0B-ko6.js";import"./ActionListItem-Cy-NQlq4.js";import"./MultiLineInput-OP0faqms.js";import"./RoleMapping-BOcI-Nkp.js";import"./translationFormatter-DQJeO7lr.js";import"./ConfirmDialog-BkU7melV.js";import"./useLocaleSort-C-diWts5.js";import"./CodeEditor-C4IS5oxi.js";import"./ViewHeader-BDBsroi3.js";import"./isEqual-B7qkGgF1.js";const ee=()=>{const{t:r}=I(),a=x(),{control:o,watch:t}=a,d=t("config.fullSyncPeriod","-1"),c=t("config.changedSyncPeriod","-1");return l(U,{...a,children:[e(v,{label:r("periodicFullSync"),labelIcon:e(C,{helpText:r("periodicFullSyncHelp"),fieldLabelId:"periodicFullSync"}),fieldId:"kc-periodic-full-sync",hasNoPaddingTop:!0,children:e(b,{name:"config.fullSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(P,{id:"kc-periodic-full-sync","data-testid":"periodic-full-sync",onChange:(m,s)=>{i.onChange(s?"604800":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicFullSync")})})}),d!=="-1"&&e(f,{name:"config.fullSyncPeriod",label:r("fullSyncPeriod"),labelIcon:r("fullSyncPeriodHelp"),type:"number",min:-1,defaultValue:"604800"}),e(v,{label:r("periodicChangedUsersSync"),labelIcon:e(C,{helpText:r("periodicChangedUsersSyncHelp"),fieldLabelId:"periodicChangedUsersSync"}),fieldId:"kc-periodic-changed-users-sync",hasNoPaddingTop:!0,children:e(b,{name:"config.changedSyncPeriod",defaultValue:"-1",control:o,render:({field:i})=>e(P,{id:"kc-periodic-changed-users-sync","data-testid":"periodic-changed-users-sync",onChange:(m,s)=>{i.onChange(s?"86400":"-1")},isChecked:i.value!=="-1",label:r("on"),labelOff:r("off"),"aria-label":r("periodicChangedUsersSync")})})}),c!=="-1"&&e(f,{name:"config.changedSyncPeriod",label:r("changedUsersSyncPeriod"),labelIcon:r("changedUsersSyncHelp"),type:"number",min:-1,defaultValue:"86400"})]})};function ke(){const{adminClient:r}=E(),{t:a}=I(),{id:o,providerId:t}=X(),d=H(),c=O({mode:"onChange"}),{reset:i,setValue:m,handleSubmit:s,formState:{isDirty:w}}=c,{addAlert:T,addError:A}=j(),{realm:y,realmRepresentation:N}=D(),[V,_]=$(!0),g=(L().componentTypes?.["org.keycloak.storage.UserStorageProvider"]||[]).find(n=>n.id===t);R(async()=>{if(o)return await r.components.findOne({id:o})},n=>{if(n)q(n,m);else if(o)throw new Error(a("notFound"));_(!1)},[]);const h=async n=>{const S=B({...n,config:Object.fromEntries(Object.entries(n.config||{}).map(([p,u])=>[p,Array.isArray(u)?u:[u]])),providerId:t,providerType:"org.keycloak.storage.UserStorageProvider",parentId:N?.id});try{o?await r.components.update({id:o},S):(await r.components.create(S),d(F({realm:y}))),i({...n}),T(a(o?"userProviderSaveSuccess":"createUserProviderSuccess"),J.success)}catch(p){A(o?"userProviderSaveError":"createUserProviderError",p)}};return V?e(z,{}):l(U,{...c,children:[e(Y,{provider:t,save:()=>s(h)()}),e(G,{variant:"light",children:l(M,{role:"manage-realm",isHorizontal:!0,className:"keycloak__user-federation__custom-form",onSubmit:s(h),children:[e(f,{name:"name",label:a("uiDisplayName"),labelIcon:a("uiDisplayNameHelp"),rules:{required:a("validateName")}}),e(K,{properties:g?.properties||[]}),g?.metadata.synchronizable&&e(ee,{}),e(Z,{form:c,unWrap:!0}),l(Q,{children:[e(k,{isDisabled:!w,variant:"primary",type:"submit","data-testid":"custom-save",children:a("save")}),e(k,{variant:"link",component:n=>e(W,{...n,to:F({realm:y})}),"data-testid":"custom-cancel",children:a("cancel")})]})]})})]})}export{ke as default};
//# sourceMappingURL=CustomProviderSettings-DmbZEXSG.js.map
