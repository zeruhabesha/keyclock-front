{"version":3,"file":"RealmRoleTabs-D61llsy-.js","sources":["../../../../../../../src/realm-roles/UsersInRoleTab.tsx","../../../../../../../src/realm-roles/RealmRoleTabs.tsx"],"sourcesContent":["import { Button, PageSection, Popover } from \"@patternfly/react-core\";\r\nimport { QuestionCircleIcon } from \"@patternfly/react-icons\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useHelp } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport type { ClientRoleParams } from \"../clients/routes/ClientRole\";\r\nimport { ListEmptyState } from \"@keycloak/keycloak-ui-shared\";\r\nimport { KeycloakDataTable } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport { emptyFormatter, upperCaseFormatter } from \"../util\";\r\nimport { useParams } from \"../utils/useParams\";\r\n\r\nexport const UsersInRoleTab = () => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const navigate = useNavigate();\r\n  const { realm } = useRealm();\r\n\r\n  const { t } = useTranslation();\r\n  const { id, clientId } = useParams<ClientRoleParams>();\r\n\r\n  const loader = async (first?: number, max?: number) => {\r\n    const role = await adminClient.roles.findOneById({ id: id });\r\n    if (!role) {\r\n      throw new Error(t(\"notFound\"));\r\n    }\r\n\r\n    if (role.clientRole) {\r\n      return adminClient.clients.findUsersWithRole({\r\n        roleName: role.name!,\r\n        id: clientId,\r\n        briefRepresentation: true,\r\n        first,\r\n        max,\r\n      });\r\n    }\r\n\r\n    return adminClient.roles.findUsersWithRole({\r\n      name: role.name!,\r\n      briefRepresentation: true,\r\n      first,\r\n      max,\r\n    });\r\n  };\r\n\r\n  const { enabled } = useHelp();\r\n\r\n  return (\r\n    <PageSection data-testid=\"users-page\" variant=\"light\">\r\n      <KeycloakDataTable\r\n        isPaginated\r\n        loader={loader}\r\n        ariaLabelKey=\"roleList\"\r\n        searchPlaceholderKey=\"\"\r\n        data-testid=\"users-in-role-table\"\r\n        toolbarItem={\r\n          enabled && (\r\n            <Popover\r\n              aria-label=\"Basic popover\"\r\n              position=\"bottom\"\r\n              bodyContent={\r\n                <div>\r\n                  {t(\"whoWillAppearPopoverTextRoles\")}\r\n                  <Button\r\n                    className=\"kc-groups-link\"\r\n                    variant=\"link\"\r\n                    onClick={() => navigate(`/${realm}/groups`)}\r\n                  >\r\n                    {t(\"groups\")}\r\n                  </Button>\r\n                  {t(\"or\")}\r\n                  <Button\r\n                    className=\"kc-users-link\"\r\n                    variant=\"link\"\r\n                    onClick={() => navigate(`/${realm}/users`)}\r\n                  >\r\n                    {t(\"users\")}.\r\n                  </Button>\r\n                </div>\r\n              }\r\n              footerContent={t(\"whoWillAppearPopoverFooterText\")}\r\n            >\r\n              <Button\r\n                variant=\"link\"\r\n                className=\"kc-who-will-appear-button\"\r\n                key=\"who-will-appear-button\"\r\n                icon={<QuestionCircleIcon />}\r\n              >\r\n                {t(\"whoWillAppearLinkTextRoles\")}\r\n              </Button>\r\n            </Popover>\r\n          )\r\n        }\r\n        emptyState={\r\n          <ListEmptyState\r\n            hasIcon={true}\r\n            message={t(\"noDirectUsers\")}\r\n            instructions={\r\n              <div>\r\n                {t(\"noUsersEmptyStateDescription\")}\r\n                <Button\r\n                  className=\"kc-groups-link-empty-state\"\r\n                  variant=\"link\"\r\n                  onClick={() => navigate(`/${realm}/groups`)}\r\n                >\r\n                  {t(\"groups\")}\r\n                </Button>\r\n                {t(\"or\")}\r\n                <Button\r\n                  className=\"kc-users-link-empty-state\"\r\n                  variant=\"link\"\r\n                  onClick={() => navigate(`/${realm}/users`)}\r\n                >\r\n                  {t(\"users\")}\r\n                </Button>\r\n                {t(\"noUsersEmptyStateDescriptionContinued\")}\r\n              </div>\r\n            }\r\n          />\r\n        }\r\n        columns={[\r\n          {\r\n            name: \"username\",\r\n            displayKey: \"userName\",\r\n            cellFormatters: [emptyFormatter()],\r\n          },\r\n          {\r\n            name: \"email\",\r\n            displayKey: \"email\",\r\n            cellFormatters: [emptyFormatter()],\r\n          },\r\n          {\r\n            name: \"lastName\",\r\n            displayKey: \"lastName\",\r\n            cellFormatters: [emptyFormatter()],\r\n          },\r\n          {\r\n            name: \"firstName\",\r\n            displayKey: \"firstName\",\r\n            cellFormatters: [upperCaseFormatter(), emptyFormatter()],\r\n          },\r\n        ]}\r\n      />\r\n    </PageSection>\r\n  );\r\n};\r\n","import type RoleRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/roleRepresentation\";\r\nimport {\r\n  KeycloakSpinner,\r\n  useAlerts,\r\n  useFetch,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  AlertVariant,\r\n  ButtonVariant,\r\n  DropdownItem,\r\n  PageSection,\r\n  Tab,\r\n  TabTitleText,\r\n} from \"@patternfly/react-core\";\r\nimport { useState } from \"react\";\r\nimport {\r\n  FormProvider,\r\n  SubmitHandler,\r\n  useForm,\r\n  useWatch,\r\n} from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useMatch, useNavigate } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport { toClient } from \"../clients/routes/Client\";\r\nimport {\r\n  ClientRoleParams,\r\n  ClientRoleRoute,\r\n  ClientRoleTab,\r\n  toClientRole,\r\n} from \"../clients/routes/ClientRole\";\r\nimport { useConfirmDialog } from \"../components/confirm-dialog/ConfirmDialog\";\r\nimport {\r\n  AttributeForm,\r\n  AttributesForm,\r\n} from \"../components/key-value-form/AttributeForm\";\r\nimport {\r\n  KeyValueType,\r\n  arrayToKeyValue,\r\n  keyValueToArray,\r\n} from \"../components/key-value-form/key-value-convert\";\r\nimport { PermissionsTab } from \"../components/permission-tab/PermissionTab\";\r\nimport { RoleForm } from \"../components/role-form/RoleForm\";\r\nimport { RoleMapping } from \"../components/role-mapping/RoleMapping\";\r\nimport {\r\n  RoutableTabs,\r\n  useRoutableTab,\r\n} from \"../components/routable-tabs/RoutableTabs\";\r\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\r\nimport { useAccess } from \"../context/access/Access\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport { AdminEvents } from \"../events/AdminEvents\";\r\nimport useIsFeatureEnabled, { Feature } from \"../utils/useIsFeatureEnabled\";\r\nimport { useParams } from \"../utils/useParams\";\r\nimport { UsersInRoleTab } from \"./UsersInRoleTab\";\r\nimport { RealmRoleRoute, RealmRoleTab, toRealmRole } from \"./routes/RealmRole\";\r\nimport { toRealmRoles } from \"./routes/RealmRoles\";\r\n\r\nexport default function RealmRoleTabs() {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const isFeatureEnabled = useIsFeatureEnabled();\r\n  const { t } = useTranslation();\r\n  const form = useForm<AttributeForm>({\r\n    mode: \"onChange\",\r\n  });\r\n  const { control, reset, setValue } = form;\r\n  const navigate = useNavigate();\r\n\r\n  const { id, clientId } = useParams<ClientRoleParams>();\r\n  const { realm: realmName, realmRepresentation: realm } = useRealm();\r\n  const [key, setKey] = useState(0);\r\n  const [attributes, setAttributes] = useState<KeyValueType[] | undefined>();\r\n\r\n  const refresh = () => setKey(key + 1);\r\n\r\n  const { addAlert, addError } = useAlerts();\r\n\r\n  const { hasAccess } = useAccess();\r\n  const canViewPermissionsTab = hasAccess(\r\n    \"query-clients\",\r\n    \"manage-authorization\",\r\n  );\r\n\r\n  const [canManageClientRole, setCanManageClientRole] = useState(false);\r\n\r\n  const convert = (role: RoleRepresentation) => {\r\n    const { attributes, ...rest } = role;\r\n    return {\r\n      attributes: arrayToKeyValue(attributes),\r\n      ...rest,\r\n    };\r\n  };\r\n\r\n  const roleName = useWatch({\r\n    control,\r\n    defaultValue: undefined,\r\n    name: \"name\",\r\n  });\r\n\r\n  const composites = useWatch({\r\n    control,\r\n    defaultValue: false,\r\n    name: \"composite\",\r\n  });\r\n\r\n  useFetch(\r\n    async () => adminClient.roles.findOneById({ id }),\r\n    (role) => {\r\n      if (!role) {\r\n        throw new Error(t(\"notFound\"));\r\n      }\r\n\r\n      const convertedRole = convert(role);\r\n\r\n      reset(convertedRole);\r\n      setAttributes(convertedRole.attributes);\r\n    },\r\n    [key],\r\n  );\r\n\r\n  useFetch(\r\n    async () => adminClient.clients.findOne({ id: clientId }),\r\n    (client) => {\r\n      if (clientId) setCanManageClientRole(client?.access?.manage as boolean);\r\n    },\r\n    [],\r\n  );\r\n\r\n  const onSubmit: SubmitHandler<AttributeForm> = async (formValues) => {\r\n    try {\r\n      const { attributes, ...rest } = formValues;\r\n      const roleRepresentation: RoleRepresentation = rest;\r\n\r\n      roleRepresentation.name = roleRepresentation.name?.trim();\r\n      roleRepresentation.attributes = keyValueToArray(attributes);\r\n\r\n      if (!clientId) {\r\n        await adminClient.roles.updateById({ id }, roleRepresentation);\r\n      } else {\r\n        await adminClient.clients.updateRole(\r\n          { id: clientId, roleName: formValues.name! },\r\n          roleRepresentation,\r\n        );\r\n      }\r\n\r\n      setAttributes(attributes);\r\n      addAlert(t(\"roleSaveSuccess\"), AlertVariant.success);\r\n    } catch (error) {\r\n      addError(\"roleSaveError\", error);\r\n    }\r\n  };\r\n\r\n  const realmRoleMatch = useMatch(RealmRoleRoute.path);\r\n  const clientRoleMatch = useMatch(ClientRoleRoute.path);\r\n\r\n  const toOverview = () => {\r\n    if (realmRoleMatch) {\r\n      return toRealmRoles({ realm: realmName });\r\n    }\r\n\r\n    if (clientRoleMatch) {\r\n      return toClient({\r\n        realm: realmName,\r\n        clientId: clientRoleMatch.params.clientId!,\r\n        tab: \"roles\",\r\n      });\r\n    }\r\n\r\n    throw new Error(\"Roles overview route could not be determined.\");\r\n  };\r\n\r\n  const toTab = (tab: RealmRoleTab | ClientRoleTab) => {\r\n    if (realmRoleMatch) {\r\n      return toRealmRole({\r\n        realm: realmName,\r\n        id,\r\n        tab,\r\n      });\r\n    }\r\n\r\n    if (clientRoleMatch) {\r\n      return toClientRole({\r\n        realm: realmName,\r\n        id,\r\n        clientId: clientRoleMatch.params.clientId!,\r\n        tab: tab as ClientRoleTab,\r\n      });\r\n    }\r\n\r\n    throw new Error(\"Route could not be determined.\");\r\n  };\r\n\r\n  const detailsTab = useRoutableTab(toTab(\"details\"));\r\n  const associatedRolesTab = useRoutableTab(toTab(\"associated-roles\"));\r\n  const attributesTab = useRoutableTab(toTab(\"attributes\"));\r\n  const usersInRoleTab = useRoutableTab(toTab(\"users-in-role\"));\r\n  const permissionsTab = useRoutableTab(toTab(\"permissions\"));\r\n  const eventsTab = useRoutableTab(toTab(\"events\"));\r\n\r\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\r\n    titleKey: \"roleDeleteConfirm\",\r\n    messageKey: t(\"roleDeleteConfirmDialog\", {\r\n      selectedRoleName: roleName || t(\"createRole\"),\r\n    }),\r\n    continueButtonLabel: \"delete\",\r\n    continueButtonVariant: ButtonVariant.danger,\r\n    onConfirm: async () => {\r\n      try {\r\n        if (!clientId) {\r\n          await adminClient.roles.delById({ id });\r\n        } else {\r\n          await adminClient.clients.delRole({\r\n            id: clientId,\r\n            roleName: roleName!,\r\n          });\r\n        }\r\n        addAlert(t(\"roleDeletedSuccess\"), AlertVariant.success);\r\n        navigate(toOverview());\r\n      } catch (error) {\r\n        addError(\"roleDeleteError\", error);\r\n      }\r\n    },\r\n  });\r\n\r\n  const addComposites = async (composites: RoleRepresentation[]) => {\r\n    try {\r\n      await adminClient.roles.createComposite(\r\n        { roleId: id, realm: realm!.realm },\r\n        composites,\r\n      );\r\n      refresh();\r\n      navigate(toTab(\"associated-roles\"));\r\n      addAlert(t(\"addAssociatedRolesSuccess\"), AlertVariant.success);\r\n    } catch (error) {\r\n      addError(\"addAssociatedRolesError\", error);\r\n    }\r\n  };\r\n\r\n  const isDefaultRole = (name: string | undefined) =>\r\n    realm?.defaultRole && realm.defaultRole!.name === name;\r\n\r\n  if (!realm) {\r\n    return <KeycloakSpinner />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <DeleteConfirm />\r\n      <ViewHeader\r\n        titleKey={roleName!}\r\n        badges={[\r\n          {\r\n            id: \"composite-role-badge\",\r\n            text: composites ? t(\"composite\") : \"\",\r\n            readonly: true,\r\n          },\r\n        ]}\r\n        actionsDropdownId=\"roles-actions-dropdown\"\r\n        dropdownItems={[\r\n          <DropdownItem\r\n            key=\"delete-role\"\r\n            component=\"button\"\r\n            onClick={() => {\r\n              toggleDeleteDialog();\r\n            }}\r\n          >\r\n            {t(\"deleteRole\")}\r\n          </DropdownItem>,\r\n        ]}\r\n        divider={false}\r\n      />\r\n      <PageSection variant=\"light\" className=\"pf-v5-u-p-0\">\r\n        <FormProvider {...form}>\r\n          <RoutableTabs isBox mountOnEnter defaultLocation={toTab(\"details\")}>\r\n            <Tab\r\n              title={<TabTitleText>{t(\"details\")}</TabTitleText>}\r\n              {...detailsTab}\r\n            >\r\n              <RoleForm\r\n                form={form}\r\n                onSubmit={onSubmit}\r\n                role={clientRoleMatch ? \"manage-clients\" : \"manage-realm\"}\r\n                cancelLink={\r\n                  clientRoleMatch\r\n                    ? toClient({ realm: realmName, clientId, tab: \"roles\" })\r\n                    : toRealmRoles({ realm: realmName })\r\n                }\r\n                editMode\r\n              />\r\n            </Tab>\r\n            <Tab\r\n              data-testid=\"associatedRolesTab\"\r\n              title={<TabTitleText>{t(\"associatedRolesText\")}</TabTitleText>}\r\n              {...associatedRolesTab}\r\n            >\r\n              <RoleMapping\r\n                name={roleName!}\r\n                id={id}\r\n                type=\"roles\"\r\n                isManager\r\n                save={(rows) => addComposites(rows.map((r) => r.role))}\r\n              />\r\n            </Tab>\r\n            {!isDefaultRole(roleName) && (\r\n              <Tab\r\n                data-testid=\"attributesTab\"\r\n                className=\"kc-attributes-tab\"\r\n                title={<TabTitleText>{t(\"attributes\")}</TabTitleText>}\r\n                {...attributesTab}\r\n              >\r\n                <AttributesForm\r\n                  form={form}\r\n                  save={onSubmit}\r\n                  fineGrainedAccess={canManageClientRole}\r\n                  reset={() =>\r\n                    setValue(\"attributes\", attributes, { shouldDirty: false })\r\n                  }\r\n                />\r\n              </Tab>\r\n            )}\r\n            {!isDefaultRole(roleName) && (\r\n              <Tab\r\n                data-testid=\"usersInRoleTab\"\r\n                title={<TabTitleText>{t(\"usersInRole\")}</TabTitleText>}\r\n                {...usersInRoleTab}\r\n              >\r\n                <UsersInRoleTab data-cy=\"users-in-role-tab\" />\r\n              </Tab>\r\n            )}\r\n            {isFeatureEnabled(Feature.AdminFineGrainedAuthz) &&\r\n              canViewPermissionsTab && (\r\n                <Tab\r\n                  title={<TabTitleText>{t(\"permissions\")}</TabTitleText>}\r\n                  {...permissionsTab}\r\n                >\r\n                  <PermissionsTab id={id} type=\"roles\" />\r\n                </Tab>\r\n              )}\r\n            {hasAccess(\"view-events\") && (\r\n              <Tab\r\n                data-testid=\"admin-events-tab\"\r\n                title={<TabTitleText>{t(\"adminEvents\")}</TabTitleText>}\r\n                {...eventsTab}\r\n              >\r\n                <AdminEvents resourcePath={`roles-by-id/${id}`} />\r\n              </Tab>\r\n            )}\r\n          </RoutableTabs>\r\n        </FormProvider>\r\n      </PageSection>\r\n    </>\r\n  );\r\n}\r\n"],"names":["UsersInRoleTab","adminClient","useAdminClient","navigate","useNavigate","realm","useRealm","t","useTranslation","id","clientId","useParams","loader","first","max","role","enabled","useHelp","jsx","PageSection","KeycloakDataTable","Popover","Button","jsxs","QuestionCircleIcon","ListEmptyState","emptyFormatter","upperCaseFormatter","RealmRoleTabs","isFeatureEnabled","useIsFeatureEnabled","form","useForm","control","reset","setValue","realmName","key","setKey","useState","attributes","setAttributes","refresh","addAlert","addError","useAlerts","hasAccess","useAccess","canViewPermissionsTab","canManageClientRole","setCanManageClientRole","convert","rest","arrayToKeyValue","roleName","useWatch","composites","useFetch","convertedRole","client","onSubmit","formValues","roleRepresentation","keyValueToArray","AlertVariant","error","realmRoleMatch","useMatch","RealmRoleRoute","clientRoleMatch","ClientRoleRoute","toOverview","toRealmRoles","toClient","toTab","tab","toRealmRole","toClientRole","detailsTab","useRoutableTab","associatedRolesTab","attributesTab","usersInRoleTab","permissionsTab","eventsTab","toggleDeleteDialog","DeleteConfirm","useConfirmDialog","ButtonVariant","addComposites","isDefaultRole","name","Fragment","ViewHeader","DropdownItem","FormProvider","RoutableTabs","Tab","TabTitleText","RoleForm","RoleMapping","rows","AttributesForm","Feature","PermissionsTab","AdminEvents","KeycloakSpinner"],"mappings":"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"}