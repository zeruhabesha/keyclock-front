import{jsxs as C,Fragment as K,jsx as e}from"react/jsx-runtime";import{u as A,b as U,a as B,_ as E,c as R,y as k,B as V,o as w,x as j,v as N,T as _,g as z,L as I,j as H,d as O,e$ as M,p as $,l as q,P as F,f0 as P}from"./main-o1hptXRo.js";import{useState as m}from"react";import{u as T,R as G}from"./RoutableTabs-DyhWhd6v.js";import{U as J,s as Q}from"./UserFederationLdapForm-CTqZPRi6.js";import{u as W}from"./ConfirmDialog-BkU7melV.js";import{u as X,m as Y}from"./useLocaleSort-C-diWts5.js";import{E as Z}from"./ExtendedHeader-tajt2h2R.js";import{a as D,b as x}from"./Tabs-DSwQhKoJ.js";import"react-dom";import"./PageHandler-B1ed5nYb.js";import"./DynamicComponents-CnLlz98z.js";import"./ClientSelect-BY77LEpN.js";import"./IdentityProviderSelect-rmWlUbIg.js";import"./GroupPickerDialog-U3luvxlw.js";import"./DataListItemRow-B_0B-ko6.js";import"./ActionListItem-Cy-NQlq4.js";import"./MultiLineInput-OP0faqms.js";import"./RoleMapping-BOcI-Nkp.js";import"./translationFormatter-DQJeO7lr.js";import"./CodeEditor-C4IS5oxi.js";import"./useParams-CGVhlaFZ.js";import"./constants-BclHbWtx.js";import"./FormAccess-BnhQnYb9.js";import"./SettingsCache-Cam5Obyz.js";import"./ViewHeader-BDBsroi3.js";import"./isEqual-B7qkGgF1.js";const ee=({toDetail:i,...a})=>e(I,{to:i(a.id),children:a.name}),te=({toCreate:i,toDetail:a})=>{const{adminClient:o}=A(),n=U(),{t}=B(),{addAlert:l,addError:u}=E(),[p,g]=m(0),f=()=>g(p+1),[y,h]=m([]),b=X(),{id:v}=R(),[c,d]=m();k(()=>o.components.find({parent:v,type:"org.keycloak.storage.ldap.mappers.LDAPStorageMapper"}),s=>{h(b(s.map(L=>({...L,name:L.name,type:L.providerId})),Y("name")))},[p]);const[r,S]=W({titleKey:t("deleteMappingTitle",{mapperId:c?.id}),messageKey:"deleteMappingConfirm",continueButtonLabel:"delete",continueButtonVariant:V.danger,onConfirm:async()=>{try{await o.components.del({id:c.id}),f(),l(t("mappingDeletedSuccess"),w.success),d(void 0)}catch(s){u("mappingDeletedError",s)}}});return C(K,{children:[e(S,{}),e(j,{loader:y,ariaLabelKey:"ldapMappersList",searchPlaceholderKey:"searchForMapper",toolbarItem:e(_,{children:e(z,{"data-testid":"add-mapper-btn",variant:"primary",component:s=>e(I,{...s,to:i}),children:t("addMapper")})}),actions:[{title:t("delete"),onRowClick:s=>{d(s),r()}}],columns:[{name:"name",cellRenderer:s=>e(ee,{...s,toDetail:a})},{name:"type"}],emptyState:e(N,{message:t("emptyMappers"),instructions:t("emptyMappersInstructions"),primaryActionText:t("emptyPrimaryAction"),onPrimaryAction:()=>n(i)})},p)]})};function Ae(){const{adminClient:i}=A(),{t:a}=B(),o=H({mode:"onChange"}),{realm:n}=O(),{id:t}=R(),{addAlert:l,addError:u}=E(),[p,g]=m(),[f,y]=m(0),h=()=>y(r=>r+1);k(()=>i.components.findOne({id:t}),r=>{if(!r)throw new Error(a("notFound"));g(r),c(r)},[t,f]);const b=T(M({realm:n,id:t,tab:"settings"})),v=T(M({realm:n,id:t,tab:"mappers"})),c=r=>{o.reset({}),o.reset(r),o.setValue("config.periodicChangedUsersSync",r.config?.changedSyncPeriod?.[0]!=="-1"),o.setValue("config.periodicFullSync",r.config?.fullSyncPeriod?.[0]!=="-1")},d=async r=>{try{await i.components.update({id:t},Q(r)),l(a("userProviderSaveSuccess"),w.success),h()}catch(S){u("userProviderSaveError",S)}};return p?C(q,{...o,children:[e(Z,{provider:"LDAP",noDivider:!0,editMode:p.config?.editMode,save:()=>o.handleSubmit(d)()}),e(F,{variant:"light",className:"pf-v5-u-p-0",children:C(G,{defaultLocation:M({realm:n,id:t,tab:"settings"}),isBox:!0,children:[e(D,{id:"settings",title:e(x,{children:a("settings")}),...b,children:e(F,{variant:"light",children:e(J,{id:t,onSubmit:d})})}),e(D,{id:"mappers",title:e(x,{children:a("mappers")}),"data-testid":"ldap-mappers-tab",...v,children:e(te,{toCreate:P({realm:n,id:t,mapperId:"new"}),toDetail:r=>P({realm:n,id:t,mapperId:r})})})]})})]}):e($,{})}export{Ae as default};
//# sourceMappingURL=UserFederationLdapSettings-XE-h2J8q.js.map
