{"version":3,"file":"DuplicateFlowModal-CAh-jnv6.js","sources":["../../../../../../../../../node_modules/.pnpm/@patternfly+react-icons@5.4_f39c5b970058b42208dac3bfc1f9d8fb/node_modules/@patternfly/react-icons/dist/esm/icons/cog-icon.js","../../../../../../../src/authentication/constants.ts","../../../../../../../src/authentication/BindFlowDialog.tsx","../../../../../../../src/authentication/DuplicateFlowModal.tsx"],"sourcesContent":["import { createIcon } from '../createIcon';\n\nexport const CogIconConfig = {\n  name: 'CogIcon',\n  height: 512,\n  width: 512,\n  svgPath: 'M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z',\n  yOffset: 0,\n  xOffset: 0,\n};\n\nexport const CogIcon = createIcon(CogIconConfig);\n\nexport default CogIcon;","import AuthenticationFlowRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/authenticationFlowRepresentation\";\r\nimport RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\r\n\r\ntype UsedBy = \"SPECIFIC_CLIENTS\" | \"SPECIFIC_PROVIDERS\" | \"DEFAULT\";\r\n\r\nexport type AuthenticationType = AuthenticationFlowRepresentation & {\r\n  usedBy?: { type?: UsedBy; values: string[] };\r\n  realm: RealmRepresentation;\r\n};\r\n\r\nexport const REALM_FLOWS = new Map<string, string>([\r\n  [\"browserFlow\", \"browser\"],\r\n  [\"registrationFlow\", \"registration\"],\r\n  [\"directGrantFlow\", \"direct grant\"],\r\n  [\"resetCredentialsFlow\", \"reset credentials\"],\r\n  [\"clientAuthenticationFlow\", \"clients\"],\r\n  [\"dockerAuthenticationFlow\", \"docker auth\"],\r\n  [\"firstBrokerLoginFlow\", \"firstBrokerLogin\"],\r\n]);\r\n","import type RealmRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/realmRepresentation\";\r\nimport { SelectControl, useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  Form,\r\n  Modal,\r\n} from \"@patternfly/react-core\";\r\nimport { FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport { REALM_FLOWS } from \"./constants\";\r\n\r\ntype BindingForm = {\r\n  bindingType: keyof RealmRepresentation;\r\n};\r\n\r\ntype BindFlowDialogProps = {\r\n  flowAlias: string;\r\n  onClose: (used?: boolean) => void;\r\n};\r\n\r\nexport const BindFlowDialog = ({ flowAlias, onClose }: BindFlowDialogProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const form = useForm<BindingForm>();\r\n  const { addAlert, addError } = useAlerts();\r\n  const { realm, realmRepresentation: realmRep, refresh } = useRealm();\r\n\r\n  const onSubmit = async ({ bindingType }: BindingForm) => {\r\n    try {\r\n      await adminClient.realms.update(\r\n        { realm },\r\n        { ...realmRep, [bindingType]: flowAlias },\r\n      );\r\n      refresh();\r\n      addAlert(t(\"updateFlowSuccess\"), AlertVariant.success);\r\n    } catch (error) {\r\n      addError(\"updateFlowError\", error);\r\n    }\r\n\r\n    onClose(true);\r\n  };\r\n\r\n  const flowKeys = Array.from(REALM_FLOWS.keys());\r\n\r\n  return (\r\n    <Modal\r\n      title={t(\"bindFlow\")}\r\n      variant=\"small\"\r\n      onClose={() => onClose()}\r\n      actions={[\r\n        <Button key=\"confirm\" data-testid=\"save\" type=\"submit\" form=\"bind-form\">\r\n          {t(\"save\")}\r\n        </Button>,\r\n        <Button\r\n          data-testid=\"cancel\"\r\n          key=\"cancel\"\r\n          variant={ButtonVariant.link}\r\n          onClick={() => onClose()}\r\n        >\r\n          {t(\"cancel\")}\r\n        </Button>,\r\n      ]}\r\n      isOpen\r\n    >\r\n      <Form id=\"bind-form\" isHorizontal onSubmit={form.handleSubmit(onSubmit)}>\r\n        <FormProvider {...form}>\r\n          <SelectControl\r\n            id=\"chooseBindingType\"\r\n            name=\"bindingType\"\r\n            label={t(\"chooseBindingType\")}\r\n            options={flowKeys\r\n              .filter((f) => f !== \"dockerAuthenticationFlow\")\r\n              .map((key) => ({\r\n                key,\r\n                value: t(`flow.${REALM_FLOWS.get(key)}`),\r\n              }))}\r\n            controller={{ defaultValue: flowKeys[0] }}\r\n            menuAppendTo=\"parent\"\r\n            aria-label={t(\"chooseBindingType\")}\r\n          />\r\n        </FormProvider>\r\n      </Form>\r\n    </Modal>\r\n  );\r\n};\r\n","import AuthenticationFlowRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/authenticationFlowRepresentation\";\r\nimport {\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  Form,\r\n  Modal,\r\n  ModalVariant,\r\n} from \"@patternfly/react-core\";\r\nimport { FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport { NameDescription } from \"./form/NameDescription\";\r\nimport { toFlow } from \"./routes/Flow\";\r\n\r\ntype DuplicateFlowModalProps = {\r\n  name: string;\r\n  description: string;\r\n  toggleDialog: () => void;\r\n  onComplete: () => void;\r\n};\r\n\r\nexport const DuplicateFlowModal = ({\r\n  name,\r\n  description,\r\n  toggleDialog,\r\n  onComplete,\r\n}: DuplicateFlowModalProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const form = useForm<AuthenticationFlowRepresentation>({\r\n    mode: \"onChange\",\r\n    defaultValues: {\r\n      alias: t(\"copyOf\", { name }),\r\n      description: description,\r\n    },\r\n  });\r\n  const { getValues, handleSubmit } = form;\r\n  const { addAlert, addError } = useAlerts();\r\n  const navigate = useNavigate();\r\n  const { realm } = useRealm();\r\n\r\n  const onSubmit = async () => {\r\n    const form = getValues();\r\n    try {\r\n      await adminClient.authenticationManagement.copyFlow({\r\n        flow: name,\r\n        newName: form.alias!,\r\n      });\r\n      const newFlow = (\r\n        await adminClient.authenticationManagement.getFlows()\r\n      ).find((flow) => flow.alias === form.alias)!;\r\n\r\n      if (form.description !== description) {\r\n        newFlow.description = form.description;\r\n        await adminClient.authenticationManagement.updateFlow(\r\n          { flowId: newFlow.id! },\r\n          newFlow,\r\n        );\r\n      }\r\n      addAlert(t(\"copyFlowSuccess\"), AlertVariant.success);\r\n      navigate(\r\n        toFlow({\r\n          realm,\r\n          id: newFlow.id!,\r\n          usedBy: \"notInUse\",\r\n          builtIn: newFlow.builtIn ? \"builtIn\" : undefined,\r\n        }),\r\n      );\r\n    } catch (error) {\r\n      addError(\"copyFlowError\", error);\r\n    }\r\n    onComplete();\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      title={t(\"duplicateFlow\")}\r\n      onClose={toggleDialog}\r\n      variant={ModalVariant.small}\r\n      actions={[\r\n        <Button\r\n          key=\"confirm\"\r\n          data-testid=\"confirm\"\r\n          type=\"submit\"\r\n          form=\"duplicate-flow-form\"\r\n        >\r\n          {t(\"duplicate\")}\r\n        </Button>,\r\n        <Button\r\n          key=\"cancel\"\r\n          data-testid=\"cancel\"\r\n          variant={ButtonVariant.link}\r\n          onClick={toggleDialog}\r\n        >\r\n          {t(\"cancel\")}\r\n        </Button>,\r\n      ]}\r\n      isOpen\r\n    >\r\n      <FormProvider {...form}>\r\n        <Form\r\n          id=\"duplicate-flow-form\"\r\n          onSubmit={handleSubmit(onSubmit)}\r\n          isHorizontal\r\n        >\r\n          <NameDescription />\r\n        </Form>\r\n      </FormProvider>\r\n    </Modal>\r\n  );\r\n};\r\n"],"names":["CogIconConfig","CogIcon","createIcon","REALM_FLOWS","BindFlowDialog","flowAlias","onClose","adminClient","useAdminClient","t","useTranslation","form","useForm","addAlert","addError","useAlerts","realm","realmRep","refresh","useRealm","onSubmit","bindingType","AlertVariant","error","flowKeys","jsx","Modal","Button","ButtonVariant","Form","FormProvider","SelectControl","f","key","DuplicateFlowModal","name","description","toggleDialog","onComplete","getValues","handleSubmit","navigate","useNavigate","newFlow","flow","toFlow","ModalVariant","NameDescription"],"mappings":"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","x_google_ignoreList":[0]}