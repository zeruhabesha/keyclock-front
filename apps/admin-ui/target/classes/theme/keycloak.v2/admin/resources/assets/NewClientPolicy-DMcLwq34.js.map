{"version":3,"file":"NewClientPolicy-DMcLwq34.js","sources":["../../../../../../../src/realm-settings/AddClientProfileModal.tsx","../../../../../../../src/realm-settings/NewClientPolicy.tsx"],"sourcesContent":["import type ClientProfileRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/clientProfileRepresentation\";\r\nimport type RoleRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/roleRepresentation\";\r\nimport { KeycloakDataTable, useFetch } from \"@keycloak/keycloak-ui-shared\";\r\nimport { Button, Label, Modal, ModalVariant } from \"@patternfly/react-core\";\r\nimport { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport { KeycloakSpinner } from \"@keycloak/keycloak-ui-shared\";\r\nimport { ListEmptyState } from \"@keycloak/keycloak-ui-shared\";\r\nimport { translationFormatter } from \"../utils/translationFormatter\";\r\n\r\ntype ClientProfile = ClientProfileRepresentation & {\r\n  global: boolean;\r\n};\r\n\r\nconst AliasRenderer = ({ name, global }: ClientProfile) => {\r\n  const { t } = useTranslation();\r\n\r\n  return (\r\n    <>\r\n      {name} {global && <Label color=\"blue\">{t(\"global\")}</Label>}\r\n    </>\r\n  );\r\n};\r\n\r\nexport type AddClientProfileModalProps = {\r\n  open: boolean;\r\n  toggleDialog: () => void;\r\n  onConfirm: (newReps: RoleRepresentation[]) => void;\r\n  allProfiles: string[];\r\n};\r\n\r\nexport const AddClientProfileModal = (props: AddClientProfileModalProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const [selectedRows, setSelectedRows] = useState<RoleRepresentation[]>([]);\r\n\r\n  const [tableProfiles, setTableProfiles] = useState<ClientProfile[]>();\r\n\r\n  useFetch(\r\n    () =>\r\n      adminClient.clientPolicies.listProfiles({\r\n        includeGlobalProfiles: true,\r\n      }),\r\n    (allProfiles) => {\r\n      const globalProfiles = allProfiles.globalProfiles?.map(\r\n        (globalProfiles) => ({\r\n          id: globalProfiles.name,\r\n          ...globalProfiles,\r\n          global: true,\r\n        }),\r\n      );\r\n\r\n      const profiles = allProfiles.profiles?.map((profiles) => ({\r\n        ...profiles,\r\n        global: false,\r\n      }));\r\n\r\n      setTableProfiles([...(globalProfiles ?? []), ...(profiles ?? [])]);\r\n    },\r\n    [],\r\n  );\r\n\r\n  const loader = async () =>\r\n    tableProfiles?.filter((item) => !props.allProfiles.includes(item.name!)) ??\r\n    [];\r\n\r\n  if (!tableProfiles) {\r\n    return <KeycloakSpinner />;\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      data-testid=\"addClientProfile\"\r\n      title={t(\"addClientProfile\")}\r\n      isOpen={props.open}\r\n      onClose={props.toggleDialog}\r\n      variant={ModalVariant.large}\r\n      actions={[\r\n        <Button\r\n          key=\"add\"\r\n          data-testid=\"add-client-profile-button\"\r\n          variant=\"primary\"\r\n          isDisabled={!selectedRows.length}\r\n          onClick={() => {\r\n            props.toggleDialog();\r\n            props.onConfirm(selectedRows);\r\n          }}\r\n        >\r\n          {t(\"add\")}\r\n        </Button>,\r\n        <Button\r\n          key=\"cancel\"\r\n          variant=\"link\"\r\n          onClick={() => {\r\n            props.toggleDialog();\r\n          }}\r\n        >\r\n          {t(\"cancel\")}\r\n        </Button>,\r\n      ]}\r\n    >\r\n      <KeycloakDataTable\r\n        loader={loader}\r\n        ariaLabelKey=\"profilesList\"\r\n        searchPlaceholderKey=\"searchProfile\"\r\n        canSelectAll\r\n        onSelect={(rows) => {\r\n          setSelectedRows([...rows]);\r\n        }}\r\n        columns={[\r\n          {\r\n            name: \"name\",\r\n            displayKey: \"clientProfileName\",\r\n            cellRenderer: AliasRenderer,\r\n          },\r\n          {\r\n            name: \"description\",\r\n            cellFormatters: [translationFormatter(t)],\r\n          },\r\n        ]}\r\n        emptyState={\r\n          <ListEmptyState\r\n            hasIcon\r\n            message={t(\"noRoles\")}\r\n            instructions={t(\"noRolesInstructions\")}\r\n            primaryActionText={t(\"createRole\")}\r\n          />\r\n        }\r\n      />\r\n    </Modal>\r\n  );\r\n};\r\n","import type ClientPolicyRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/clientPolicyRepresentation\";\r\nimport type ClientProfileRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/clientProfileRepresentation\";\r\nimport {\r\n  HelpItem,\r\n  KeycloakTextArea,\r\n  TextControl,\r\n  useAlerts,\r\n  useFetch,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  ActionGroup,\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  DataList,\r\n  DataListCell,\r\n  DataListItem,\r\n  DataListItemCells,\r\n  DataListItemRow,\r\n  Divider,\r\n  DropdownItem,\r\n  Flex,\r\n  FlexItem,\r\n  FormGroup,\r\n  Label,\r\n  PageSection,\r\n  Text,\r\n  TextVariants,\r\n} from \"@patternfly/react-core\";\r\nimport { PlusCircleIcon, TrashIcon } from \"@patternfly/react-icons\";\r\nimport { useState } from \"react\";\r\nimport { Controller, FormProvider, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport { useConfirmDialog } from \"../components/confirm-dialog/ConfirmDialog\";\r\nimport { FormAccess } from \"../components/form/FormAccess\";\r\nimport { KeycloakSpinner } from \"@keycloak/keycloak-ui-shared\";\r\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport { useServerInfo } from \"../context/server-info/ServerInfoProvider\";\r\nimport { useParams } from \"../utils/useParams\";\r\nimport { AddClientProfileModal } from \"./AddClientProfileModal\";\r\nimport { toNewClientPolicyCondition } from \"./routes/AddCondition\";\r\nimport { toClientPolicies } from \"./routes/ClientPolicies\";\r\nimport { toClientProfile } from \"./routes/ClientProfile\";\r\nimport {\r\n  EditClientPolicyParams,\r\n  toEditClientPolicy,\r\n} from \"./routes/EditClientPolicy\";\r\nimport { toEditClientPolicyCondition } from \"./routes/EditCondition\";\r\n\r\nimport \"./realm-settings-section.css\";\r\n\r\ntype FormFields = Required<ClientPolicyRepresentation>;\r\n\r\nconst defaultValues: FormFields = {\r\n  name: \"\",\r\n  description: \"\",\r\n  conditions: [],\r\n  enabled: true,\r\n  profiles: [],\r\n};\r\n\r\ntype PolicyDetailAttributes = {\r\n  idx: number;\r\n  name: string;\r\n};\r\n\r\nexport default function NewClientPolicy() {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const { realm } = useRealm();\r\n  const { addAlert, addError } = useAlerts();\r\n  const [isGlobalPolicy, setIsGlobalPolicy] = useState(false);\r\n  const [policies, setPolicies] = useState<ClientPolicyRepresentation[]>();\r\n  const [globalPolicies, setGlobalPolicies] =\r\n    useState<ClientPolicyRepresentation[]>();\r\n  const [allPolicies, setAllPolicies] =\r\n    useState<ClientPolicyRepresentation[]>();\r\n  const [clientProfiles, setClientProfiles] = useState<\r\n    ClientProfileRepresentation[]\r\n  >([]);\r\n\r\n  const [currentPolicy, setCurrentPolicy] =\r\n    useState<ClientPolicyRepresentation>();\r\n  const [\r\n    showAddConditionsAndProfilesForm,\r\n    setShowAddConditionsAndProfilesForm,\r\n  ] = useState(false);\r\n\r\n  const [conditionToDelete, setConditionToDelete] =\r\n    useState<PolicyDetailAttributes>();\r\n\r\n  const [profilesModalOpen, setProfilesModalOpen] = useState(false);\r\n\r\n  const [profileToDelete, setProfileToDelete] =\r\n    useState<PolicyDetailAttributes>();\r\n\r\n  const { policyName } = useParams<EditClientPolicyParams>();\r\n\r\n  const navigate = useNavigate();\r\n  const form = useForm<FormFields>({\r\n    mode: \"onChange\",\r\n    defaultValues,\r\n  });\r\n  const { handleSubmit } = form;\r\n\r\n  const formValues = form.getValues();\r\n\r\n  useFetch(\r\n    async () => {\r\n      const [policies, profiles] = await Promise.all([\r\n        adminClient.clientPolicies.listPolicies({\r\n          includeGlobalPolicies: true,\r\n        }),\r\n        adminClient.clientPolicies.listProfiles({\r\n          includeGlobalProfiles: true,\r\n        }),\r\n      ]);\r\n\r\n      return { policies, profiles };\r\n    },\r\n    ({ policies, profiles }) => {\r\n      let currentPolicy = policies.policies?.find(\r\n        (item) => item.name === policyName,\r\n      );\r\n      if (currentPolicy === undefined) {\r\n        currentPolicy = policies.globalPolicies?.find(\r\n          (item) => item.name === policyName,\r\n        );\r\n        setIsGlobalPolicy(currentPolicy !== undefined);\r\n      }\r\n\r\n      const allClientProfiles = [\r\n        ...(profiles.globalProfiles ?? []),\r\n        ...(profiles.profiles ?? []),\r\n      ];\r\n\r\n      const allClientPolicies = [\r\n        ...(policies.globalPolicies ?? []),\r\n        ...(policies.policies ?? []),\r\n      ];\r\n\r\n      setPolicies(policies.policies ?? []);\r\n      setGlobalPolicies(policies.globalPolicies ?? []);\r\n      setAllPolicies(allClientPolicies);\r\n      if (currentPolicy) {\r\n        setupForm(currentPolicy);\r\n        setClientProfiles(allClientProfiles);\r\n        setCurrentPolicy(currentPolicy);\r\n        setShowAddConditionsAndProfilesForm(true);\r\n      }\r\n    },\r\n    [],\r\n  );\r\n\r\n  const setupForm = (policy: ClientPolicyRepresentation) => {\r\n    form.reset(policy);\r\n  };\r\n\r\n  const policy = (allPolicies || []).filter(\r\n    (policy) => policy.name === policyName,\r\n  );\r\n  const policyConditions = policy[0]?.conditions || [];\r\n  const policyProfiles = policy[0]?.profiles || [];\r\n\r\n  const serverInfo = useServerInfo();\r\n\r\n  const conditionTypes =\r\n    serverInfo.componentTypes?.[\r\n      \"org.keycloak.services.clientpolicy.condition.ClientPolicyConditionProvider\"\r\n    ];\r\n\r\n  const save = async () => {\r\n    const createdForm = form.getValues();\r\n    const createdPolicy = {\r\n      ...createdForm,\r\n    };\r\n\r\n    const getAllPolicies = () => {\r\n      const policyNameExists = policies?.some(\r\n        (policy) => policy.name === createdPolicy.name,\r\n      );\r\n\r\n      if (policyNameExists) {\r\n        return policies?.map((policy) =>\r\n          policy.name === createdPolicy.name ? createdPolicy : policy,\r\n        );\r\n      } else if (createdForm.name !== policyName) {\r\n        return policies\r\n          ?.filter((item) => item.name !== policyName)\r\n          .concat(createdForm);\r\n      }\r\n      return policies?.concat(createdForm);\r\n    };\r\n\r\n    try {\r\n      await adminClient.clientPolicies.updatePolicy({\r\n        policies: getAllPolicies(),\r\n      });\r\n      addAlert(\r\n        policyName\r\n          ? t(\"updateClientPolicySuccess\")\r\n          : t(\"createClientPolicySuccess\"),\r\n        AlertVariant.success,\r\n      );\r\n      navigate(toEditClientPolicy({ realm, policyName: createdForm.name! }));\r\n      setShowAddConditionsAndProfilesForm(true);\r\n    } catch (error) {\r\n      addError(\"createClientPolicyError\", error);\r\n    }\r\n  };\r\n\r\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\r\n    titleKey: t(\"deleteClientPolicyConfirmTitle\"),\r\n    messageKey: t(\"deleteClientPolicyConfirm\", {\r\n      policyName: policyName,\r\n    }),\r\n    continueButtonLabel: t(\"delete\"),\r\n    continueButtonVariant: ButtonVariant.danger,\r\n    onConfirm: async () => {\r\n      const updatedPolicies = policies?.filter(\r\n        (policy) => policy.name !== policyName,\r\n      );\r\n\r\n      try {\r\n        await adminClient.clientPolicies.updatePolicy({\r\n          policies: updatedPolicies,\r\n        });\r\n        addAlert(t(\"deleteClientPolicySuccess\"), AlertVariant.success);\r\n        navigate(\r\n          toClientPolicies({\r\n            realm,\r\n            tab: \"policies\",\r\n          }),\r\n        );\r\n      } catch (error) {\r\n        addError(\"deleteClientPolicyError\", error);\r\n      }\r\n    },\r\n  });\r\n\r\n  const [toggleDeleteConditionDialog, DeleteConditionConfirm] =\r\n    useConfirmDialog({\r\n      titleKey: t(\"deleteClientPolicyConditionConfirmTitle\"),\r\n      messageKey: t(\"deleteClientPolicyConditionConfirm\", {\r\n        condition: conditionToDelete?.name,\r\n      }),\r\n      continueButtonLabel: t(\"delete\"),\r\n      continueButtonVariant: ButtonVariant.danger,\r\n      onConfirm: async () => {\r\n        if (conditionToDelete?.name) {\r\n          currentPolicy?.conditions?.splice(conditionToDelete.idx!, 1);\r\n          try {\r\n            await adminClient.clientPolicies.updatePolicy({\r\n              policies: policies,\r\n            });\r\n            addAlert(t(\"deleteConditionSuccess\"), AlertVariant.success);\r\n            navigate(\r\n              toEditClientPolicy({ realm, policyName: formValues.name! }),\r\n            );\r\n          } catch (error) {\r\n            addError(\"deleteConditionError\", error);\r\n          }\r\n        } else {\r\n          const updatedPolicies = policies?.filter(\r\n            (policy) => policy.name !== policyName,\r\n          );\r\n\r\n          try {\r\n            await adminClient.clientPolicies.updatePolicy({\r\n              policies: updatedPolicies,\r\n            });\r\n            addAlert(t(\"deleteClientSuccess\"), AlertVariant.success);\r\n            navigate(\r\n              toClientPolicies({\r\n                realm,\r\n                tab: \"policies\",\r\n              }),\r\n            );\r\n          } catch (error) {\r\n            addError(\"deleteClientError\", error);\r\n          }\r\n        }\r\n      },\r\n    });\r\n\r\n  const [toggleDeleteProfileDialog, DeleteProfileConfirm] = useConfirmDialog({\r\n    titleKey: t(\"deleteClientPolicyProfileConfirmTitle\"),\r\n    messageKey: t(\"deleteClientPolicyProfileConfirm\", {\r\n      profileName: profileToDelete?.name,\r\n      policyName,\r\n    }),\r\n    continueButtonLabel: t(\"delete\"),\r\n    continueButtonVariant: ButtonVariant.danger,\r\n    onConfirm: async () => {\r\n      if (profileToDelete?.name) {\r\n        currentPolicy?.profiles?.splice(profileToDelete.idx!, 1);\r\n        try {\r\n          await adminClient.clientPolicies.updatePolicy({\r\n            policies: policies,\r\n          });\r\n          addAlert(t(\"deleteClientPolicyProfileSuccess\"), AlertVariant.success);\r\n          form.setValue(\"profiles\", currentPolicy?.profiles || []);\r\n          navigate(toEditClientPolicy({ realm, policyName: formValues.name! }));\r\n        } catch (error) {\r\n          addError(\"deleteClientPolicyProfileError\", error);\r\n        }\r\n      } else {\r\n        const updatedPolicies = policies?.filter(\r\n          (policy) => policy.name !== policyName,\r\n        );\r\n\r\n        try {\r\n          await adminClient.clientPolicies.updatePolicy({\r\n            policies: updatedPolicies,\r\n          });\r\n          addAlert(t(\"deleteClientSuccess\"), AlertVariant.success);\r\n          navigate(\r\n            toClientPolicies({\r\n              realm,\r\n              tab: \"policies\",\r\n            }),\r\n          );\r\n        } catch (error) {\r\n          addError(\"deleteClientError\", error);\r\n        }\r\n      }\r\n    },\r\n  });\r\n\r\n  const reset = () => {\r\n    if (currentPolicy?.name !== undefined) {\r\n      form.setValue(\"name\", currentPolicy.name);\r\n    }\r\n\r\n    if (currentPolicy?.description !== undefined) {\r\n      form.setValue(\"description\", currentPolicy.description);\r\n    }\r\n  };\r\n\r\n  const toggleModal = () => {\r\n    setProfilesModalOpen(!profilesModalOpen);\r\n  };\r\n\r\n  const addProfiles = async (profiles: string[]) => {\r\n    const createdPolicy = {\r\n      ...currentPolicy,\r\n      profiles: policyProfiles.concat(profiles),\r\n      conditions: currentPolicy?.conditions,\r\n    };\r\n\r\n    const index = policies?.findIndex(\r\n      (policy) => createdPolicy.name === policy.name,\r\n    );\r\n\r\n    if (index === undefined || index === -1) {\r\n      return;\r\n    }\r\n\r\n    const newPolicies = [\r\n      ...(policies || []).slice(0, index),\r\n      createdPolicy,\r\n      ...(policies || []).slice(index + 1),\r\n    ];\r\n\r\n    try {\r\n      await adminClient.clientPolicies.updatePolicy({\r\n        policies: newPolicies,\r\n      });\r\n      setPolicies(newPolicies);\r\n      const allClientPolicies = [...(globalPolicies || []), ...newPolicies];\r\n      setAllPolicies(allClientPolicies);\r\n      setCurrentPolicy(createdPolicy);\r\n      form.setValue(\"profiles\", createdPolicy.profiles);\r\n      navigate(toEditClientPolicy({ realm, policyName: formValues.name! }));\r\n      addAlert(t(\"addClientProfileSuccess\"), AlertVariant.success);\r\n    } catch (error) {\r\n      addError(\"addClientProfileError\", error);\r\n    }\r\n  };\r\n\r\n  const [toggleDisableDialog, DisableConfirm] = useConfirmDialog({\r\n    titleKey: \"disablePolicyConfirmTitle\",\r\n    messageKey: \"disablePolicyConfirm\",\r\n    continueButtonLabel: \"disable\",\r\n    onConfirm: async () => {\r\n      form.setValue(\"enabled\", !form.getValues().enabled);\r\n      await save();\r\n    },\r\n  });\r\n\r\n  if (!policies) {\r\n    return <KeycloakSpinner />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <DeleteConditionConfirm />\r\n      <DeleteProfileConfirm />\r\n      <AddClientProfileModal\r\n        onConfirm={async (profiles: ClientProfileRepresentation[]) => {\r\n          await addProfiles(profiles.map((item) => item.name!));\r\n        }}\r\n        allProfiles={policyProfiles}\r\n        open={profilesModalOpen}\r\n        toggleDialog={toggleModal}\r\n      />\r\n      <Controller\r\n        name=\"enabled\"\r\n        defaultValue={true}\r\n        control={form.control}\r\n        render={({ field }) => (\r\n          <>\r\n            <DisableConfirm />\r\n            <DeleteConfirm />\r\n            <ViewHeader\r\n              titleKey={\r\n                showAddConditionsAndProfilesForm || policyName\r\n                  ? policyName\r\n                  : \"createPolicy\"\r\n              }\r\n              badges={[\r\n                {\r\n                  id: \"global-client-policy-badge\",\r\n                  text: isGlobalPolicy ? (\r\n                    <Label color=\"blue\">{t(\"global\")}</Label>\r\n                  ) : (\r\n                    \"\"\r\n                  ),\r\n                },\r\n              ]}\r\n              divider\r\n              dropdownItems={\r\n                (showAddConditionsAndProfilesForm || policyName) &&\r\n                !isGlobalPolicy\r\n                  ? [\r\n                      <DropdownItem\r\n                        key=\"delete\"\r\n                        value=\"delete\"\r\n                        onClick={() => {\r\n                          toggleDeleteDialog();\r\n                        }}\r\n                        data-testid=\"deleteClientPolicyDropdown\"\r\n                      >\r\n                        {t(\"deleteClientPolicy\")}\r\n                      </DropdownItem>,\r\n                    ]\r\n                  : undefined\r\n              }\r\n              isReadOnly={isGlobalPolicy}\r\n              isEnabled={field.value}\r\n              onToggle={async (value) => {\r\n                if (!value) {\r\n                  toggleDisableDialog();\r\n                } else {\r\n                  field.onChange(value);\r\n                  await save();\r\n                }\r\n              }}\r\n            />\r\n          </>\r\n        )}\r\n      />\r\n      <PageSection variant=\"light\">\r\n        <FormAccess\r\n          onSubmit={handleSubmit(save)}\r\n          isHorizontal\r\n          role=\"view-realm\"\r\n          className=\"pf-v5-u-mt-lg\"\r\n        >\r\n          <FormProvider {...form}>\r\n            <TextControl\r\n              name=\"name\"\r\n              label={t(\"name\")}\r\n              rules={{\r\n                required: t(\"required\"),\r\n                validate: (value) =>\r\n                  policies.some((policy) => policy.name === value)\r\n                    ? t(\"createClientProfileNameHelperText\")\r\n                    : true,\r\n              }}\r\n            />\r\n            <FormGroup label={t(\"description\")} fieldId=\"kc-description\">\r\n              <KeycloakTextArea\r\n                aria-label={t(\"description\")}\r\n                id=\"kc-client-policy-description\"\r\n                data-testid=\"client-policy-description\"\r\n                {...form.register(\"description\")}\r\n              />\r\n            </FormGroup>\r\n            <ActionGroup>\r\n              <Button\r\n                variant=\"primary\"\r\n                type=\"submit\"\r\n                data-testid=\"saveCreatePolicy\"\r\n                isDisabled={!form.formState.isValid || isGlobalPolicy}\r\n              >\r\n                {t(\"save\")}\r\n              </Button>\r\n              <Button\r\n                id=\"cancelCreatePolicy\"\r\n                variant=\"link\"\r\n                onClick={() =>\r\n                  (showAddConditionsAndProfilesForm || policyName) &&\r\n                  !isGlobalPolicy\r\n                    ? reset()\r\n                    : navigate(\r\n                        toClientPolicies({\r\n                          realm,\r\n                          tab: \"policies\",\r\n                        }),\r\n                      )\r\n                }\r\n                data-testid=\"cancelCreatePolicy\"\r\n              >\r\n                {showAddConditionsAndProfilesForm && !isGlobalPolicy\r\n                  ? t(\"reload\")\r\n                  : t(\"cancel\")}\r\n              </Button>\r\n            </ActionGroup>\r\n            {(showAddConditionsAndProfilesForm ||\r\n              form.formState.isSubmitted) && (\r\n              <>\r\n                <Flex>\r\n                  <FlexItem>\r\n                    <Text className=\"kc-conditions\" component={TextVariants.h1}>\r\n                      {t(\"conditions\")}\r\n                      <HelpItem\r\n                        helpText={t(\"conditionsHelp\")}\r\n                        fieldLabelId=\"conditions\"\r\n                      />\r\n                    </Text>\r\n                  </FlexItem>\r\n                  {!isGlobalPolicy && (\r\n                    <FlexItem align={{ default: \"alignRight\" }}>\r\n                      <Button\r\n                        id=\"addCondition\"\r\n                        component={(props) => (\r\n                          <Link\r\n                            {...props}\r\n                            to={toNewClientPolicyCondition({\r\n                              realm,\r\n                              policyName: policyName!,\r\n                            })}\r\n                          ></Link>\r\n                        )}\r\n                        variant=\"link\"\r\n                        className=\"kc-addCondition\"\r\n                        data-testid=\"addCondition\"\r\n                        icon={<PlusCircleIcon />}\r\n                      >\r\n                        {t(\"addCondition\")}\r\n                      </Button>\r\n                    </FlexItem>\r\n                  )}\r\n                </Flex>\r\n                {policyConditions.length > 0 ? (\r\n                  <DataList aria-label={t(\"conditions\")} isCompact>\r\n                    {policyConditions.map((condition, idx) => (\r\n                      <DataListItem\r\n                        aria-labelledby=\"conditions-list-item\"\r\n                        key={`list-item-${idx}`}\r\n                        id={condition.condition}\r\n                        data-testid=\"conditions-list-item\"\r\n                      >\r\n                        <DataListItemRow data-testid=\"conditions-list-row\">\r\n                          <DataListItemCells\r\n                            dataListCells={[\r\n                              <DataListCell\r\n                                key={`name-${idx}`}\r\n                                data-testid=\"condition-type\"\r\n                              >\r\n                                {Object.keys(condition.configuration!)\r\n                                  .length !== 0 ? (\r\n                                  <Link\r\n                                    key={condition.condition}\r\n                                    data-testid={`${condition.condition}-condition-link`}\r\n                                    to={toEditClientPolicyCondition({\r\n                                      realm,\r\n                                      conditionName: condition.condition!,\r\n                                      policyName: policyName,\r\n                                    })}\r\n                                    className=\"kc-condition-link\"\r\n                                  >\r\n                                    {condition.condition}\r\n                                  </Link>\r\n                                ) : (\r\n                                  condition.condition\r\n                                )}\r\n                                {conditionTypes?.map(\r\n                                  (type) =>\r\n                                    type.id === condition.condition && (\r\n                                      <>\r\n                                        <HelpItem\r\n                                          helpText={type.helpText}\r\n                                          fieldLabelId={condition.condition}\r\n                                        />\r\n                                        {!isGlobalPolicy && (\r\n                                          <Button\r\n                                            variant=\"link\"\r\n                                            aria-label=\"remove-condition\"\r\n                                            isInline\r\n                                            icon={\r\n                                              <TrashIcon\r\n                                                className=\"kc-conditionType-trash-icon\"\r\n                                                data-testid={`delete-${condition.condition}-condition`}\r\n                                                onClick={() => {\r\n                                                  toggleDeleteConditionDialog();\r\n                                                  setConditionToDelete({\r\n                                                    idx: idx,\r\n                                                    name: type.id!,\r\n                                                  });\r\n                                                }}\r\n                                              />\r\n                                            }\r\n                                          ></Button>\r\n                                        )}\r\n                                      </>\r\n                                    ),\r\n                                )}\r\n                              </DataListCell>,\r\n                            ]}\r\n                          />\r\n                        </DataListItemRow>\r\n                      </DataListItem>\r\n                    ))}\r\n                  </DataList>\r\n                ) : (\r\n                  <>\r\n                    <Divider />\r\n                    <Text\r\n                      data-testid=\"no-conditions\"\r\n                      className=\"kc-emptyConditions\"\r\n                      component={TextVariants.h2}\r\n                    >\r\n                      {t(\"emptyConditions\")}\r\n                    </Text>\r\n                  </>\r\n                )}\r\n              </>\r\n            )}\r\n            {(showAddConditionsAndProfilesForm ||\r\n              form.formState.isSubmitted) && (\r\n              <>\r\n                <Flex>\r\n                  <FlexItem>\r\n                    <Text\r\n                      className=\"kc-client-profiles\"\r\n                      component={TextVariants.h1}\r\n                    >\r\n                      {t(\"clientProfiles\")}\r\n                      <HelpItem\r\n                        helpText={t(\"clientProfilesHelp\")}\r\n                        fieldLabelId=\"clientProfiles\"\r\n                      />\r\n                    </Text>\r\n                  </FlexItem>\r\n                  {!isGlobalPolicy && (\r\n                    <FlexItem align={{ default: \"alignRight\" }}>\r\n                      <Button\r\n                        id=\"addClientProfile\"\r\n                        variant=\"link\"\r\n                        className=\"kc-addClientProfile\"\r\n                        data-testid=\"addClientProfile\"\r\n                        icon={<PlusCircleIcon />}\r\n                        onClick={toggleModal}\r\n                      >\r\n                        {t(\"addClientProfile\")}\r\n                      </Button>\r\n                    </FlexItem>\r\n                  )}\r\n                </Flex>\r\n                {policyProfiles.length > 0 ? (\r\n                  <DataList aria-label={t(\"profiles\")} isCompact>\r\n                    {policyProfiles.map((profile, idx) => (\r\n                      <DataListItem\r\n                        aria-labelledby={`${profile}-profile-list-item`}\r\n                        key={profile}\r\n                        id={`${profile}-profile-list-item`}\r\n                        data-testid={\"profile-list-item\"}\r\n                      >\r\n                        <DataListItemRow data-testid=\"profile-list-row\">\r\n                          <DataListItemCells\r\n                            dataListCells={[\r\n                              <DataListCell\r\n                                key=\"name\"\r\n                                data-testid=\"profile-name\"\r\n                              >\r\n                                {profile && (\r\n                                  <Link\r\n                                    key={profile}\r\n                                    data-testid=\"profile-name-link\"\r\n                                    to={toClientProfile({\r\n                                      realm,\r\n                                      profileName: profile,\r\n                                    })}\r\n                                    className=\"kc-profile-link\"\r\n                                  >\r\n                                    {profile}\r\n                                  </Link>\r\n                                )}\r\n                                {policyProfiles\r\n                                  .filter((type) => type === profile)\r\n                                  .map((type) => (\r\n                                    <>\r\n                                      <HelpItem\r\n                                        helpText={\r\n                                          clientProfiles.find(\r\n                                            (profile) => type === profile.name,\r\n                                          )?.description\r\n                                        }\r\n                                        fieldLabelId={profile}\r\n                                      />\r\n                                      {!isGlobalPolicy && (\r\n                                        <Button\r\n                                          variant=\"link\"\r\n                                          aria-label=\"remove-client-profile\"\r\n                                          isInline\r\n                                          icon={\r\n                                            <TrashIcon\r\n                                              className=\"kc-conditionType-trash-icon\"\r\n                                              data-testid=\"deleteClientProfileDropdown\"\r\n                                              onClick={() => {\r\n                                                toggleDeleteProfileDialog();\r\n                                                setProfileToDelete({\r\n                                                  idx: idx,\r\n                                                  name: type!,\r\n                                                });\r\n                                              }}\r\n                                            />\r\n                                          }\r\n                                        ></Button>\r\n                                      )}\r\n                                    </>\r\n                                  ))}\r\n                              </DataListCell>,\r\n                            ]}\r\n                          />\r\n                        </DataListItemRow>\r\n                      </DataListItem>\r\n                    ))}\r\n                  </DataList>\r\n                ) : (\r\n                  <>\r\n                    <Divider />\r\n                    <Text\r\n                      className=\"kc-emptyClientProfiles\"\r\n                      component={TextVariants.h2}\r\n                    >\r\n                      {t(\"emptyProfiles\")}\r\n                    </Text>\r\n                  </>\r\n                )}\r\n              </>\r\n            )}\r\n          </FormProvider>\r\n        </FormAccess>\r\n      </PageSection>\r\n    </>\r\n  );\r\n}\r\n"],"names":["AliasRenderer","name","global","t","useTranslation","jsxs","Fragment","jsx","Label","AddClientProfileModal","props","adminClient","useAdminClient","selectedRows","setSelectedRows","useState","tableProfiles","setTableProfiles","useFetch","allProfiles","globalProfiles","profiles","loader","item","Modal","ModalVariant","Button","KeycloakDataTable","rows","translationFormatter","ListEmptyState","KeycloakSpinner","defaultValues","NewClientPolicy","realm","useRealm","addAlert","addError","useAlerts","isGlobalPolicy","setIsGlobalPolicy","policies","setPolicies","globalPolicies","setGlobalPolicies","allPolicies","setAllPolicies","clientProfiles","setClientProfiles","currentPolicy","setCurrentPolicy","showAddConditionsAndProfilesForm","setShowAddConditionsAndProfilesForm","conditionToDelete","setConditionToDelete","profilesModalOpen","setProfilesModalOpen","profileToDelete","setProfileToDelete","policyName","useParams","navigate","useNavigate","form","useForm","handleSubmit","formValues","allClientProfiles","allClientPolicies","setupForm","policy","policyConditions","policyProfiles","conditionTypes","useServerInfo","save","createdForm","createdPolicy","getAllPolicies","AlertVariant","toEditClientPolicy","error","toggleDeleteDialog","DeleteConfirm","useConfirmDialog","ButtonVariant","updatedPolicies","toClientPolicies","toggleDeleteConditionDialog","DeleteConditionConfirm","toggleDeleteProfileDialog","DeleteProfileConfirm","reset","toggleModal","addProfiles","index","newPolicies","toggleDisableDialog","DisableConfirm","Controller","field","ViewHeader","DropdownItem","value","PageSection","FormAccess","FormProvider","TextControl","FormGroup","KeycloakTextArea","ActionGroup","Flex","FlexItem","Text","TextVariants","HelpItem","Link","toNewClientPolicyCondition","PlusCircleIcon","DataList","condition","idx","DataListItem","DataListItemRow","DataListItemCells","DataListCell","toEditClientPolicyCondition","type","TrashIcon","Divider","profile","toClientProfile"],"mappings":"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"}