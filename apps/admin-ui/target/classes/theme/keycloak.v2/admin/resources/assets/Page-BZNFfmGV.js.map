{"version":3,"file":"Page-BZNFfmGV.js","sources":["../../../../../../../src/page/Page.tsx"],"sourcesContent":["import ComponentRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/componentRepresentation\";\r\nimport { useAlerts, useFetch } from \"@keycloak/keycloak-ui-shared\";\r\nimport { ButtonVariant, DropdownItem } from \"@patternfly/react-core\";\r\nimport { get } from \"lodash-es\";\r\nimport { useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../admin-client\";\r\nimport { useConfirmDialog } from \"../components/confirm-dialog/ConfirmDialog\";\r\nimport { ViewHeader } from \"../components/view-header/ViewHeader\";\r\nimport { useRealm } from \"../context/realm-context/RealmContext\";\r\nimport { useServerInfo } from \"../context/server-info/ServerInfoProvider\";\r\nimport { PageHandler } from \"./PageHandler\";\r\nimport { PAGE_PROVIDER } from \"./constants\";\r\nimport { PageParams, toPage } from \"./routes\";\r\n\r\nexport default function Page() {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const { componentTypes } = useServerInfo();\r\n  const { realm } = useRealm();\r\n  const pages = componentTypes?.[PAGE_PROVIDER];\r\n  const navigate = useNavigate();\r\n  const { id, providerId } = useParams<PageParams>();\r\n  const { addAlert, addError } = useAlerts();\r\n  const [pageData, setPageData] = useState<ComponentRepresentation>();\r\n\r\n  const page = pages?.find((p) => p.id === providerId);\r\n  if (!page) {\r\n    throw new Error(t(\"notFound\"));\r\n  }\r\n\r\n  useFetch(\r\n    async () => adminClient.components.findOne({ id: id! }),\r\n    setPageData,\r\n    [id],\r\n  );\r\n\r\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\r\n    titleKey: \"itemDeleteConfirmTitle\",\r\n    messageKey: \"itemDeleteConfirm\",\r\n    continueButtonLabel: \"delete\",\r\n    continueButtonVariant: ButtonVariant.danger,\r\n    onConfirm: async () => {\r\n      try {\r\n        await adminClient.components.del({\r\n          id: id!,\r\n        });\r\n        addAlert(t(\"itemDeletedSuccess\"));\r\n        navigate(toPage({ realm, providerId: providerId! }));\r\n      } catch (error) {\r\n        addError(\"itemSaveError\", error);\r\n      }\r\n    },\r\n  });\r\n  return (\r\n    <>\r\n      <DeleteConfirm />\r\n      <ViewHeader\r\n        titleKey={\r\n          get(\r\n            pageData,\r\n            `config.${page.metadata.displayFields?.[0] || page.properties[0].name}`,\r\n          )?.[0] || t(\"createItem\")\r\n        }\r\n        dropdownItems={\r\n          id\r\n            ? [\r\n                <DropdownItem\r\n                  data-testid=\"delete-item\"\r\n                  key=\"delete\"\r\n                  onClick={() => toggleDeleteDialog()}\r\n                >\r\n                  {t(\"delete\")}\r\n                </DropdownItem>,\r\n              ]\r\n            : undefined\r\n        }\r\n      />\r\n      <PageHandler providerType={PAGE_PROVIDER} id={id} page={page} />\r\n    </>\r\n  );\r\n}\r\n"],"names":["Page","adminClient","useAdminClient","useTranslation","componentTypes","useServerInfo","realm","useRealm","pages","PAGE_PROVIDER","navigate","useNavigate","id","providerId","useParams","addAlert","addError","useAlerts","pageData","setPageData","useState","page","p","useFetch","toggleDeleteDialog","DeleteConfirm","useConfirmDialog","ButtonVariant","toPage","error","jsxs","Fragment","jsx","ViewHeader","get","DropdownItem","PageHandler"],"mappings":"g2BAgBA,SAAwBA,IAAO,CAC7B,KAAM,CAAE,YAAAC,CAAA,EAAgBC,EAAA,EAElB,CAAE,CAAA,EAAMC,EAAA,EACR,CAAE,eAAAC,CAAA,EAAmBC,EAAA,EACrB,CAAE,MAAAC,CAAA,EAAUC,EAAA,EACZC,EAAQJ,IAAiBK,CAAa,EACtCC,EAAWC,EAAA,EACX,CAAE,GAAAC,EAAI,WAAAC,CAAA,EAAeC,EAAA,EACrB,CAAE,SAAAC,EAAU,SAAAC,CAAA,EAAaC,EAAA,EACzB,CAACC,EAAUC,CAAW,EAAIC,EAAA,EAE1BC,EAAOb,GAAO,KAAMc,GAAMA,EAAE,KAAOT,CAAU,EACnD,GAAI,CAACQ,EACH,MAAM,IAAI,MAAM,EAAE,UAAU,CAAC,EAG/BE,EACE,SAAYtB,EAAY,WAAW,QAAQ,CAAE,GAAAW,EAAS,EACtDO,EACA,CAACP,CAAE,CAAA,EAGL,KAAM,CAACY,EAAoBC,CAAa,EAAIC,EAAiB,CAC3D,SAAU,yBACV,WAAY,oBACZ,oBAAqB,SACrB,sBAAuBC,EAAc,OACrC,UAAW,SAAY,CACrB,GAAI,CACF,MAAM1B,EAAY,WAAW,IAAI,CAC/B,GAAAW,CAAA,CACD,EACDG,EAAS,EAAE,oBAAoB,CAAC,EAChCL,EAASkB,EAAO,CAAE,MAAAtB,EAAO,WAAAO,CAAA,CAAyB,CAAC,CACrD,OAASgB,EAAO,CACdb,EAAS,gBAAiBa,CAAK,CACjC,CACF,CAAA,CACD,EACD,OACEC,EAAAC,EAAA,CACE,SAAA,CAAAC,EAACP,EAAA,EAAc,EACfO,EAACC,EAAA,CACC,SACEC,EACEhB,EACA,UAAUG,EAAK,SAAS,gBAAgB,CAAC,GAAKA,EAAK,WAAW,CAAC,EAAE,IAAI,EAAA,IACnE,CAAC,GAAK,EAAE,YAAY,EAE1B,cACET,EACI,CACEoB,EAACG,EAAA,CACC,cAAY,cAEZ,QAAS,IAAMX,EAAA,EAEd,WAAE,QAAQ,CAAA,EAHP,QAAA,CAIN,EAEF,MAAA,CAAA,EAGRQ,EAACI,EAAA,CAAY,aAAc3B,EAAe,GAAAG,EAAQ,KAAAS,CAAA,CAAY,CAAA,EAChE,CAEJ"}