{"version":3,"file":"OIDCGeneralSettings-ItScBFVN.js","sources":["../../../../../../../src/identity-providers/component/FormGroupField.tsx","../../../../../../../src/identity-providers/component/SwitchField.tsx","../../../../../../../src/identity-providers/component/TextField.tsx","../../../../../../../src/identity-providers/add/DiscoverySettings.tsx","../../../../../../../src/identity-providers/add/OIDCAuthentication.tsx","../../../../../../../src/identity-providers/add/OIDCGeneralSettings.tsx"],"sourcesContent":["import { FormGroup } from \"@patternfly/react-core\";\r\nimport { PropsWithChildren } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport { HelpItem } from \"@keycloak/keycloak-ui-shared\";\r\n\r\nexport type FieldProps = { label: string; field: string; isReadOnly?: boolean };\r\nexport type FormGroupFieldProps = { label: string };\r\n\r\nexport const FormGroupField = ({\r\n  label,\r\n  children,\r\n}: PropsWithChildren<FormGroupFieldProps>) => {\r\n  const { t } = useTranslation();\r\n  return (\r\n    <FormGroup\r\n      label={t(label)}\r\n      fieldId={label}\r\n      labelIcon={<HelpItem helpText={t(`${label}Help`)} fieldLabelId={label} />}\r\n    >\r\n      {children}\r\n    </FormGroup>\r\n  );\r\n};\r\n","import { Switch } from \"@patternfly/react-core\";\r\nimport { Controller, useFormContext } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport { FieldProps, FormGroupField } from \"./FormGroupField\";\r\n\r\ntype FieldType = \"boolean\" | \"string\";\r\n\r\ntype SwitchFieldProps = FieldProps & {\r\n  fieldType?: FieldType;\r\n  defaultValue?: string | boolean;\r\n};\r\n\r\nexport const SwitchField = ({\r\n  label,\r\n  field,\r\n  fieldType = \"string\",\r\n  isReadOnly = false,\r\n  defaultValue,\r\n}: SwitchFieldProps) => {\r\n  const { t } = useTranslation();\r\n  const { control } = useFormContext();\r\n  return (\r\n    <FormGroupField label={label}>\r\n      <Controller\r\n        name={field}\r\n        defaultValue={\r\n          defaultValue ? defaultValue : fieldType === \"string\" ? \"false\" : false\r\n        }\r\n        control={control}\r\n        render={({ field }) => (\r\n          <Switch\r\n            id={label}\r\n            label={t(\"on\")}\r\n            labelOff={t(\"off\")}\r\n            isChecked={\r\n              fieldType === \"string\"\r\n                ? field.value === \"true\"\r\n                : (field.value as boolean)\r\n            }\r\n            onChange={(_event, value) =>\r\n              field.onChange(fieldType === \"string\" ? \"\" + value : value)\r\n            }\r\n            isDisabled={isReadOnly}\r\n            aria-label={label}\r\n          />\r\n        )}\r\n      />\r\n    </FormGroupField>\r\n  );\r\n};\r\n","import { TextInput } from \"@patternfly/react-core\";\r\nimport { useFormContext } from \"react-hook-form\";\r\n\r\nimport { FieldProps, FormGroupField } from \"./FormGroupField\";\r\n\r\nexport const TextField = ({ label, field, isReadOnly = false }: FieldProps) => {\r\n  const { register } = useFormContext();\r\n  return (\r\n    <FormGroupField label={label}>\r\n      <TextInput\r\n        id={label}\r\n        data-testid={label}\r\n        readOnly={isReadOnly}\r\n        {...register(field)}\r\n      />\r\n    </FormGroupField>\r\n  );\r\n};\r\n","import IdentityProviderRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/identityProviderRepresentation\";\r\nimport { ExpandableSection } from \"@patternfly/react-core\";\r\nimport { useState } from \"react\";\r\nimport { useFormContext, useWatch } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { SelectControl, TextControl } from \"@keycloak/keycloak-ui-shared\";\r\nimport { DefaultSwitchControl } from \"../../components/SwitchControl\";\r\nimport { JwksSettings } from \"./JwksSettings\";\r\n\r\nimport \"./discovery-settings.css\";\r\n\r\nconst PKCE_METHODS = [\"plain\", \"S256\"] as const;\r\n\r\ntype DiscoverySettingsProps = {\r\n  readOnly: boolean;\r\n  isOIDC: boolean;\r\n};\r\n\r\nconst Fields = ({ readOnly, isOIDC }: DiscoverySettingsProps) => {\r\n  const { t } = useTranslation();\r\n  const { control } = useFormContext<IdentityProviderRepresentation>();\r\n\r\n  const validateSignature = useWatch({\r\n    control,\r\n    name: \"config.validateSignature\",\r\n  });\r\n  const isPkceEnabled = useWatch({\r\n    control,\r\n    name: \"config.pkceEnabled\",\r\n  });\r\n  const jwtAuthorizationGrantEnabled = useWatch({\r\n    control,\r\n    name: \"config.jwtAuthorizationGrantEnabled\",\r\n  });\r\n  const supportsClientAssertions = useWatch({\r\n    control,\r\n    name: \"config.supportsClientAssertions\",\r\n  });\r\n\r\n  return (\r\n    <div className=\"pf-v5-c-form pf-m-horizontal\">\r\n      <TextControl\r\n        name=\"config.authorizationUrl\"\r\n        label={t(\"authorizationUrl\")}\r\n        type=\"url\"\r\n        readOnly={readOnly}\r\n        rules={{\r\n          required: t(\"required\"),\r\n        }}\r\n      />\r\n      <TextControl\r\n        name=\"config.tokenUrl\"\r\n        label={t(\"tokenUrl\")}\r\n        type=\"url\"\r\n        readOnly={readOnly}\r\n        rules={{\r\n          required: t(\"required\"),\r\n        }}\r\n      />\r\n      {isOIDC && (\r\n        <TextControl\r\n          name=\"config.logoutUrl\"\r\n          label={t(\"logoutUrl\")}\r\n          readOnly={readOnly}\r\n        />\r\n      )}\r\n      <TextControl\r\n        name=\"config.userInfoUrl\"\r\n        label={t(\"userInfoUrl\")}\r\n        readOnly={readOnly}\r\n        rules={{\r\n          required: isOIDC ? \"\" : t(\"required\"),\r\n        }}\r\n      />\r\n      <TextControl\r\n        name=\"config.tokenIntrospectionUrl\"\r\n        label={t(\"tokenIntrospectionUrl\")}\r\n        type=\"url\"\r\n        readOnly={readOnly}\r\n      />\r\n      {isOIDC && (\r\n        <TextControl\r\n          name=\"config.issuer\"\r\n          label={t(\"issuer\")}\r\n          readOnly={readOnly}\r\n        />\r\n      )}\r\n      {isOIDC && (\r\n        <>\r\n          <DefaultSwitchControl\r\n            name=\"config.validateSignature\"\r\n            label={t(\"validateSignature\")}\r\n            labelIcon={t(\"validateSignatureHelp\")}\r\n            isDisabled={readOnly}\r\n            stringify\r\n          />\r\n          {(validateSignature === \"true\" ||\r\n            jwtAuthorizationGrantEnabled === \"true\" ||\r\n            supportsClientAssertions == \"true\") && (\r\n            <JwksSettings readOnly={readOnly} />\r\n          )}\r\n        </>\r\n      )}\r\n      <DefaultSwitchControl\r\n        name=\"config.pkceEnabled\"\r\n        label={t(\"pkceEnabled\")}\r\n        isDisabled={readOnly}\r\n        stringify\r\n      />\r\n      {isPkceEnabled === \"true\" && (\r\n        <SelectControl\r\n          name=\"config.pkceMethod\"\r\n          label={t(\"pkceMethod\")}\r\n          labelIcon={t(\"pkceMethodHelp\")}\r\n          controller={{\r\n            defaultValue: PKCE_METHODS[0],\r\n          }}\r\n          options={PKCE_METHODS.map((option) => ({\r\n            key: option,\r\n            value: t(option),\r\n          }))}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const DiscoverySettings = ({\r\n  readOnly,\r\n  isOIDC,\r\n}: DiscoverySettingsProps) => {\r\n  const { t } = useTranslation();\r\n  const [isExpanded, setIsExpanded] = useState(false);\r\n\r\n  return (\r\n    <>\r\n      {readOnly && (\r\n        <ExpandableSection\r\n          className=\"keycloak__discovery-settings__metadata\"\r\n          toggleText={isExpanded ? t(\"hideMetaData\") : t(\"showMetaData\")}\r\n          onToggle={() => setIsExpanded(!isExpanded)}\r\n          isExpanded={isExpanded}\r\n        >\r\n          <Fields readOnly={readOnly} isOIDC={isOIDC} />\r\n        </ExpandableSection>\r\n      )}\r\n      {!readOnly && <Fields readOnly={readOnly} isOIDC={isOIDC} />}\r\n    </>\r\n  );\r\n};\r\n","import { SelectControl } from \"@keycloak/keycloak-ui-shared\";\r\nimport { useFormContext, useWatch } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useServerInfo } from \"../../context/server-info/ServerInfoProvider\";\r\nimport { sortProviders } from \"../../util\";\r\nimport { ClientIdSecret } from \"../component/ClientIdSecret\";\r\nimport { SwitchField } from \"../component/SwitchField\";\r\nimport { TextField } from \"../component/TextField\";\r\n\r\nconst clientAuthentications = [\r\n  \"client_secret_post\",\r\n  \"client_secret_basic\",\r\n  \"client_secret_basic_unencoded\",\r\n  \"client_secret_jwt\",\r\n  \"private_key_jwt\",\r\n];\r\n\r\nexport const OIDCAuthentication = ({ create = true }: { create?: boolean }) => {\r\n  const providers = useServerInfo().providers!.clientSignature.providers;\r\n  const { t } = useTranslation();\r\n\r\n  const { control } = useFormContext();\r\n\r\n  const clientAuthMethod = useWatch({\r\n    control: control,\r\n    name: \"config.clientAuthMethod\",\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <SelectControl\r\n        name=\"config.clientAuthMethod\"\r\n        label={t(\"clientAuthentication\")}\r\n        labelIcon={t(\"clientAuthenticationHelp\")}\r\n        options={clientAuthentications.map((auth) => ({\r\n          key: auth,\r\n          value: t(`clientAuthentications.${auth}`),\r\n        }))}\r\n        controller={{\r\n          defaultValue: clientAuthentications[0],\r\n        }}\r\n      />\r\n      <ClientIdSecret\r\n        secretRequired={clientAuthMethod !== \"private_key_jwt\"}\r\n        create={create}\r\n      />\r\n      <SelectControl\r\n        name=\"config.clientAssertionSigningAlg\"\r\n        label={t(\"clientAssertionSigningAlg\")}\r\n        labelIcon={t(\"clientAssertionSigningAlgHelp\")}\r\n        options={[\r\n          { key: \"\", value: t(\"algorithmNotSpecified\") },\r\n          ...sortProviders(providers).map((p) => ({ key: p, value: p })),\r\n        ]}\r\n        controller={{\r\n          defaultValue: \"\",\r\n        }}\r\n      />\r\n      {(clientAuthMethod === \"private_key_jwt\" ||\r\n        clientAuthMethod === \"client_secret_jwt\") && (\r\n        <TextField\r\n          field=\"config.clientAssertionAudience\"\r\n          label=\"clientAssertionAudience\"\r\n        />\r\n      )}\r\n      {clientAuthMethod === \"private_key_jwt\" && (\r\n        <SwitchField\r\n          field=\"config.jwtX509HeadersEnabled\"\r\n          label=\"jwtX509HeadersEnabled\"\r\n        />\r\n      )}\r\n    </>\r\n  );\r\n};\r\n","import { useFormContext, useWatch } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { TextControl } from \"@keycloak/keycloak-ui-shared\";\r\nimport { DisplayOrder } from \"../component/DisplayOrder\";\r\nimport { RedirectUrl } from \"../component/RedirectUrl\";\r\nimport type { IdentityProviderParams } from \"../routes/IdentityProvider\";\r\n\r\nexport const OIDCGeneralSettings = () => {\r\n  const { t } = useTranslation();\r\n  const { tab } = useParams<IdentityProviderParams>();\r\n\r\n  const { control } = useFormContext();\r\n  const alias = useWatch({ control, name: \"alias\" });\r\n\r\n  return (\r\n    <>\r\n      <RedirectUrl id={alias} />\r\n\r\n      <TextControl\r\n        name=\"alias\"\r\n        label={t(\"alias\")}\r\n        labelIcon={t(\"aliasHelp\")}\r\n        readOnly={tab === \"settings\"}\r\n        rules={{\r\n          required: t(\"required\"),\r\n        }}\r\n      />\r\n\r\n      <TextControl name=\"displayName\" label={t(\"displayName\")} />\r\n      <DisplayOrder />\r\n    </>\r\n  );\r\n};\r\n"],"names":["FormGroupField","label","children","t","useTranslation","jsx","FormGroup","HelpItem","SwitchField","field","fieldType","isReadOnly","defaultValue","control","useFormContext","Controller","Switch","_event","value","TextField","register","TextInput","PKCE_METHODS","Fields","readOnly","isOIDC","validateSignature","useWatch","isPkceEnabled","jwtAuthorizationGrantEnabled","supportsClientAssertions","jsxs","TextControl","Fragment","DefaultSwitchControl","JwksSettings","SelectControl","option","DiscoverySettings","isExpanded","setIsExpanded","useState","ExpandableSection","clientAuthentications","OIDCAuthentication","create","providers","useServerInfo","clientAuthMethod","auth","ClientIdSecret","sortProviders","p","OIDCGeneralSettings","tab","useParams","alias","RedirectUrl","DisplayOrder"],"mappings":"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"}