{"version":3,"file":"CreateClientRole-VDlFW_bx.js","sources":["../../../../../../../src/clients/roles/CreateClientRole.tsx"],"sourcesContent":["import type RoleRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/roleRepresentation\";\r\nimport { AlertVariant } from \"@patternfly/react-core\";\r\nimport { FormProvider, SubmitHandler, useForm } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { useAlerts } from \"@keycloak/keycloak-ui-shared\";\r\nimport { AttributeForm } from \"../../components/key-value-form/AttributeForm\";\r\nimport { RoleForm } from \"../../components/role-form/RoleForm\";\r\nimport { useRealm } from \"../../context/realm-context/RealmContext\";\r\nimport { toClient } from \"../routes/Client\";\r\nimport { toClientRole } from \"../routes/ClientRole\";\r\nimport { NewRoleParams } from \"../routes/NewRole\";\r\n\r\nexport default function CreateClientRole() {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n  const form = useForm<AttributeForm>({ mode: \"onChange\" });\r\n  const navigate = useNavigate();\r\n  const { clientId } = useParams<NewRoleParams>();\r\n  const { realm } = useRealm();\r\n  const { addAlert, addError } = useAlerts();\r\n\r\n  const onSubmit: SubmitHandler<AttributeForm> = async (formValues) => {\r\n    const role: RoleRepresentation = {\r\n      ...formValues,\r\n      name: formValues.name?.trim(),\r\n      attributes: {},\r\n    };\r\n\r\n    try {\r\n      await adminClient.clients.createRole({\r\n        id: clientId,\r\n        ...role,\r\n      });\r\n\r\n      const createdRole = (await adminClient.clients.findRole({\r\n        id: clientId!,\r\n        roleName: role.name!,\r\n      }))!;\r\n\r\n      addAlert(t(\"roleCreated\"), AlertVariant.success);\r\n      navigate(\r\n        toClientRole({\r\n          realm,\r\n          clientId: clientId!,\r\n          id: createdRole.id!,\r\n          tab: \"details\",\r\n        }),\r\n      );\r\n    } catch (error) {\r\n      addError(\"roleCreateError\", error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <FormProvider {...form}>\r\n      <RoleForm\r\n        form={form}\r\n        onSubmit={onSubmit}\r\n        cancelLink={toClient({\r\n          realm,\r\n          clientId: clientId!,\r\n          tab: \"roles\",\r\n        })}\r\n        role=\"manage-clients\"\r\n        editMode={false}\r\n      />\r\n    </FormProvider>\r\n  );\r\n}\r\n"],"names":["CreateClientRole","adminClient","useAdminClient","t","useTranslation","form","useForm","navigate","useNavigate","clientId","useParams","realm","useRealm","addAlert","addError","useAlerts","jsx","FormProvider","RoleForm","formValues","role","createdRole","AlertVariant","toClientRole","error","toClient"],"mappings":"+RAcA,SAAwBA,GAAmB,CACzC,KAAM,CAAE,YAAAC,CAAA,EAAgBC,EAAA,EAElB,CAAE,EAAAC,CAAA,EAAMC,EAAA,EACRC,EAAOC,EAAuB,CAAE,KAAM,WAAY,EAClDC,EAAWC,EAAA,EACX,CAAE,SAAAC,CAAA,EAAaC,EAAA,EACf,CAAE,MAAAC,CAAA,EAAUC,EAAA,EACZ,CAAE,SAAAC,EAAU,SAAAC,CAAA,EAAaC,EAAA,EAkC/B,OACEC,EAACC,EAAA,CAAc,GAAGZ,EAChB,SAAAW,EAACE,EAAA,CACC,KAAAb,EACA,SApCyC,MAAOc,GAAe,CACnE,MAAMC,EAA2B,CAC/B,GAAGD,EACH,KAAMA,EAAW,MAAM,KAAA,EACvB,WAAY,CAAA,CAAC,EAGf,GAAI,CACF,MAAMlB,EAAY,QAAQ,WAAW,CACnC,GAAIQ,EACJ,GAAGW,CAAA,CACJ,EAED,MAAMC,EAAe,MAAMpB,EAAY,QAAQ,SAAS,CACtD,GAAIQ,EACJ,SAAUW,EAAK,IAAA,CAChB,EAEDP,EAASV,EAAE,aAAa,EAAGmB,EAAa,OAAO,EAC/Cf,EACEgB,EAAa,CACX,MAAAZ,EACA,SAAAF,EACA,GAAIY,EAAY,GAChB,IAAK,SAAA,CACN,CAAA,CAEL,OAASG,EAAO,CACdV,EAAS,kBAAmBU,CAAK,CACnC,CACF,EAOM,WAAYC,EAAS,CACnB,MAAAd,EACA,SAAAF,EACA,IAAK,OAAA,CACN,EACD,KAAK,iBACL,SAAU,EAAA,CAAA,EAEd,CAEJ"}