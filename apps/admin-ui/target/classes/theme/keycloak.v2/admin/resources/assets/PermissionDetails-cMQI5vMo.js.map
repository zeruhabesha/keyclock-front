{"version":3,"file":"PermissionDetails-cMQI5vMo.js","sources":["../../../../../../../src/clients/authorization/ScopeSelect.tsx","../../../../../../../src/clients/authorization/PermissionDetails.tsx"],"sourcesContent":["import type ScopeRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/scopeRepresentation\";\r\nimport {\r\n  KeycloakSelect,\r\n  SelectVariant,\r\n  useFetch,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport { SelectOption } from \"@patternfly/react-core\";\r\nimport { useRef, useState } from \"react\";\r\nimport { Controller, useFormContext } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\n\r\ntype ScopeSelectProps = {\r\n  clientId: string;\r\n  resourceId?: string;\r\n  preSelected?: string;\r\n};\r\n\r\nexport const ScopeSelect = ({\r\n  clientId,\r\n  resourceId,\r\n  preSelected,\r\n}: ScopeSelectProps) => {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n\r\n  const {\r\n    control,\r\n    getValues,\r\n    setValue,\r\n    formState: { errors },\r\n  } = useFormContext();\r\n\r\n  const [scopes, setScopes] = useState<ScopeRepresentation[]>([]);\r\n  const [selectedScopes, setSelectedScopes] = useState<ScopeRepresentation[]>(\r\n    [],\r\n  );\r\n  const [search, setSearch] = useState(\"\");\r\n  const [open, setOpen] = useState(false);\r\n  const firstUpdate = useRef(true);\r\n\r\n  const values: string[] | undefined = getValues(\"scopes\");\r\n\r\n  const toSelectOptions = (scopes: ScopeRepresentation[]) =>\r\n    scopes.map((scope) => (\r\n      <SelectOption key={scope.id} value={scope}>\r\n        {scope.name}\r\n      </SelectOption>\r\n    ));\r\n\r\n  useFetch(\r\n    async (): Promise<ScopeRepresentation[]> => {\r\n      if (!resourceId) {\r\n        return adminClient.clients.listAllScopes(\r\n          Object.assign(\r\n            { id: clientId, deep: false },\r\n            search === \"\" ? null : { name: search },\r\n          ),\r\n        );\r\n      }\r\n\r\n      if (resourceId && !firstUpdate.current) {\r\n        setValue(\"scopes\", []);\r\n      }\r\n\r\n      firstUpdate.current = false;\r\n      return adminClient.clients.listScopesByResource({\r\n        id: clientId,\r\n        resourceName: resourceId,\r\n      });\r\n    },\r\n    (scopes) => {\r\n      setScopes(scopes);\r\n      if (!search)\r\n        setSelectedScopes(\r\n          scopes.filter((s: ScopeRepresentation) => values?.includes(s.id!)),\r\n        );\r\n    },\r\n    [resourceId, search],\r\n  );\r\n\r\n  return (\r\n    <Controller\r\n      name=\"scopes\"\r\n      defaultValue={preSelected ? [preSelected] : []}\r\n      control={control}\r\n      rules={{ validate: (value) => value.length > 0 }}\r\n      render={({ field }) => (\r\n        <KeycloakSelect\r\n          toggleId=\"scopes\"\r\n          variant={SelectVariant.typeaheadMulti}\r\n          onToggle={(val) => setOpen(val)}\r\n          onFilter={(filter) => {\r\n            setSearch(filter);\r\n            return toSelectOptions(scopes);\r\n          }}\r\n          onClear={() => {\r\n            field.onChange([]);\r\n            setSearch(\"\");\r\n          }}\r\n          selections={selectedScopes.map((s) => s.name!)}\r\n          onSelect={(selectedValue) => {\r\n            const option =\r\n              typeof selectedValue === \"string\"\r\n                ? selectedScopes.find((s) => s.name === selectedValue)!\r\n                : (selectedValue as ScopeRepresentation);\r\n            const changedValue = selectedScopes.find((p) => p.id === option.id)\r\n              ? selectedScopes.filter((p) => p.id !== option.id)\r\n              : [...selectedScopes, option];\r\n\r\n            field.onChange(changedValue.map((s) => s.id));\r\n            setSelectedScopes(changedValue);\r\n            setSearch(\"\");\r\n          }}\r\n          isOpen={open}\r\n          aria-labelledby={t(\"scopes\")}\r\n          validated={errors.scopes ? \"error\" : \"default\"}\r\n          isDisabled={!!preSelected}\r\n          typeAheadAriaLabel={t(\"scopes\")}\r\n        >\r\n          {toSelectOptions(scopes)}\r\n        </KeycloakSelect>\r\n      )}\r\n    />\r\n  );\r\n};\r\n","import type PolicyRepresentation from \"@keycloak/keycloak-admin-client/lib/defs/policyRepresentation\";\r\nimport { DecisionStrategy } from \"@keycloak/keycloak-admin-client/lib/defs/policyRepresentation\";\r\nimport {\r\n  FormErrorText,\r\n  HelpItem,\r\n  SelectVariant,\r\n  TextAreaControl,\r\n  TextControl,\r\n  useAlerts,\r\n  useFetch,\r\n} from \"@keycloak/keycloak-ui-shared\";\r\nimport {\r\n  ActionGroup,\r\n  AlertVariant,\r\n  Button,\r\n  ButtonVariant,\r\n  DropdownItem,\r\n  FormGroup,\r\n  PageSection,\r\n  Radio,\r\n  Switch,\r\n} from \"@patternfly/react-core\";\r\nimport { useState } from \"react\";\r\nimport { Controller, FormProvider, useForm, useWatch } from \"react-hook-form\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { Link, useNavigate } from \"react-router-dom\";\r\nimport { useAdminClient } from \"../../admin-client\";\r\nimport { useConfirmDialog } from \"../../components/confirm-dialog/ConfirmDialog\";\r\nimport { FormAccess } from \"../../components/form/FormAccess\";\r\nimport { KeycloakSpinner } from \"@keycloak/keycloak-ui-shared\";\r\nimport { ViewHeader } from \"../../components/view-header/ViewHeader\";\r\nimport { useAccess } from \"../../context/access/Access\";\r\nimport { toUpperCase } from \"../../util\";\r\nimport { useParams } from \"../../utils/useParams\";\r\nimport { toAuthorizationTab } from \"../routes/AuthenticationTab\";\r\nimport type { NewPermissionParams } from \"../routes/NewPermission\";\r\nimport {\r\n  PermissionDetailsParams,\r\n  toPermissionDetails,\r\n} from \"../routes/PermissionDetails\";\r\nimport { ResourcesPolicySelect } from \"./ResourcesPolicySelect\";\r\nimport { ScopeSelect } from \"./ScopeSelect\";\r\n\r\ntype FormFields = PolicyRepresentation & {\r\n  resourceType: string;\r\n};\r\n\r\nexport default function PermissionDetails() {\r\n  const { adminClient } = useAdminClient();\r\n\r\n  const { t } = useTranslation();\r\n\r\n  const form = useForm<FormFields>({\r\n    mode: \"onChange\",\r\n  });\r\n  const {\r\n    control,\r\n    reset,\r\n    formState: { errors },\r\n    handleSubmit,\r\n  } = form;\r\n\r\n  const navigate = useNavigate();\r\n  const { id, realm, permissionType, permissionId, selectedId } = useParams<\r\n    NewPermissionParams & PermissionDetailsParams\r\n  >();\r\n\r\n  const { addAlert, addError } = useAlerts();\r\n  const [permission, setPermission] = useState<PolicyRepresentation>();\r\n  const [applyToResourceTypeFlag, setApplyToResourceTypeFlag] = useState(false);\r\n  const { hasAccess } = useAccess();\r\n\r\n  const isDisabled = !hasAccess(\"manage-authorization\");\r\n\r\n  useFetch(\r\n    async () => {\r\n      if (!permissionId) {\r\n        return {};\r\n      }\r\n      const [permission, resources, policies, scopes] = await Promise.all([\r\n        adminClient.clients.findOnePermission({\r\n          id,\r\n          type: permissionType,\r\n          permissionId,\r\n        }),\r\n        adminClient.clients.getAssociatedResources({\r\n          id,\r\n          permissionId,\r\n        }),\r\n        adminClient.clients.getAssociatedPolicies({\r\n          id,\r\n          permissionId,\r\n        }),\r\n        adminClient.clients.getAssociatedScopes({\r\n          id,\r\n          permissionId,\r\n        }),\r\n      ]);\r\n\r\n      if (!permission) {\r\n        throw new Error(t(\"notFound\"));\r\n      }\r\n\r\n      return {\r\n        permission,\r\n        resources: resources.map((r) => r._id),\r\n        policies: policies.map((p) => p.id!),\r\n        scopes: scopes.map((s) => s.id!),\r\n      };\r\n    },\r\n    ({ permission, resources, policies, scopes }) => {\r\n      reset({ ...permission, resources, policies, scopes });\r\n      if (permission && \"resourceType\" in permission) {\r\n        setApplyToResourceTypeFlag(\r\n          !!(permission as { resourceType: string }).resourceType,\r\n        );\r\n      }\r\n      setPermission({ ...permission, resources, policies });\r\n    },\r\n    [],\r\n  );\r\n\r\n  const save = async (permission: PolicyRepresentation) => {\r\n    try {\r\n      if (permissionId) {\r\n        await adminClient.clients.updatePermission(\r\n          { id, type: permissionType, permissionId },\r\n          permission,\r\n        );\r\n      } else {\r\n        const result = await adminClient.clients.createPermission(\r\n          { id, type: permissionType },\r\n          permission,\r\n        );\r\n        setPermission(result);\r\n        navigate(\r\n          toPermissionDetails({\r\n            realm,\r\n            id,\r\n            permissionType,\r\n            permissionId: result.id!,\r\n          }),\r\n        );\r\n      }\r\n      addAlert(\r\n        t((permissionId ? \"update\" : \"create\") + \"PermissionSuccess\"),\r\n        AlertVariant.success,\r\n      );\r\n    } catch (error) {\r\n      addError(\"permissionSaveError\", error);\r\n    }\r\n  };\r\n\r\n  const [toggleDeleteDialog, DeleteConfirm] = useConfirmDialog({\r\n    titleKey: \"deletePermission\",\r\n    messageKey: t(\"deletePermissionConfirm\", {\r\n      permission: permission?.name,\r\n    }),\r\n    continueButtonVariant: ButtonVariant.danger,\r\n    continueButtonLabel: \"confirm\",\r\n    onConfirm: async () => {\r\n      try {\r\n        await adminClient.clients.delPermission({\r\n          id,\r\n          type: permissionType,\r\n          permissionId: permissionId,\r\n        });\r\n        addAlert(t(\"permissionDeletedSuccess\"), AlertVariant.success);\r\n        navigate(\r\n          toAuthorizationTab({ realm, clientId: id, tab: \"permissions\" }),\r\n        );\r\n      } catch (error) {\r\n        addError(\"permissionDeletedError\", error);\r\n      }\r\n    },\r\n  });\r\n\r\n  const resourcesIds = useWatch({\r\n    control,\r\n    name: \"resources\",\r\n    defaultValue: [],\r\n  });\r\n\r\n  if (!permission) {\r\n    return <KeycloakSpinner />;\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <DeleteConfirm />\r\n      <ViewHeader\r\n        titleKey={\r\n          permissionId\r\n            ? permission.name!\r\n            : `create${toUpperCase(permissionType)}BasedPermission`\r\n        }\r\n        dropdownItems={\r\n          permissionId\r\n            ? [\r\n                <DropdownItem\r\n                  key=\"delete\"\r\n                  data-testid=\"delete-resource\"\r\n                  isDisabled={isDisabled}\r\n                  onClick={() => toggleDeleteDialog()}\r\n                >\r\n                  {t(\"delete\")}\r\n                </DropdownItem>,\r\n              ]\r\n            : undefined\r\n        }\r\n      />\r\n      <PageSection variant=\"light\">\r\n        <FormAccess\r\n          isHorizontal\r\n          role=\"manage-authorization\"\r\n          onSubmit={handleSubmit(save)}\r\n        >\r\n          <FormProvider {...form}>\r\n            <TextControl\r\n              name=\"name\"\r\n              label={t(\"name\")}\r\n              labelIcon={t(\"permissionName\")}\r\n              rules={{\r\n                required: t(\"required\"),\r\n              }}\r\n            />\r\n            <TextAreaControl\r\n              name=\"description\"\r\n              label={t(\"description\")}\r\n              labelIcon={t(\"permissionDescription\")}\r\n              rules={{\r\n                maxLength: {\r\n                  value: 255,\r\n                  message: t(\"maxLength\", { length: 255 }),\r\n                },\r\n              }}\r\n            />\r\n            <FormGroup\r\n              label={t(\"applyToResourceTypeFlag\")}\r\n              fieldId=\"applyToResourceTypeFlag\"\r\n              labelIcon={\r\n                <HelpItem\r\n                  helpText={t(\"applyToResourceTypeFlagHelp\")}\r\n                  fieldLabelId=\"applyToResourceTypeFlag\"\r\n                />\r\n              }\r\n            >\r\n              <Switch\r\n                id=\"applyToResourceTypeFlag\"\r\n                name=\"applyToResourceTypeFlag\"\r\n                label={t(\"on\")}\r\n                labelOff={t(\"off\")}\r\n                isChecked={applyToResourceTypeFlag}\r\n                onChange={(_event, val) => setApplyToResourceTypeFlag(val)}\r\n                aria-label={t(\"applyToResourceTypeFlag\")}\r\n              />\r\n            </FormGroup>\r\n            {applyToResourceTypeFlag ? (\r\n              <TextControl\r\n                name=\"resourceType\"\r\n                label={t(\"resourceType\")}\r\n                labelIcon={t(\"resourceTypeHelp\")}\r\n                rules={{\r\n                  required: {\r\n                    value: permissionType === \"scope\" ? true : false,\r\n                    message: t(\"required\"),\r\n                  },\r\n                }}\r\n              />\r\n            ) : (\r\n              <FormGroup\r\n                label={t(\"resource\")}\r\n                fieldId=\"resources\"\r\n                labelIcon={\r\n                  <HelpItem\r\n                    helpText={t(\"permissionResources\")}\r\n                    fieldLabelId=\"resources\"\r\n                  />\r\n                }\r\n                isRequired={permissionType !== \"scope\"}\r\n              >\r\n                <ResourcesPolicySelect\r\n                  name=\"resources\"\r\n                  clientId={id}\r\n                  permissionId={permissionId}\r\n                  preSelected={\r\n                    permissionType === \"scope\" ? undefined : selectedId\r\n                  }\r\n                  variant={\r\n                    permissionType === \"scope\"\r\n                      ? SelectVariant.typeahead\r\n                      : SelectVariant.typeaheadMulti\r\n                  }\r\n                  isRequired={permissionType !== \"scope\"}\r\n                />\r\n                {errors.resources && <FormErrorText message={t(\"required\")} />}\r\n              </FormGroup>\r\n            )}\r\n            {permissionType === \"scope\" && (\r\n              <FormGroup\r\n                label={t(\"authorizationScopes\")}\r\n                fieldId=\"scopes\"\r\n                labelIcon={\r\n                  <HelpItem\r\n                    helpText={t(\"permissionScopesHelp\")}\r\n                    fieldLabelId=\"scopesSelect\"\r\n                  />\r\n                }\r\n                isRequired\r\n              >\r\n                <ScopeSelect\r\n                  clientId={id}\r\n                  resourceId={resourcesIds?.[0]}\r\n                  preSelected={selectedId}\r\n                />\r\n                {errors.scopes && <FormErrorText message={t(\"required\")} />}\r\n              </FormGroup>\r\n            )}\r\n            <FormGroup\r\n              label={t(\"policies\")}\r\n              fieldId=\"policies\"\r\n              labelIcon={\r\n                <HelpItem\r\n                  helpText={t(\"permissionPoliciesHelp\")}\r\n                  fieldLabelId=\"policies\"\r\n                />\r\n              }\r\n            >\r\n              <ResourcesPolicySelect\r\n                name=\"policies\"\r\n                clientId={id}\r\n                permissionId={permissionId}\r\n              />\r\n            </FormGroup>\r\n            <FormGroup\r\n              label={t(\"decisionStrategy\")}\r\n              labelIcon={\r\n                <HelpItem\r\n                  helpText={t(\"permissionDecisionStrategyHelp\")}\r\n                  fieldLabelId=\"decisionStrategy\"\r\n                />\r\n              }\r\n              fieldId=\"policyEnforcementMode\"\r\n              hasNoPaddingTop\r\n            >\r\n              <Controller\r\n                name=\"decisionStrategy\"\r\n                data-testid=\"decisionStrategy\"\r\n                defaultValue={DecisionStrategy.UNANIMOUS}\r\n                control={control}\r\n                render={({ field }) => (\r\n                  <>\r\n                    {Object.values(DecisionStrategy).map((strategy) => (\r\n                      <Radio\r\n                        id={strategy}\r\n                        key={strategy}\r\n                        data-testid={strategy}\r\n                        isChecked={field.value === strategy}\r\n                        isDisabled={isDisabled}\r\n                        name=\"decisionStrategies\"\r\n                        onChange={() => field.onChange(strategy)}\r\n                        label={t(`decisionStrategies.${strategy}`)}\r\n                        className=\"pf-v5-u-mb-md\"\r\n                      />\r\n                    ))}\r\n                  </>\r\n                )}\r\n              />\r\n            </FormGroup>\r\n            <ActionGroup>\r\n              <div className=\"pf-v5-u-mt-md\">\r\n                <Button\r\n                  variant={ButtonVariant.primary}\r\n                  type=\"submit\"\r\n                  data-testid=\"save\"\r\n                >\r\n                  {t(\"save\")}\r\n                </Button>\r\n\r\n                <Button\r\n                  variant=\"link\"\r\n                  data-testid=\"cancel\"\r\n                  component={(props) => (\r\n                    <Link\r\n                      {...props}\r\n                      to={toAuthorizationTab({\r\n                        realm,\r\n                        clientId: id,\r\n                        tab: \"permissions\",\r\n                      })}\r\n                    ></Link>\r\n                  )}\r\n                >\r\n                  {t(\"cancel\")}\r\n                </Button>\r\n              </div>\r\n            </ActionGroup>\r\n          </FormProvider>\r\n        </FormAccess>\r\n      </PageSection>\r\n    </>\r\n  );\r\n}\r\n"],"names":["ScopeSelect","clientId","resourceId","preSelected","adminClient","useAdminClient","t","useTranslation","control","getValues","setValue","errors","useFormContext","scopes","setScopes","useState","selectedScopes","setSelectedScopes","search","setSearch","open","setOpen","firstUpdate","useRef","values","toSelectOptions","scope","jsx","SelectOption","useFetch","s","Controller","value","field","KeycloakSelect","SelectVariant","val","filter","selectedValue","option","changedValue","PermissionDetails","form","useForm","reset","handleSubmit","navigate","useNavigate","id","realm","permissionType","permissionId","selectedId","useParams","addAlert","addError","useAlerts","permission","setPermission","applyToResourceTypeFlag","setApplyToResourceTypeFlag","hasAccess","useAccess","isDisabled","resources","policies","r","p","save","result","toPermissionDetails","AlertVariant","error","toggleDeleteDialog","DeleteConfirm","useConfirmDialog","ButtonVariant","toAuthorizationTab","resourcesIds","useWatch","jsxs","Fragment","ViewHeader","toUpperCase","DropdownItem","PageSection","FormAccess","FormProvider","TextControl","TextAreaControl","FormGroup","HelpItem","Switch","_event","ResourcesPolicySelect","FormErrorText","DecisionStrategy","strategy","Radio","ActionGroup","Button","props","Link","KeycloakSpinner"],"mappings":"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"}